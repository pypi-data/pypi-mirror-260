import{d as h,f as k,e as r,o as n,k as E,I as _,l as w,u as l,af as L,c as o,ag as N,a as i,ah as V,ai as q,aj as z,b as O,S as G,ak as J,al as K,am as Y,F as H,an as M,ao as Q,ap as W,aq as X,ar as Z,h as u,i as g,a1 as ee,as as le,at as ae,au as se,av as te,aw as ne,ax as oe,ay as ue,az as re,v as ie,ae as b,aA as fe}from"./index-5ndwWFM5.js";import{u as pe}from"./usePageTitle-Ocb5_Rc1.js";const de={class:"flow-run-graphs__graph-panel-container"},ce={class:"flow-run-graphs__graphs"},we={class:"flow-run-graphs__panel p-background"},ve=h({__name:"FlowRunGraphs",props:{flowRun:{}},setup(F){const c=k(),p=k(!1),e=k(null),v=r(()=>{var d,a;return{root:{"flow-run-graphs--fullscreen":p.value,"flow-run-graphs--show-panel":((d=e.value)==null?void 0:d.kind)==="task-run"||((a=e.value)==null?void 0:a.kind)==="flow-run"}}});return(d,a)=>{var f,m;return n(),E("div",{class:z(["flow-run-graphs",v.value.root])},[_("div",de,[_("div",ce,[w(l(L),{fullscreen:p.value,"onUpdate:fullscreen":a[0]||(a[0]=s=>p.value=s),viewport:c.value,"onUpdate:viewport":a[1]||(a[1]=s=>c.value=s),selected:e.value,"onUpdate:selected":a[2]||(a[2]=s=>e.value=s),"flow-run":d.flowRun,class:"flow-run-graphs__flow-run"},null,8,["fullscreen","viewport","selected","flow-run"])]),_("div",we,[((f=e.value)==null?void 0:f.kind)==="task-run"||((m=e.value)==null?void 0:m.kind)==="flow-run"?(n(),o(l(N),{key:0,selection:e.value,"onUpdate:selection":a[3]||(a[3]=s=>e.value=s),floating:p.value},null,8,["selection","floating"])):i("",!0)])]),e.value&&e.value.kind==="artifacts"?(n(),o(l(V),{key:0,selection:e.value,"onUpdate:selection":a[4]||(a[4]=s=>e.value=s)},null,8,["selection"])):i("",!0),w(l(q),{selection:e.value,"onUpdate:selection":a[5]||(a[5]=s=>e.value=s)},null,8,["selection"])],2)}}}),_e=h({__name:"FlowRun",setup(F){const c=ee(),p=O("flowRunId");G();const{flowRun:e,subscription:v}=J(p,{interval:5e3}),d=r(()=>{var t;return(t=e.value)==null?void 0:t.deploymentId}),{deployment:a}=K(d),f=r(()=>{var t;return(t=e.value)!=null&&t.stateType?Y(e.value.stateType):!0}),m=r(()=>[{label:"Logs"},{label:"Task Runs",hidden:f.value},{label:"Subflow Runs",hidden:f.value},{label:"Results",hidden:f.value},{label:"Artifacts",hidden:f.value},{label:"Details"},{label:"Parameters"}]),s=H("tab","Logs"),{tabs:T}=M(m,s),x=r(()=>{var t;return((t=e.value)==null?void 0:t.parameters)??{}}),S=r(()=>{var t;return((t=a.value)==null?void 0:t.parameterOpenApiSchema)??{}}),R=r(()=>Q(x.value,S.value)),I=r(()=>[p.value]),{filter:U}=W({flowRuns:{parentFlowRunId:I}});function C(){c.push(b.flowRuns())}const B=r(()=>{var t;return(t=e.value)==null?void 0:t.stateType});X(B);const P=r(()=>e.value?`Flow Run: ${e.value.name}`:"Flow Run");return pe(P),Z(()=>{v.error&&fe(v.error).isInRange("clientError")&&c.replace(b[404]())}),(t,y)=>{const $=g("p-code-highlight"),D=g("p-tabs"),j=g("p-layout-default");return n(),o(j,{class:"flow-run"},{header:u(()=>[l(e)?(n(),o(l(le),{key:0,"flow-run-id":l(e).id,onDelete:C},null,8,["flow-run-id"])):i("",!0)]),default:u(()=>[l(e)&&!f.value?(n(),o(ve,{key:0,"flow-run":l(e)},null,8,["flow-run"])):i("",!0),w(D,{selected:l(s),"onUpdate:selected":y[0]||(y[0]=A=>ie(s)?s.value=A:null),tabs:l(T)},{details:u(()=>[l(e)?(n(),o(l(ae),{key:0,"flow-run":l(e)},null,8,["flow-run"])):i("",!0)]),logs:u(()=>[l(e)?(n(),o(l(se),{key:0,"flow-run":l(e)},null,8,["flow-run"])):i("",!0)]),results:u(()=>[l(e)?(n(),o(l(te),{key:0,"flow-run":l(e)},null,8,["flow-run"])):i("",!0)]),artifacts:u(()=>[l(e)?(n(),o(l(ne),{key:0,"flow-run":l(e)},null,8,["flow-run"])):i("",!0)]),"task-runs":u(()=>[l(e)?(n(),o(l(oe),{key:0,"flow-run-id":l(e).id},null,8,["flow-run-id"])):i("",!0)]),"subflow-runs":u(()=>[w(l(ue),{filter:l(U)},null,8,["filter"])]),parameters:u(()=>[l(e)?(n(),o(l(re),{key:0,"text-to-copy":R.value},{default:u(()=>[w($,{lang:"json",text:R.value,class:"flow-run__parameters"},null,8,["text"])]),_:1},8,["text-to-copy"])):i("",!0)]),_:1},8,["selected","tabs"])]),_:1})}}});export{_e as default};

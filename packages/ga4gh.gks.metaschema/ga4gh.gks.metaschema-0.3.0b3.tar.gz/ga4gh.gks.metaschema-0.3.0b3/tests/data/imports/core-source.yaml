$schema: http://json-schema.org/draft/2020-12/schema
title: GA4GH-GKS-Core-Definitions
type: object
strict: true

$defs:
  Entity:
    description: >-
      Entity is the root class of ‘core’ classes model - those that have identifiers and other general 
      metadata like labels, xrefs, urls, descriptions, etc. All core classes descend from and inherit 
      its attributes.
    heritableProperties:
      id:
        type: string
        description: >-
          The 'logical' identifier of the entity in the system of record, e.g. a UUID. This 'id' is 
          unique within a given system. The identified entity may have a different 'id' in a different 
          system, or may refer to an 'id' for the shared concept in another system (e.g. a CURIE).
      label:
        type: string
        description: >-
          A primary label for the entity.
      description:
        type: string
        description: >-
          A free-text description of the entity.
      extensions:
        type: array
        ordered: true
        items:
          $ref: "#/$defs/Extension"
    discriminator:
      propertyName: type

  MappableEntity:
    inherits: Entity
    description: an Entity that is mappable to codings in other terminology systems.
    heritableProperties:
      mappings:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/Mapping"

  Mapping:
    type: object
    inherits: Entity
    maturity: draft
    description: >-
      A mapping to a concept in a terminology system.
    properties:
      system:
        type: string
        description: Identity of the terminology system.
      version:
        type: string
        description: Version of the terminology system.
      code:
        $ref: '#/$defs/Code'
        description: Symbol in syntax defined by the terminology system.
      relation:
        description: >-
          A mapping relation between concepts as defined by the Simple Knowledge Organization System (SKOS).
        type: string
        enum:
          - closeMatch
          - exactMatch
          - broadMatch
          - narrowMatch
          - relatedMatch
    required:
      - relation
      - code
      - system

  Extension:
    type: object
    maturity: draft
    description: >-
      The Extension class provides VODs with a means to extend descriptions
      with other attributes unique to a content provider. These extensions
      are not expected to be natively understood under VRSATILE, but may be
      used for pre-negotiated exchange of message attributes when needed.
    properties:
      type:
        type: string
        const: Extension
        description: MUST be "Extension".
      name:
        type: string
        description: A name for the Extension
      value:
        type: [ "number", "string", "boolean", "object", "array", "null" ]
        description: Any primitive or structured object
    required: [ "name" ]

  Code:
    maturity: draft
    description: >-
      Indicates that the value is taken from a set of controlled strings defined elsewhere.
      Technically, a code is restricted to a string which has at least one character and no leading or 
      trailing whitespace, and where there is no whitespace other than single spaces in the contents.
    type: string
    pattern: '\S+( \S+)*'
    example: ENSG00000139618

  IRI:
    maturity: draft
    description: >-
      An IRI Reference (either an IRI or a relative-reference), according to `RFC3986 section 4.1 
      <https://datatracker.ietf.org/doc/html/rfc3986#section-4.1>` and `RFC3987 section 2.1
      <https://datatracker.ietf.org/doc/html/rfc3987#section-2.1>`. MAY be a JSON Pointer as an IRI fragment, as 
      described by `RFC6901 section 6 <https://datatracker.ietf.org/doc/html/rfc6901#section-6>`.
    type: string
    format: iri-reference

#  CodeableEntity:  # TODO: Discussion on CodeableConcept analog pending
#    inherits: Entity
#    description: >-
#      An entity that may be associated with codes in one or more systems.
#    properties:

#  Disease:
#    type: object
#    inherits: DomainEntity
#    description: >-
#      A reference to a Disease as defined by an authority. For human diseases,
#      the use of `MONDO <https://registry.identifiers.org/registry/mondo>`_
#      as the disease authority is RECOMMENDED.
#    properties:
#      type:
#        type: string
#        const: Disease
#        default: Disease
#        description: MUST be "Disease".
#
#  Phenotype:
#    type: object
#    inherits: DomainEntity
#    description: >-
#      A reference to a Phenotype as defined by an authority. For human phenotypes,
#      the use of `HPO <https://registry.identifiers.org/registry/hpo>`_
#      as the disease authority is RECOMMENDED.
#    properties:
#      type:
#        type: string
#        const: Phenotype
#        default: Phenotype
#        description: MUST be "Phenotype".
#
#  Gene:
#    inherits: DomainEntity
#    description: >-
#      A reference to a Gene as defined by an authority. For human genes,
#      the use of `hgnc <https://registry.identifiers.org/registry/hgnc>`_
#      as the gene authority is RECOMMENDED.
#    type: object
#    properties:
#      type:
#        type: string
#        const: "Gene"
#        default: "Gene"
#        description: MUST be "Gene"
#
#  Condition:
#    type: object
#    description: A set of phenotype and/or disease concepts that constitute a condition.
#    inherits: ValueEntity
#    properties:
#      members:
#        type: array
#        ordered: false
#        items:
#          anyOf:
#            - $ref: "#/$defs/Disease"
#            - $ref: "#/$defs/Phenotype"
#        minItems: 2
#    required: [ "members" ]
#
#  Therapeutic:
#    type: object
#    inherits: DomainEntity
#    description: A treatment, therapy, or drug.
#    properties:
#      type:
#        type: string
#        const: Therapeutic
#        default: Therapeutic
#        description: MUST be "Therapeutic".
#
#  TherapeuticCollection:
#    inherits: ValueEntity
#    description: A collection of therapeutics.
#    heritableProperties:
#      members:
#        type: array
#        ordered: false
#        description: >-
#          The therapeutics that constitute the described collection.
#        items:
#          $ref: "#/$defs/Therapeutic"
#        minItems: 2
#    heritableRequired: [ "members" ]
#
#  CombinationTherapeuticCollection:
#    type: object
#    inherits: TherapeuticCollection
#    description: >-
#      A collection of therapeutics that are taken during a course of treatment.
#    properties:
#      type:
#        type: string
#        const: CombinationTherapeutics
#        default: CombinationTherapeutics
#        description: MUST be "CombinationTherapeutics"
#
#  SubstituteTherapeuticCollection:
#    type: object
#    inherits: TherapeuticCollection
#    description: >-
#      A collection of therapeutics that are considered as valid alternative entities.
#    properties:
#      type:
#        type: string
#        const: SubstituteTherapeutics
#        default: SubstituteTherapeutics
#        description: MUST be "SubstituteTherapeutics"

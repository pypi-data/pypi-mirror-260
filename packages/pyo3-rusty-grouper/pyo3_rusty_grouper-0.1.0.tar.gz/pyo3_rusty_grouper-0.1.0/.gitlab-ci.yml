stages:
  - build


building:
  image: quay.io/pypa/manylinux2014_x86_64
  stage: build
  script:
    - curl https://sh.rustup.rs -sSf | sh -s -- -y
    - pyenv install $PYTHON_VERSION
    - pyenv global $PYTHON_VERSION
    - pip install maturin
    - maturin build --release --out dist --target $TARGET --manylinux 2014
  artifacts:
    paths:
      - dist
  parallel:
    matrix:
      - PYTHON_VERSION: ['3.10', '3.11', '3.12']
        TARGET: ['x86_64-unknown-linux-gnu', 'aarch64-unknown-linux-gnu', 'aarch64-apple-darwin']

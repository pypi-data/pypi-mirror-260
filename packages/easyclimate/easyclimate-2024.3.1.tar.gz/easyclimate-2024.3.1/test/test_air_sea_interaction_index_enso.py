"""
pytest for field.air_sea_interaction.index_enso.py
"""

import pytest

import easyclimate as ecl
import xarray as xr
import numpy as np

data = ecl.open_tutorial_dataset("sst_mnmean_oisst").sst
data_anormaly = ecl.remove_seasonal_cycle_mean(data)


def test_calc_index_nino1and2():
    result_data = ecl.field.air_sea_interaction.calc_index_nino1and2(data_anormaly).data
    refer_data = np.array(
        [
            -9.0678632e-02,
            -1.9894037e-01,
            -6.0295850e-01,
            -1.3716851e00,
            -1.0071000e00,
            -2.9825833e-01,
            -2.1385383e-02,
            7.8384870e-01,
            1.0136658e00,
            1.3685925e00,
            2.1592607e00,
            3.0559778e00,
            3.3755212e00,
            2.9537597e00,
            2.0519412e00,
            2.1625147e00,
            3.1287997e00,
            3.9779415e00,
            4.5848141e00,
            4.2977486e00,
            3.0618656e00,
            1.8557925e00,
            1.0899609e00,
            3.5357806e-01,
            2.4282141e-01,
            -3.0764043e-01,
            -8.8905853e-01,
            -5.4908532e-01,
            -3.1680009e-01,
            -1.0324584e00,
            -9.3228537e-01,
            -4.3695134e-01,
            -5.2643400e-01,
            -2.5907382e-02,
            -2.6073909e-01,
            -5.2621938e-02,
            -1.7997865e-01,
            -9.0384054e-01,
            -1.2059586e00,
            -8.3198529e-01,
            -1.2483999e00,
            -1.9811583e00,
            -1.1265855e00,
            -1.2469513e00,
            -1.4195342e00,
            -9.5400727e-01,
            -8.7893903e-01,
            -8.6552191e-01,
            -3.5797864e-01,
            1.4535969e-01,
            -2.7758503e-02,
            -6.9748533e-01,
            -9.2220008e-01,
            -8.7725836e-01,
            -9.3078542e-01,
            -5.5745125e-01,
            2.6006594e-01,
            3.1992704e-02,
            2.7916095e-01,
            4.8747796e-01,
            2.5192145e-01,
            8.2575953e-01,
            1.0895414e00,
            1.4797145e00,
            1.7096000e00,
            1.3263415e00,
            1.1646146e00,
            1.0990485e00,
            1.0148659e00,
            1.0335927e00,
            1.6087610e00,
            1.0746782e00,
            6.9752151e-01,
            1.4105953e-01,
            -3.2345852e-01,
            -7.9688531e-01,
            -9.4699997e-01,
            -6.6685849e-01,
            -1.6243852e00,
            -1.3955512e00,
            -1.5639340e00,
            -1.1943072e00,
            -1.2511390e00,
            -9.8682189e-01,
            -9.5477849e-01,
            -3.7424043e-01,
            2.1284156e-01,
            1.2761463e-01,
            1.3989988e-01,
            -1.0900583e00,
            -9.0078545e-01,
            -5.4975128e-01,
            -3.9963418e-01,
            -5.0860727e-01,
            -4.3153909e-01,
            -2.2672188e-01,
            -5.6837851e-01,
            -4.6264037e-01,
            -1.9095849e-01,
            -4.1298544e-01,
            -2.7399993e-01,
            -1.9665843e-01,
            -1.9778526e-01,
            -6.7315120e-01,
            -4.4993398e-01,
            -2.5910723e-01,
            -4.9113911e-01,
            -7.1202201e-01,
            -2.9587871e-01,
            -6.2874037e-01,
            -9.5258541e-02,
            -5.5185433e-02,
            -4.9160004e-01,
            9.6341573e-02,
            1.4071456e-01,
            3.4374869e-01,
            3.6946586e-01,
            3.4759262e-01,
            3.4866089e-01,
            6.5557802e-01,
            6.7872137e-01,
            3.4965965e-01,
            6.1514145e-01,
            1.2353146e00,
            2.2259998e00,
            2.0658414e00,
            9.2681450e-01,
            2.8204879e-01,
            -1.3763407e-01,
            -3.3260724e-01,
            5.0360888e-02,
            -6.2122058e-02,
            -2.8887856e-01,
            -5.9840452e-02,
            4.2724144e-01,
            6.1331457e-01,
            9.3599999e-01,
            8.8184148e-01,
            8.6041456e-01,
            3.9214870e-01,
            3.3326587e-01,
            4.1719261e-01,
            1.9746085e-01,
            8.7478064e-02,
            -1.9378586e-02,
            -1.4994043e-01,
            -2.8785846e-01,
            -1.1546854e00,
            -1.1690001e00,
            -1.0384583e00,
            -4.5818543e-01,
            -4.8385140e-01,
            -1.0016340e00,
            -2.4570724e-01,
            7.5646079e-01,
            8.5997802e-01,
            8.5552156e-01,
            8.5925943e-01,
            3.6424148e-01,
            -4.5818537e-01,
            -9.9929994e-01,
            -1.1491584e00,
            -4.3378556e-01,
            -4.3235129e-01,
            -6.6693413e-01,
            -2.0470734e-01,
            -6.0353899e-01,
            -3.5052201e-01,
            -7.3407847e-01,
            -6.4314044e-01,
            -3.5875848e-01,
            -4.7698534e-01,
            -1.6496000e00,
            -1.3548584e00,
            -1.3410856e00,
            -1.6544513e00,
            -1.1589341e00,
            -1.1321073e00,
            -8.2763898e-01,
            -1.2728219e00,
            -1.1372784e00,
            -8.1704038e-01,
            -3.2945850e-01,
            4.1151467e-01,
            1.1422998e00,
            2.4489415e00,
            3.3691144e00,
            3.9082487e00,
            4.0765657e00,
            3.9868927e00,
            3.7911608e00,
            4.0919781e00,
            4.1804214e00,
            3.7628596e00,
            2.9445412e00,
            2.6386144e00,
            3.1640999e00,
            3.4635415e00,
            2.2827146e00,
            1.7597486e00,
            1.0528659e00,
            4.8649266e-01,
            3.6956093e-01,
            -1.3022198e-01,
            -2.0037855e-01,
            -7.4224037e-01,
            -4.2315856e-01,
            6.5814592e-02,
            -1.1910001e00,
            -7.9305845e-01,
            -1.0910853e00,
            -1.2443511e00,
            -9.6683395e-01,
            -1.1458074e00,
            -7.2073901e-01,
            -1.0350219e00,
            -1.0296787e00,
            -7.0964044e-01,
            -4.7565857e-01,
            -5.7288545e-01,
            1.2769997e-01,
            -3.3655846e-01,
            -7.6508528e-01,
            -1.1373513e00,
            -6.2753409e-01,
            -4.4920731e-01,
            -3.5333908e-01,
            -9.9162185e-01,
            -5.4477859e-01,
            -6.5074039e-01,
            -2.5015849e-01,
            8.2501465e-01,
            9.7500002e-01,
            -6.9165838e-01,
            -1.3319855e00,
            -8.7595129e-01,
            -7.9303408e-01,
            -9.5250732e-01,
            -1.2365391e00,
            -1.0370220e00,
            -8.0097860e-01,
            -8.9134032e-01,
            -5.4658528e-02,
            9.1991448e-01,
            8.8459992e-01,
            4.1884148e-01,
            -2.7208537e-01,
            -6.3835126e-01,
            -7.1293420e-01,
            -4.4380745e-01,
            4.6526089e-01,
            6.9227791e-01,
            6.2902147e-01,
            -1.7244045e-01,
            -3.6385846e-01,
            -7.3308545e-01,
            -1.1393000e00,
            -1.7001584e00,
            -1.3440852e00,
            -9.4195122e-01,
            -4.7653413e-01,
            -3.3460724e-01,
            2.7766094e-01,
            4.0317819e-01,
            2.0712133e-01,
            -1.2940388e-02,
            -3.8595849e-01,
            -8.2148546e-01,
            -3.4700003e-01,
            -1.2149583e00,
            -1.3539854e00,
            -9.6005130e-01,
            -1.0229341e00,
            -2.7970731e-01,
            2.1476093e-01,
            4.1967800e-01,
            6.8721488e-02,
            -6.5640375e-02,
            -7.5045836e-01,
            -1.1259854e00,
            -5.5060005e-01,
            5.1841602e-02,
            -5.9378535e-01,
            -5.4935133e-01,
            -6.5334111e-02,
            -6.1400723e-01,
            -9.8973894e-01,
            -8.1342196e-01,
            -4.4767860e-01,
            -1.9864048e-01,
            3.4134156e-01,
            4.8814584e-02,
            -1.5365999e00,
            -5.0915831e-01,
            -2.4168545e-01,
            4.3334863e-01,
            8.5426599e-01,
            1.0047927e00,
            1.4535611e00,
            1.0766779e00,
            5.9042132e-01,
            4.5975959e-01,
            3.0641461e-02,
            -9.6918535e-01,
            -1.2889999e00,
            -1.5110583e00,
            -1.2436852e00,
            -1.3667514e00,
            -1.4346341e00,
            -1.6830072e00,
            -1.8576392e00,
            -1.9699218e00,
            -1.6592784e00,
            -6.0934031e-01,
            2.5304139e-01,
            6.8031466e-01,
            2.4580003e-01,
            -5.5458393e-02,
            5.3461468e-01,
            9.2014861e-01,
            1.0514657e00,
            7.7159274e-01,
            -4.0839139e-02,
            -1.2902199e-01,
            -3.7387866e-01,
            -1.1084034e-01,
            -1.3205844e-01,
            -3.1878537e-01,
            2.4570006e-01,
            4.2104161e-01,
            7.0651466e-01,
            8.7044859e-01,
            9.5666593e-01,
            4.1809264e-01,
            1.3266100e-01,
            5.6977808e-01,
            4.0162155e-01,
            2.8575954e-01,
            -4.7558557e-02,
            -4.0118542e-01,
            5.1999992e-01,
            -3.2358456e-02,
            -3.2378539e-01,
            -1.4919513e00,
            -1.3483341e00,
            -1.3776072e00,
            -1.5982389e00,
            -1.4720219e00,
            -1.2807784e00,
            -4.6514049e-01,
            5.0641421e-02,
            -5.7008529e-01,
            7.2099917e-02,
            4.7464153e-01,
            7.6611465e-01,
            4.0234867e-01,
            -4.8534069e-02,
            -6.1970729e-01,
            -5.7143909e-01,
            -7.9122198e-01,
            -9.5107859e-01,
            -6.5454054e-01,
            1.8014146e-01,
            1.8701464e-01,
            1.2463999e00,
            1.0378417e00,
            1.3952146e00,
            8.4334868e-01,
            1.8926588e-01,
            4.5519274e-01,
            -1.2423910e-01,
            -3.8902199e-01,
            -6.2137866e-01,
            -4.5914039e-01,
            -4.9715847e-01,
            -2.0278536e-01,
            -8.7439996e-01,
            -1.6082584e00,
            -1.5634856e00,
            -1.3718513e00,
            -1.0001341e00,
            -5.1230729e-01,
            -5.1443899e-01,
            -2.9332176e-01,
            -2.3767857e-01,
            3.3565947e-01,
            -8.0955857e-01,
            -9.8778534e-01,
            -3.7430009e-01,
            1.2597415e00,
            1.6034148e00,
            1.2046487e00,
            1.1630658e00,
            8.8409257e-01,
            8.2306093e-01,
            7.2507805e-01,
            1.2682144e-01,
            -3.1524047e-01,
            -5.5525851e-01,
            -1.6485386e-02,
            1.3139000e00,
            2.2549415e00,
            2.4440145e00,
            2.7420483e00,
            2.1509662e00,
            2.5216928e00,
            2.5313609e00,
            2.2660782e00,
            2.2767212e00,
            1.3898597e00,
            6.7414153e-01,
            8.7511468e-01,
            1.8759999e-01,
            1.8704148e-01,
            1.9201458e-01,
            1.2524876e-01,
            3.5406572e-01,
            5.2549273e-01,
            3.6756083e-01,
            8.4378168e-02,
            5.6782144e-01,
            1.1980597e00,
            1.6808416e00,
            1.9455147e00,
            8.4679991e-01,
            6.6334152e-01,
            8.8714659e-02,
            -1.2615129e-01,
            -4.6513405e-01,
            -6.0670733e-01,
            -1.1878390e00,
            -1.0036218e00,
            -1.2811786e00,
            -8.3144033e-01,
            -5.2425843e-01,
            -8.9188540e-01,
            -1.1276000e00,
            -6.2645841e-01,
            -7.9728538e-01,
            -2.6525131e-01,
            -2.6339912e-03,
            -4.9107209e-02,
            4.3926102e-01,
            7.2557801e-01,
            7.8592139e-01,
            5.6475949e-01,
            2.8594148e-01,
            -1.7853356e-03,
            3.8699988e-02,
            8.0241583e-02,
            -2.4958543e-01,
            -3.2615140e-01,
            -4.7373420e-01,
            -8.4040725e-01,
            -6.2613916e-01,
            -1.2222195e-01,
            4.0072152e-01,
            7.3596002e-03,
            4.2524138e-01,
            4.4941467e-01,
            3.3670002e-01,
            -1.0175838e-01,
            -7.2398537e-01,
            -1.1804512e00,
            -9.6573412e-01,
            -7.5540727e-01,
            -9.6383905e-01,
            -5.8842188e-01,
            -6.4327848e-01,
            -6.0534048e-01,
            -6.1485833e-01,
            -1.7058545e-01,
            -7.8729993e-01,
            -5.5235845e-01,
            1.9101465e-01,
            4.8704875e-01,
            2.0536591e-01,
            1.9939272e-01,
            -1.4733909e-01,
            -9.4022185e-01,
            -1.4132787e00,
            -1.1426405e00,
            -1.4313587e00,
            -7.6385289e-02,
            -1.2456000e00,
            -1.6918585e00,
            -1.3881854e00,
            -9.8885131e-01,
            -3.7913406e-01,
            -7.8750730e-01,
            -1.6789389e00,
            -1.3939219e00,
            -2.2477850e-01,
            -9.5640413e-02,
        ]
    )
    assert np.isclose(result_data, refer_data).all()


def test_calc_index_nino3():
    result_data = ecl.field.air_sea_interaction.calc_index_nino3(data_anormaly).data
    refer_data = np.array(
        [
            -7.86217377e-02,
            2.97251493e-01,
            2.45398488e-02,
            -1.85055688e-01,
            1.37889475e-01,
            6.82995498e-01,
            9.69612241e-01,
            7.50991940e-01,
            1.12690973e00,
            1.67713845e00,
            2.20475149e00,
            2.63235688e00,
            3.26662803e00,
            3.33950186e00,
            2.56385660e00,
            1.93374431e00,
            1.57685602e00,
            1.86692870e00,
            1.65537894e00,
            9.30241883e-01,
            8.47176373e-01,
            3.95505279e-01,
            -2.92882115e-01,
            -8.16826403e-01,
            -6.88688397e-01,
            -7.52498448e-01,
            -1.33043498e-01,
            -4.46223840e-02,
            -1.99527264e-01,
            -6.43404484e-01,
            -1.11505437e00,
            -7.28674650e-01,
            -5.30356944e-01,
            -5.01144707e-01,
            -9.58382070e-01,
            -9.49143052e-01,
            -1.42315507e00,
            -1.06828165e00,
            -1.16147685e00,
            -1.05015564e00,
            -1.02146053e00,
            -9.89221215e-01,
            -8.91154468e-01,
            -9.47408020e-01,
            -6.26157045e-01,
            -6.91511393e-01,
            -7.57032096e-01,
            -6.99909747e-01,
            -8.36755037e-01,
            -8.43115151e-01,
            -5.40826797e-01,
            -3.20172310e-01,
            -3.71760547e-01,
            -4.27487791e-01,
            -1.94121078e-01,
            1.28252283e-02,
            -2.54029594e-03,
            4.07088637e-01,
            7.15767801e-01,
            9.37156975e-01,
            7.31611550e-01,
            1.11106825e00,
            1.06500649e00,
            1.03382766e00,
            9.51772690e-01,
            1.11196208e00,
            1.21441209e00,
            1.38419199e00,
            1.49524295e00,
            1.72245526e00,
            1.29861772e00,
            1.14417362e00,
            1.07154489e00,
            5.48468232e-01,
            1.97323129e-01,
            -2.81723309e-02,
            -8.09843957e-01,
            -1.88370442e00,
            -2.03337121e00,
            -1.97784138e00,
            -1.65522361e00,
            -1.23789465e00,
            -1.73441553e00,
            -1.95497644e00,
            -2.06137156e00,
            -1.42449844e00,
            -7.48260200e-01,
            -1.14652216e00,
            -8.76710594e-01,
            -7.30537832e-01,
            -4.11171108e-01,
            -4.12158042e-01,
            -4.65323627e-01,
            -3.96128088e-01,
            -4.19498801e-01,
            -4.26693022e-01,
            -4.13221747e-01,
            -2.34548494e-01,
            1.33565078e-02,
            -1.36522338e-01,
            1.23956092e-01,
            2.48078838e-01,
            -4.53377292e-02,
            -2.42358044e-01,
            3.77263464e-02,
            3.40530393e-03,
            -4.93213674e-03,
            -1.59659773e-01,
            -4.30050716e-02,
            7.00182468e-02,
            -8.40601698e-02,
            -1.70088992e-01,
            -2.25010604e-01,
            4.71962184e-01,
            8.45328867e-01,
            8.83408606e-01,
            4.48876381e-01,
            1.99371949e-01,
            6.97001219e-01,
            9.97640193e-01,
            1.39227819e00,
            1.42881811e00,
            1.31343973e00,
            1.16162765e00,
            1.17268944e00,
            1.32511210e00,
            1.63412213e-01,
            -1.57208025e-01,
            -3.22806954e-01,
            -3.28744739e-01,
            -2.89832115e-01,
            -1.95909753e-01,
            -1.22021742e-01,
            -1.74651407e-02,
            2.53806472e-01,
            3.78610998e-01,
            9.06489432e-01,
            1.05837882e00,
            6.14162207e-01,
            7.87919536e-02,
            -9.66069922e-02,
            1.22671954e-01,
            3.08884531e-01,
            1.85406908e-01,
            1.91811576e-01,
            1.31484911e-01,
            -2.84060150e-01,
            -2.77622372e-01,
            -4.83460605e-01,
            -1.38321131e-01,
            7.31222471e-03,
            -5.00974655e-01,
            -3.16090316e-01,
            -3.56280580e-02,
            6.29817843e-01,
            8.90190244e-01,
            9.39478278e-01,
            7.68801570e-01,
            5.10873139e-01,
            -8.50056559e-02,
            -4.39060628e-01,
            -7.06904471e-01,
            -2.97871143e-01,
            -2.73524672e-01,
            -6.96757019e-01,
            -8.23511422e-01,
            -8.92165542e-01,
            -9.56009746e-01,
            -9.34738338e-01,
            -6.11665130e-01,
            -6.35843515e-01,
            -4.56422329e-01,
            -8.18043888e-01,
            -7.79637873e-01,
            -6.07237756e-01,
            -3.35891366e-01,
            -4.28340316e-01,
            -4.73177999e-01,
            -5.38782120e-01,
            -6.01843059e-01,
            -9.26471651e-01,
            -8.75398338e-01,
            -6.06826782e-01,
            -1.82655692e-01,
            4.62060906e-02,
            9.51628804e-01,
            1.64307880e00,
            2.31872511e00,
            2.81660962e00,
            2.99515533e00,
            3.26968455e00,
            3.56305695e00,
            3.63644481e00,
            3.35906792e00,
            2.57568979e00,
            1.97229409e00,
            1.54432273e00,
            1.06524551e00,
            -4.92254436e-01,
            -4.54641432e-01,
            -4.00406927e-01,
            -6.58311367e-01,
            -8.42815518e-01,
            -8.76326323e-01,
            -1.26340508e00,
            -1.16988170e00,
            -7.83060133e-01,
            -4.90355730e-01,
            -8.80660594e-01,
            -6.60087883e-01,
            -8.99971128e-01,
            -8.36241364e-01,
            -1.00265706e00,
            -1.12149477e00,
            -1.15558207e00,
            -1.52630973e00,
            -1.58292174e00,
            -1.69099832e00,
            -1.04366004e00,
            -5.55472314e-01,
            -8.06439146e-02,
            -3.03187877e-01,
            -6.52854383e-01,
            -5.60908079e-01,
            -5.53823650e-01,
            -4.91378069e-01,
            -4.99415427e-01,
            -8.16009700e-01,
            -6.99271739e-01,
            -5.85098445e-01,
            -2.92276829e-01,
            6.27943277e-02,
            -2.75772288e-02,
            -2.18287811e-01,
            -1.40837803e-01,
            -2.57108063e-01,
            -3.09256941e-01,
            -5.79044640e-01,
            -4.54998791e-01,
            -6.35126352e-01,
            -5.26071727e-01,
            -4.85581756e-01,
            -1.39793515e-01,
            5.73276654e-02,
            1.34393563e-02,
            1.39462128e-01,
            5.67945480e-01,
            3.42725277e-01,
            4.40726429e-01,
            6.90438628e-01,
            9.40067768e-01,
            1.38604021e00,
            1.35562825e00,
            8.06051493e-01,
            3.48973155e-01,
            1.11344300e-01,
            -3.90927255e-01,
            -9.66504514e-01,
            -6.60471141e-01,
            5.56419641e-02,
            1.87930204e-02,
            1.27905309e-01,
            4.20301169e-01,
            4.18756962e-01,
            4.29094911e-01,
            3.43884856e-01,
            1.09473154e-01,
            -4.39039868e-04,
            -1.74077243e-01,
            -3.85404468e-01,
            -2.22487763e-01,
            -2.82724679e-01,
            2.75764093e-02,
            3.19688618e-01,
            4.19851214e-01,
            4.80540276e-01,
            6.38378263e-01,
            3.17134798e-01,
            -1.52710170e-01,
            -1.51189029e-01,
            2.24789351e-01,
            3.72495532e-01,
            3.14778894e-01,
            2.39758611e-01,
            1.66659683e-01,
            -2.80661404e-01,
            -2.17632085e-01,
            -7.06709683e-01,
            -8.49571764e-01,
            -5.78515112e-01,
            -2.74143487e-01,
            -6.28455698e-01,
            -2.95727223e-01,
            -6.34378418e-02,
            -5.39044887e-02,
            1.06008627e-01,
            4.21326339e-01,
            8.97921979e-01,
            1.05955124e00,
            1.08892357e00,
            1.23242819e00,
            9.26084816e-01,
            9.48232040e-02,
            -3.77805680e-01,
            -4.15943921e-01,
            -7.50937879e-01,
            -6.66354358e-01,
            -8.99658024e-01,
            -1.16700697e00,
            -1.32287812e00,
            -1.54829884e00,
            -1.81279302e00,
            -1.53807175e00,
            -1.45051515e00,
            -1.30667686e00,
            -6.09472334e-01,
            -3.67677242e-01,
            -2.50045117e-02,
            3.47622223e-02,
            4.32508588e-01,
            6.04709685e-01,
            2.44621962e-01,
            -1.11548789e-01,
            -2.29193062e-01,
            -5.30905068e-01,
            -5.45265079e-01,
            -5.02010167e-01,
            -7.25938976e-01,
            -1.56610623e-01,
            2.98928827e-01,
            6.28695548e-01,
            8.72708619e-01,
            9.12842989e-01,
            8.09055269e-01,
            8.21917832e-01,
            1.25075686e00,
            1.53857815e00,
            1.05241811e00,
            7.65756547e-01,
            5.68910956e-01,
            5.02506018e-01,
            -1.32771134e-01,
            -7.44371057e-01,
            -1.15854144e00,
            -1.15940690e00,
            -1.25769472e00,
            -1.65181541e00,
            -1.58439314e00,
            -1.62780511e00,
            -1.26966512e00,
            -8.08176816e-01,
            -7.73305655e-01,
            -3.67027223e-01,
            -1.65404484e-01,
            4.17788699e-02,
            -8.05747211e-02,
            -4.50356960e-01,
            -6.27678096e-01,
            -9.34465528e-01,
            -1.09792626e00,
            -9.25121784e-01,
            -6.74598396e-01,
            -1.61660194e-01,
            -1.77172363e-01,
            3.79727334e-02,
            1.24462180e-01,
            5.87495506e-01,
            8.47025275e-01,
            6.86959743e-01,
            3.97438616e-01,
            2.24012192e-02,
            1.19256921e-01,
            -2.15538427e-01,
            -5.16815066e-01,
            -4.27810162e-01,
            7.95109943e-02,
            -1.97893888e-01,
            -7.41504490e-01,
            -7.31404424e-01,
            -7.25691438e-01,
            -5.80090284e-01,
            -1.23777978e-01,
            -1.97865471e-01,
            -1.67076409e-01,
            -2.90217232e-02,
            -3.15965176e-01,
            -7.53043532e-01,
            -1.40655741e-01,
            1.89139426e-01,
            5.88828862e-01,
            8.25862229e-01,
            5.54441929e-01,
            4.62176353e-01,
            4.61371958e-01,
            6.90534472e-01,
            8.98356915e-01,
            8.14011633e-01,
            4.30918187e-01,
            2.22189844e-01,
            1.21344328e-01,
            6.33039474e-01,
            1.16054547e00,
            1.60356224e00,
            2.07850862e00,
            2.30175972e00,
            2.63350511e00,
            2.68443441e00,
            2.92457366e00,
            2.86221147e00,
            2.62928462e00,
            2.00865650e00,
            1.54706097e00,
            7.92539358e-01,
            9.39548481e-03,
            -1.97071120e-01,
            -5.52224755e-01,
            -4.92356867e-01,
            -1.76628008e-01,
            -4.33982134e-01,
            -4.02893037e-01,
            -3.49371731e-01,
            3.83848585e-02,
            6.40256524e-01,
            5.39544284e-01,
            5.48672676e-01,
            4.90462124e-01,
            2.35912219e-01,
            1.63675249e-01,
            -2.09773645e-01,
            -6.74794734e-01,
            -6.30148768e-01,
            -1.05959308e00,
            -1.07647169e00,
            -1.09136510e00,
            -9.99243498e-01,
            -7.91489005e-01,
            -4.22360599e-01,
            -1.66537851e-01,
            2.28345543e-01,
            3.61691892e-01,
            1.15843035e-01,
            3.52038622e-01,
            8.74917924e-01,
            1.04045689e00,
            9.90311563e-01,
            5.94068170e-01,
            5.59106529e-01,
            7.30277598e-01,
            6.28772676e-01,
            5.83395481e-01,
            3.19795579e-01,
            -8.94138962e-03,
            -1.35656968e-01,
            -2.34294683e-01,
            2.18051195e-01,
            4.76023555e-01,
            3.43328208e-01,
            2.36651555e-01,
            2.54073143e-01,
            2.66877681e-01,
            4.81356114e-01,
            -2.85304517e-01,
            -7.39804506e-01,
            -6.06924713e-01,
            -6.00990236e-01,
            -1.26227808e00,
            -1.29779875e00,
            -1.16810977e00,
            -7.45305061e-01,
            -5.10981739e-01,
            -5.55526853e-01,
            -3.62372339e-01,
            -5.82693875e-01,
            -3.45154524e-01,
            -1.30304456e-01,
            -8.72247070e-02,
            -2.20906928e-01,
            -2.58461386e-01,
            -5.04548728e-01,
            -6.26276374e-01,
            -1.10902166e00,
            -1.34073186e00,
            -1.12701023e00,
            -6.97955608e-01,
            -9.07710552e-01,
            -1.04152119e00,
            -5.74221075e-01,
            -3.26424718e-01,
            -5.09023666e-01,
            -8.99661362e-01,
            -9.07715440e-01,
            -9.63959754e-01,
            -8.37838352e-01,
            -3.75915080e-01,
        ]
    )
    assert np.isclose(result_data, refer_data).all()


def test_calc_index_nino34():
    result_data = (
        ecl.field.air_sea_interaction.calc_index_nino34(data_anormaly)
        .isel(time=slice(4, None))
        .data
    )
    refer_data = np.array(
        [
            1.65075790e-02,
            2.10588261e-01,
            3.77884239e-01,
            5.46651006e-01,
            7.73060560e-01,
            1.00953531e00,
            1.27014089e00,
            1.48713505e00,
            1.85057461e00,
            2.20123816e00,
            2.40588093e00,
            2.37296271e00,
            2.16479158e00,
            1.83906019e00,
            1.37714028e00,
            8.53958964e-01,
            4.32608575e-01,
            1.58231378e-01,
            -2.08059028e-01,
            -5.34332991e-01,
            -6.89721286e-01,
            -8.01645875e-01,
            -8.11647356e-01,
            -7.22805321e-01,
            -5.88524401e-01,
            -4.90223736e-01,
            -4.85239744e-01,
            -5.24524987e-01,
            -5.49143434e-01,
            -5.23704588e-01,
            -5.76627016e-01,
            -6.59392953e-01,
            -8.67637336e-01,
            -9.84825850e-01,
            -1.13539124e00,
            -1.18634927e00,
            -1.13756835e00,
            -9.76739764e-01,
            -9.28311765e-01,
            -8.34129035e-01,
            -6.98763490e-01,
            -5.89628637e-01,
            -5.35287023e-01,
            -4.64528978e-01,
            -4.41301316e-01,
            -5.19649863e-01,
            -5.81271350e-01,
            -5.99661231e-01,
            -5.77952385e-01,
            -5.61947763e-01,
            -4.19327766e-01,
            -2.44372979e-01,
            -6.47514537e-02,
            1.33211389e-01,
            3.86504948e-01,
            6.00410998e-01,
            8.08026671e-01,
            1.02380216e00,
            1.16099262e00,
            1.22969878e00,
            1.21469557e00,
            1.16169631e00,
            1.14805615e00,
            1.19419897e00,
            1.29677665e00,
            1.43410742e00,
            1.53838897e00,
            1.53607106e00,
            1.43693876e00,
            1.25039017e00,
            1.01760066e00,
            7.54370689e-01,
            3.93607587e-01,
            -9.25037190e-02,
            -5.71927726e-01,
            -1.01307702e00,
            -1.34680736e00,
            -1.50664067e00,
            -1.64119494e00,
            -1.80424905e00,
            -1.91163719e00,
            -1.98950589e00,
            -2.00797915e00,
            -1.86078119e00,
            -1.60592449e00,
            -1.31618774e00,
            -1.06321979e00,
            -8.93305004e-01,
            -7.28551447e-01,
            -5.95896602e-01,
            -5.22487044e-01,
            -4.66328979e-01,
            -3.96817327e-01,
            -2.87501872e-01,
            -1.47607327e-01,
            -1.75412670e-02,
            1.10591583e-01,
            1.84260279e-01,
            1.53008267e-01,
            1.02691010e-01,
            9.95685607e-02,
            6.48914129e-02,
            8.71369690e-02,
            1.20283023e-01,
            1.91582710e-01,
            2.49414161e-01,
            2.85740703e-01,
            2.28690743e-01,
            2.52299577e-01,
            2.79568285e-01,
            3.11444283e-01,
            3.99527043e-01,
            5.17028570e-01,
            5.54483414e-01,
            6.48592949e-01,
            7.52759039e-01,
            9.81746733e-01,
            1.24271810e00,
            1.55398858e00,
            1.68406677e00,
            1.71301568e00,
            1.57699215e00,
            1.26019621e00,
            9.29794967e-01,
            5.70804477e-01,
            2.57787377e-01,
            -3.51470225e-02,
            -1.32220969e-01,
            -1.52317286e-01,
            -7.66978562e-02,
            2.11366937e-02,
            1.76346734e-01,
            3.64495575e-01,
            5.21844327e-01,
            6.02060199e-01,
            6.07986927e-01,
            5.23000538e-01,
            4.08651382e-01,
            2.68872976e-01,
            1.99555025e-01,
            1.81570694e-01,
            1.97606146e-01,
            1.31860673e-01,
            8.92987102e-02,
            6.05155863e-02,
            5.49682900e-02,
            9.51002687e-02,
            1.37127012e-01,
            2.33556569e-01,
            2.71363407e-01,
            4.00620967e-01,
            5.82795024e-01,
            8.27434719e-01,
            9.32666123e-01,
            1.02324474e00,
            9.39610720e-01,
            7.24251568e-01,
            4.32576299e-01,
            2.01968238e-01,
            2.65899650e-03,
            -1.78171486e-01,
            -3.52924615e-01,
            -5.25847018e-01,
            -7.07044899e-01,
            -8.54237318e-01,
            -9.06253874e-01,
            -9.29323316e-01,
            -8.48789275e-01,
            -7.35776365e-01,
            -6.36891723e-01,
            -5.58287799e-01,
            -4.20309007e-01,
            -3.53095472e-01,
            -3.37200612e-01,
            -3.25171053e-01,
            -3.45981002e-01,
            -4.18517321e-01,
            -4.73345816e-01,
            -4.69355285e-01,
            -4.20633256e-01,
            -2.81060427e-01,
            -2.85197087e-02,
            3.29932243e-01,
            7.31099010e-01,
            1.17198050e00,
            1.57141948e00,
            1.93783295e00,
            2.21823096e00,
            2.42556691e00,
            2.54373002e00,
            2.53038073e00,
            2.30663466e00,
            1.92705953e00,
            1.50782037e00,
            7.92624235e-01,
            9.77789760e-02,
            -4.59271461e-01,
            -8.31056654e-01,
            -1.21902704e00,
            -1.32013690e00,
            -1.41082919e00,
            -1.46300173e00,
            -1.50073123e00,
            -1.42883730e00,
            -1.32562840e00,
            -1.15055561e00,
            -1.04905987e00,
            -9.72717047e-01,
            -1.02525151e00,
            -1.03369260e00,
            -1.06142700e00,
            -1.15028489e00,
            -1.29887736e00,
            -1.42019379e00,
            -1.52299535e00,
            -1.54390919e00,
            -1.39426839e00,
            -1.21248376e00,
            -9.75787699e-01,
            -7.80561030e-01,
            -6.27907455e-01,
            -5.70240617e-01,
            -5.63871086e-01,
            -6.08060956e-01,
            -6.93649292e-01,
            -7.69729853e-01,
            -7.88071275e-01,
            -7.21737266e-01,
            -6.01920426e-01,
            -4.61451679e-01,
            -3.12011749e-01,
            -1.81564987e-01,
            -9.60434377e-02,
            -7.02885911e-02,
            -3.38830240e-02,
            -7.44809583e-02,
            -1.63521320e-01,
            -1.73721865e-01,
            -9.41593349e-02,
            -5.83532788e-02,
            1.13075674e-02,
            1.46348268e-01,
            2.95276254e-01,
            3.90922964e-01,
            5.64420521e-01,
            7.61171401e-01,
            9.78912950e-01,
            1.15253496e00,
            1.31445456e00,
            1.37335813e00,
            1.30669260e00,
            1.14835858e00,
            8.28211546e-01,
            4.23184276e-01,
            1.29780248e-01,
            6.77498616e-03,
            -1.05215468e-01,
            -5.71086258e-02,
            1.45964950e-01,
            2.66222984e-01,
            2.98814684e-01,
            3.42294127e-01,
            3.24632704e-01,
            1.95130736e-01,
            1.25463590e-01,
            9.65122953e-02,
            6.22042492e-02,
            1.15683004e-01,
            2.83524543e-01,
            4.28379387e-01,
            5.32148898e-01,
            6.47059023e-01,
            7.11294651e-01,
            6.89754128e-01,
            5.88044703e-01,
            5.11338711e-01,
            4.34907585e-01,
            3.52848262e-01,
            3.03808272e-01,
            2.94042975e-01,
            2.39700526e-01,
            1.70747370e-01,
            1.19080946e-01,
            -1.75129939e-02,
            -1.93281323e-01,
            -3.75213861e-01,
            -4.83415335e-01,
            -6.29989266e-01,
            -6.08072400e-01,
            -4.65247691e-01,
            -2.62451708e-01,
            -1.20345011e-01,
            8.81405398e-02,
            2.58163393e-01,
            4.09272939e-01,
            5.92126966e-01,
            8.14702630e-01,
            8.87870133e-01,
            7.82024682e-01,
            6.12790763e-01,
            3.94059569e-01,
            9.46602747e-02,
            -8.49077404e-02,
            -1.99689001e-01,
            -3.15775454e-01,
            -4.98672605e-01,
            -7.30738997e-01,
            -1.02172899e00,
            -1.24546528e00,
            -1.47826588e00,
            -1.66565931e00,
            -1.60517728e00,
            -1.48056841e00,
            -1.30064774e00,
            -1.04573572e00,
            -6.84776962e-01,
            -4.49395478e-01,
            -3.08528632e-01,
            -2.38863051e-01,
            -2.07536981e-01,
            -3.56313318e-01,
            -5.52369893e-01,
            -6.30895257e-01,
            -6.75125241e-01,
            -6.62840366e-01,
            -4.67311710e-01,
            -1.91091761e-01,
            7.77869895e-02,
            3.29804540e-01,
            5.42155385e-01,
            7.01344967e-01,
            9.22587037e-01,
            1.13383460e00,
            1.30814207e00,
            1.40262461e00,
            1.42381859e00,
            1.23001564e00,
            8.44168246e-01,
            3.90552253e-01,
            -8.95730034e-02,
            -5.68059444e-01,
            -1.00707257e00,
            -1.30133104e00,
            -1.48131299e00,
            -1.57014132e00,
            -1.61884987e00,
            -1.54175532e00,
            -1.40781724e00,
            -1.24580026e00,
            -1.01281571e00,
            -7.44411767e-01,
            -5.53744972e-01,
            -4.83327419e-01,
            -4.71956611e-01,
            -5.73319018e-01,
            -7.40044951e-01,
            -8.86669338e-01,
            -9.61549878e-01,
            -9.49963391e-01,
            -8.67793202e-01,
            -7.39276409e-01,
            -5.45635760e-01,
            -2.88767755e-01,
            -5.55450097e-02,
            1.98384538e-01,
            3.77711356e-01,
            4.51592982e-01,
            4.63827014e-01,
            3.45790654e-01,
            1.31006122e-01,
            -3.85993458e-02,
            -1.34637296e-01,
            -2.25380421e-01,
            -2.65511721e-01,
            -2.50943750e-01,
            -2.47265011e-01,
            -2.67003447e-01,
            -2.53604621e-01,
            -2.56199032e-01,
            -2.02568963e-01,
            -1.37861297e-01,
            -1.72937870e-01,
            -2.64791310e-01,
            -2.26205274e-01,
            -1.83704406e-01,
            -8.98757353e-02,
            8.28562453e-02,
            2.10994989e-01,
            2.76800543e-01,
            3.27799380e-01,
            3.41928959e-01,
            4.25482959e-01,
            5.59046686e-01,
            6.37618184e-01,
            6.66552603e-01,
            6.77602649e-01,
            6.63723588e-01,
            7.11792231e-01,
            8.45240235e-01,
            1.03590310e00,
            1.33581245e00,
            1.64011538e00,
            1.93321288e00,
            2.26563096e00,
            2.51836252e00,
            2.63860631e00,
            2.66424847e00,
            2.50001860e00,
            2.12655163e00,
            1.61716032e00,
            1.04775214e00,
            4.58195001e-01,
            1.30805513e-02,
            -3.20292592e-01,
            -5.19375026e-01,
            -5.95501006e-01,
            -5.68193316e-01,
            -5.08233845e-01,
            -3.56475353e-01,
            -1.89925283e-01,
            -1.86004210e-02,
            1.47792265e-01,
            2.97596246e-01,
            3.35378975e-01,
            2.80256540e-01,
            1.36483371e-01,
            -3.98510471e-02,
            -3.14325005e-01,
            -5.36477327e-01,
            -6.40489876e-01,
            -7.31175363e-01,
            -7.90397286e-01,
            -6.92656398e-01,
            -5.69527686e-01,
            -4.02327746e-01,
            -1.75589010e-01,
            2.89245304e-02,
            1.84155375e-01,
            3.88012946e-01,
            5.52726984e-01,
            6.96202636e-01,
            7.56218135e-01,
            8.18100691e-01,
            8.43226731e-01,
            8.06183577e-01,
            7.51456320e-01,
            7.44144201e-01,
            6.78022921e-01,
            5.07572532e-01,
            3.46631378e-01,
            3.34564954e-01,
            3.45247000e-01,
            3.73090684e-01,
            4.62534159e-01,
            5.52624643e-01,
            5.44102728e-01,
            5.32711625e-01,
            3.74908298e-01,
            1.77748248e-01,
            1.63909979e-02,
            -2.32363448e-01,
            -5.28924584e-01,
            -7.47311056e-01,
            -9.33508992e-01,
            -1.06670535e00,
            -1.12268996e00,
            -1.11279535e00,
            -9.32837248e-01,
            -7.47744381e-01,
            -5.91495752e-01,
            -4.36163753e-01,
            -2.94117033e-01,
            -2.78539449e-01,
            -2.52120614e-01,
            -3.63439023e-01,
            -4.83364940e-01,
            -6.42469227e-01,
            -7.36473858e-01,
            -8.38587284e-01,
            -8.82909298e-01,
            -9.46072400e-01,
            -9.75903749e-01,
            -9.56399798e-01,
            -9.38365042e-01,
            -9.37371492e-01,
            -9.27640617e-01,
            -8.55675042e-01,
            -8.66236925e-01,
            -9.05105293e-01,
            -8.18093896e-01,
        ]
    )
    assert np.isclose(result_data, refer_data).all()


def test_calc_index_OMI():
    result_data = (
        ecl.field.air_sea_interaction.calc_index_OMI(data_anormaly)
        .isel(time=slice(2, None))
        .data
    )
    refer_data = np.array(
        [
            -0.03255368,
            0.05916019,
            0.05705167,
            0.2813835,
            0.6432585,
            0.85101867,
            0.9966139,
            1.1098034,
            1.4872,
            1.8333826,
            2.2527506,
            2.5484426,
            2.6410463,
            2.3578467,
            1.7726384,
            1.3080502,
            0.8887385,
            0.45632532,
            0.01376065,
            -0.25887644,
            -0.46197987,
            -0.7228307,
            -0.9569292,
            -0.9755508,
            -0.72106695,
            -0.5171199,
            -0.36762834,
            -0.42122316,
            -0.5796082,
            -0.6144012,
            -0.6153193,
            -0.43173644,
            -0.50805986,
            -0.7633574,
            -1.1876225,
            -1.2956508,
            -1.225067,
            -1.0392464,
            -1.0179282,
            -0.9232031,
            -0.86558825,
            -0.7193347,
            -0.57595277,
            -0.4534565,
            -0.42513323,
            -0.47519737,
            -0.4721225,
            -0.54989076,
            -0.648027,
            -0.68906647,
            -0.5723683,
            -0.43991643,
            -0.24933487,
            -0.09206133,
            0.13959396,
            0.34853026,
            0.61154675,
            0.85926926,
            1.0326308,
            1.2017559,
            1.282833,
            1.3143337,
            1.177425,
            1.0338035,
            1.065685,
            1.248672,
            1.5394673,
            1.6541768,
            1.6074533,
            1.4645092,
            1.2533909,
            1.0594692,
            0.7900597,
            0.46984023,
            0.03653834,
            -0.5967832,
            -1.1510283,
            -1.5544145,
            -1.620666,
            -1.5213164,
            -1.6436465,
            -1.9134309,
            -2.2294092,
            -2.201184,
            -1.8608669,
            -1.5588865,
            -1.2741283,
            -1.076423,
            -0.87191486,
            -0.67316794,
            -0.57949275,
            -0.49525645,
            -0.4583932,
            -0.43487737,
            -0.34136918,
            -0.18785074,
            0.03594634,
            0.17373353,
            0.22861168,
            0.21174353,
            0.0963985,
            0.02277869,
            0.03258064,
            0.08175025,
            0.18582016,
            0.13092262,
            0.23393083,
            0.3030426,
            0.357513,
            0.24766687,
            0.13573168,
            0.22364354,
            0.44096515,
            0.60289204,
            0.643434,
            0.54079694,
            0.6387535,
            0.83384925,
            1.3149976,
            1.6336426,
            1.8761797,
            1.8092868,
            1.6176782,
            1.3533369,
            0.9271918,
            0.570812,
            0.13230729,
            -0.05300308,
            -0.25489983,
            -0.2445174,
            -0.1126958,
            0.06305594,
            0.20259301,
            0.29287353,
            0.490805,
            0.72181684,
            0.7725785,
            0.60841197,
            0.29480064,
            0.16845691,
            0.1566268,
            0.2335026,
            0.22994418,
            0.17602259,
            0.05563301,
            0.00284019,
            0.00501833,
            0.10179019,
            0.18569183,
            0.18331869,
            0.3004873,
            0.29879025,
            0.5409468,
            0.7677559,
            1.1101042,
            1.1872293,
            1.032873,
            0.7279069,
            0.42039835,
            0.12565686,
            -0.04217486,
            -0.16978131,
            -0.29000604,
            -0.50442314,
            -0.7551865,
            -0.92363065,
            -1.0053024,
            -0.9240173,
            -0.874887,
            -0.74610645,
            -0.6395017,
            -0.51791644,
            -0.43984824,
            -0.349108,
            -0.27311274,
            -0.2710231,
            -0.3593532,
            -0.42799073,
            -0.48463586,
            -0.52007073,
            -0.476647,
            -0.3628798,
            -0.10751499,
            0.25009018,
            0.7308718,
            1.2102854,
            1.6379539,
            1.9616301,
            2.2613134,
            2.4746225,
            2.6338642,
            2.6477828,
            2.4818797,
            2.0630934,
            1.4468384,
            0.92959684,
            0.1244318,
            -0.56692135,
            -1.2153928,
            -1.2592964,
            -1.2650799,
            -1.3103441,
            -1.5332092,
            -1.6220174,
            -1.560287,
            -1.2950932,
            -1.0813885,
            -0.9495832,
            -0.9890549,
            -0.97210133,
            -1.0862527,
            -1.0557764,
            -1.0974332,
            -1.1974441,
            -1.414076,
            -1.6841975,
            -1.6769603,
            -1.5058198,
            -1.1542351,
            -0.89655644,
            -0.73732823,
            -0.65411466,
            -0.53152615,
            -0.4783231,
            -0.5354065,
            -0.70425075,
            -0.85979575,
            -0.874624,
            -0.77834034,
            -0.58221984,
            -0.42456833,
            -0.3154298,
            -0.19174817,
            -0.07774796,
            0.02679399,
            -0.02169641,
            -0.06929319,
            -0.15581073,
            -0.23313583,
            -0.20627075,
            -0.05449368,
            0.10598688,
            0.15257165,
            0.16771017,
            0.38311175,
            0.5781987,
            0.80277395,
            0.92906356,
            1.1476935,
            1.3633026,
            1.5003375,
            1.4601827,
            1.185993,
            0.8708669,
            0.45472497,
            0.02782352,
            -0.23744822,
            -0.18306799,
            -0.00979938,
            0.14324357,
            0.25980675,
            0.3816159,
            0.4101375,
            0.31741595,
            0.24059302,
            0.0870002,
            0.02023168,
            0.02993686,
            0.09587182,
            0.22429204,
            0.3986873,
            0.63052356,
            0.7240468,
            0.70176256,
            0.69581753,
            0.6613626,
            0.5321663,
            0.39078683,
            0.2770183,
            0.3038235,
            0.31547844,
            0.29739204,
            0.20220728,
            0.05525023,
            0.01222013,
            -0.11321075,
            -0.3093225,
            -0.62161744,
            -0.72125363,
            -0.7156265,
            -0.5013083,
            -0.27904314,
            -0.00905486,
            0.09162535,
            0.20668729,
            0.36638355,
            0.60365343,
            0.8309226,
            1.0191908,
            1.0043492,
            0.6828796,
            0.26713353,
            0.00790502,
            -0.12641646,
            -0.15848154,
            -0.3067013,
            -0.416926,
            -0.6817031,
            -1.0114999,
            -1.3350708,
            -1.5513558,
            -1.6628041,
            -1.7549202,
            -1.6110197,
            -1.3389082,
            -0.9430032,
            -0.7304016,
            -0.42860132,
            -0.19226605,
            -0.11022978,
            -0.19981322,
            -0.32730407,
            -0.50824255,
            -0.71477747,
            -0.815827,
            -0.7311664,
            -0.5114217,
            -0.23560317,
            0.09194512,
            0.418552,
            0.5973606,
            0.71065694,
            0.80366015,
            1.0799159,
            1.4046841,
            1.6086892,
            1.5107198,
            1.2869668,
            0.94970495,
            0.47392353,
            -0.11342152,
            -0.68859464,
            -1.0667461,
            -1.3796698,
            -1.5456733,
            -1.6355107,
            -1.6270427,
            -1.595944,
            -1.480407,
            -1.275133,
            -1.0137618,
            -0.7454764,
            -0.49026826,
            -0.32698134,
            -0.39265272,
            -0.5596698,
            -0.77809983,
            -0.91813076,
            -1.0181692,
            -1.0397041,
            -0.9095337,
            -0.7466398,
            -0.5476751,
            -0.34428987,
            -0.07466155,
            0.23001868,
            0.49339396,
            0.5631235,
            0.50094014,
            0.3677426,
            0.17681749,
            -0.04091744,
            -0.27425367,
            -0.29977313,
            -0.22623499,
            -0.20136982,
            -0.23476155,
            -0.310728,
            -0.30225933,
            -0.23066974,
            -0.21625985,
            -0.12737073,
            -0.1178225,
            -0.16349076,
            -0.33437368,
            -0.36349985,
            -0.145315,
            0.1737035,
            0.35161182,
            0.32345867,
            0.2476273,
            0.2629236,
            0.3919268,
            0.5994159,
            0.7088708,
            0.7404426,
            0.66470635,
            0.5895203,
            0.642925,
            0.78427017,
            1.0198385,
            1.2850053,
            1.6295539,
            1.9677168,
            2.2797868,
            2.5695362,
            2.748751,
            2.805209,
            2.6320796,
            2.2492137,
            1.7161117,
            1.0036035,
            0.38476515,
            -0.14851466,
            -0.4242527,
            -0.56396306,
            -0.62567985,
            -0.62953734,
            -0.5616825,
            -0.40568408,
            -0.16558702,
            0.00476685,
            0.18651834,
            0.27876353,
            0.4068518,
            0.42437866,
            0.22554062,
            -0.08200311,
            -0.34661987,
            -0.5841174,
            -0.69722253,
            -0.7755242,
            -0.77675366,
            -0.7698198,
            -0.67106164,
            -0.4278098,
            -0.12874153,
            0.08502536,
            0.22760065,
            0.30641022,
            0.5115268,
            0.7442626,
            0.9384375,
            0.84127593,
            0.7486997,
            0.7565669,
            0.8275383,
            0.82736355,
            0.6761384,
            0.5350986,
            0.35009396,
            0.16501692,
            0.25493348,
            0.4055959,
            0.5791975,
            0.5633759,
            0.5106463,
            0.5399535,
            0.52255833,
            0.28300354,
            -0.04721487,
            -0.34988797,
            -0.472166,
            -0.65522975,
            -0.9898331,
            -1.2157906,
            -1.2461892,
            -1.0977974,
            -0.95404035,
            -0.76671976,
            -0.59088165,
            -0.3773565,
            -0.2700082,
            -0.19799468,
            -0.24512604,
            -0.2841431,
            -0.4928932,
            -0.6113841,
            -0.84857583,
            -0.86685073,
            -0.8761803,
            -0.89362645,
            -0.96071494,
            -1.0774366,
            -0.9893349,
            -0.8633347,
            -0.829406,
            -0.9127831,
            -0.93961984,
            -0.8707774,
            -0.8257758,
            -0.7667706,
        ]
    )
    assert np.isclose(result_data, refer_data).all()


def test_calc_index_nino4():
    result_data = ecl.field.air_sea_interaction.calc_index_nino4(data_anormaly).data
    refer_data = np.array(
        [
            -1.84603885e-01,
            3.29838432e-02,
            6.89351782e-02,
            1.63713664e-01,
            3.49772573e-01,
            6.34354472e-01,
            8.49203348e-01,
            5.34126937e-01,
            3.18891644e-01,
            4.62023854e-01,
            7.11768329e-01,
            5.71809411e-01,
            6.55096173e-01,
            7.51303852e-01,
            6.79835200e-01,
            5.40153682e-01,
            2.91652620e-01,
            2.39854559e-01,
            -4.78166118e-02,
            -2.02193052e-01,
            -3.54508370e-01,
            -4.90816146e-01,
            -9.48611677e-01,
            -9.34210598e-01,
            -7.06823826e-01,
            -6.47536159e-01,
            -8.99024785e-01,
            -1.04426634e00,
            -8.83287430e-01,
            -9.03565407e-01,
            -7.99436510e-01,
            -5.13493061e-01,
            -5.69868326e-01,
            -1.14996105e-01,
            -4.13491696e-01,
            -7.05610573e-01,
            -1.09074390e00,
            -5.59876084e-01,
            -5.99544823e-01,
            -8.78926277e-01,
            -8.71727288e-01,
            -8.01925421e-01,
            -8.53696644e-01,
            -5.89553058e-01,
            -4.27188307e-01,
            -3.92916143e-01,
            -4.20471668e-01,
            -1.67370632e-01,
            2.06361804e-02,
            -1.59016177e-01,
            -2.16864809e-01,
            -2.95966297e-01,
            -3.83627415e-01,
            -2.78825372e-01,
            -8.30766261e-02,
            3.86069305e-02,
            3.03791702e-01,
            4.82303828e-01,
            7.10888326e-01,
            7.37549305e-01,
            6.90856159e-01,
            7.78523803e-01,
            8.14635277e-01,
            8.12313616e-01,
            6.41812563e-01,
            4.01534617e-01,
            6.12963319e-01,
            6.38386965e-01,
            7.00131655e-01,
            8.19243789e-01,
            9.43048239e-01,
            1.13090944e00,
            9.41736221e-01,
            8.74583840e-01,
            5.69775283e-01,
            -4.63863276e-02,
            -4.33067381e-01,
            -4.98445392e-01,
            -8.09856653e-01,
            -9.97612953e-01,
            -1.07204831e00,
            -1.09591603e00,
            -1.64615166e00,
            -1.93785059e00,
            -1.78144383e00,
            -1.75573623e00,
            -1.60176480e00,
            -1.26126635e00,
            -1.05378735e00,
            -7.25725412e-01,
            -9.92376566e-01,
            -6.74733043e-01,
            -6.05648339e-01,
            -4.73156124e-01,
            -3.06311637e-01,
            -4.61230576e-01,
            1.11361463e-02,
            2.98703849e-01,
            4.98835206e-01,
            5.39773643e-01,
            3.49132597e-01,
            1.00274593e-01,
            1.33033786e-02,
            1.17666915e-01,
            4.37171757e-01,
            3.33003849e-01,
            5.43648303e-01,
            3.88169378e-01,
            6.44216061e-01,
            7.53003836e-01,
            6.07155144e-01,
            3.87793630e-01,
            5.45872629e-01,
            5.72134554e-01,
            4.35763359e-01,
            4.08226997e-01,
            5.25531590e-01,
            4.84183908e-01,
            7.72608280e-01,
            7.88489401e-01,
            9.58936155e-01,
            8.21503758e-01,
            9.19715166e-01,
            8.63453686e-01,
            8.57232571e-01,
            6.28974557e-01,
            3.99043351e-01,
            5.00626922e-01,
            1.72611758e-01,
            7.70238489e-02,
            1.08833693e-03,
            3.09693981e-02,
            2.57936180e-01,
            3.44623834e-01,
            2.85435170e-01,
            3.65073681e-01,
            3.65992576e-01,
            2.88714528e-01,
            2.59703308e-01,
            3.51806939e-01,
            2.29931667e-01,
            3.77223849e-01,
            2.33448297e-01,
            2.97069341e-01,
            3.97916168e-01,
            2.06023827e-01,
            -6.73248023e-02,
            3.89371114e-03,
            3.51526327e-02,
            1.46314561e-01,
            2.53263354e-01,
            5.46366930e-01,
            7.50171781e-01,
            5.38123846e-01,
            7.84048319e-01,
            9.66989338e-01,
            1.00491607e00,
            9.51623857e-01,
            8.96075130e-01,
            7.18513668e-01,
            3.09072614e-01,
            2.95794606e-01,
            8.51633921e-02,
            -8.42730477e-02,
            -3.16888303e-01,
            -4.75036114e-01,
            -6.24511719e-01,
            -7.28350580e-01,
            -4.60763842e-01,
            -3.64736110e-01,
            -5.84864736e-01,
            -5.45086324e-01,
            -5.19567370e-01,
            -4.30765450e-01,
            -3.84756625e-01,
            -3.71013075e-01,
            -2.07648322e-01,
            -3.00336093e-01,
            -2.73751646e-01,
            -3.58970582e-01,
            -8.32838416e-02,
            1.38603851e-01,
            1.93075180e-01,
            2.71833658e-01,
            7.52152562e-01,
            6.12054586e-01,
            4.88343328e-01,
            6.51886940e-01,
            5.49391687e-01,
            6.38243914e-01,
            6.59028292e-01,
            8.29889357e-01,
            8.22296083e-01,
            7.71643817e-01,
            7.67015159e-01,
            4.24493700e-01,
            -3.53673697e-02,
            -1.38885379e-01,
            -3.12476605e-01,
            -7.97372937e-01,
            -9.72588241e-01,
            -8.46056163e-01,
            -1.37177169e00,
            -1.47099042e00,
            -1.42912376e00,
            -1.70397615e00,
            -1.63286471e00,
            -1.35210621e00,
            -1.23712742e00,
            -9.91165400e-01,
            -9.24316645e-01,
            -9.49293017e-01,
            -1.02422822e00,
            -9.06216085e-01,
            -8.48211646e-01,
            -1.13057053e00,
            -1.29594386e00,
            -1.32615614e00,
            -1.49616480e00,
            -1.50488627e00,
            -1.21400738e00,
            -1.04738533e00,
            -8.25656593e-01,
            -6.63213015e-01,
            -4.20728326e-01,
            -2.85716087e-01,
            -5.31591654e-01,
            -6.04890645e-01,
            -9.35003817e-01,
            -7.91876078e-01,
            -8.70024800e-01,
            -6.34006321e-01,
            -3.95927310e-01,
            -2.17625409e-01,
            -9.56166089e-02,
            2.08066925e-01,
            2.30111718e-01,
            4.23863828e-01,
            3.23128283e-01,
            2.67329335e-01,
            8.01561326e-02,
            5.48763871e-01,
            6.32515192e-01,
            4.40333754e-01,
            5.09992540e-01,
            5.95214605e-01,
            7.11563349e-01,
            6.45346940e-01,
            6.82211697e-01,
            7.43263841e-01,
            8.93848240e-01,
            1.17492938e00,
            1.00137615e00,
            1.00204384e00,
            9.14335191e-01,
            7.91073680e-01,
            3.82612616e-01,
            6.14145920e-02,
            1.64403349e-01,
            2.51526892e-01,
            3.08911711e-01,
            2.97243834e-01,
            5.33268332e-01,
            6.31849349e-01,
            5.05276144e-01,
            5.59383810e-01,
            4.51755136e-01,
            1.77673712e-01,
            1.63612574e-01,
            3.04774582e-01,
            2.51743346e-01,
            5.36246955e-01,
            5.90491652e-01,
            8.94023776e-01,
            8.71568322e-01,
            8.99769366e-01,
            9.04376090e-01,
            9.52083886e-01,
            6.99635148e-01,
            6.65213645e-01,
            3.77812564e-01,
            3.24934572e-01,
            2.58583367e-01,
            1.88106939e-01,
            1.21731684e-01,
            1.23623870e-01,
            1.98288307e-01,
            -1.61706544e-02,
            -1.78763852e-01,
            -6.06776118e-01,
            -7.56784737e-01,
            -4.61326361e-01,
            -2.07427397e-01,
            5.43545745e-02,
            2.23123387e-01,
            2.15326935e-01,
            5.00431657e-01,
            6.91543818e-01,
            7.69348323e-01,
            9.68029380e-01,
            9.77336109e-01,
            6.72803819e-01,
            4.90115136e-01,
            3.20033699e-01,
            1.21152617e-01,
            -9.45438398e-04,
            4.81433868e-02,
            -5.66330440e-02,
            -1.73688293e-01,
            -6.14796102e-01,
            -8.51871669e-01,
            -1.27527058e00,
            -1.23104382e00,
            -1.66603613e00,
            -1.72820485e00,
            -1.41956627e00,
            -1.15286732e00,
            -9.68365431e-01,
            -8.51256609e-01,
            -6.11793101e-01,
            -5.60848296e-01,
            -5.88376105e-01,
            -4.02091712e-01,
            -6.08130634e-01,
            -8.07783842e-01,
            -8.66896093e-01,
            -7.71664798e-01,
            -4.57846314e-01,
            -2.18107417e-01,
            1.28234580e-01,
            2.77603388e-01,
            3.49766940e-01,
            4.76811647e-01,
            5.67443848e-01,
            9.82928216e-01,
            1.22176933e00,
            1.18273604e00,
            1.26698375e00,
            9.91095126e-01,
            9.84053612e-01,
            6.73332572e-01,
            1.71614587e-01,
            -2.97376603e-01,
            -7.82552958e-01,
            -1.27898824e00,
            -1.60419607e00,
            -1.64067161e00,
            -1.62653053e00,
            -1.63340390e00,
            -1.56425607e00,
            -1.20306480e00,
            -8.36106181e-01,
            -7.28667378e-01,
            -5.84145367e-01,
            -4.69796568e-01,
            -4.00773019e-01,
            -4.26508307e-01,
            -6.76516116e-01,
            -7.59311616e-01,
            -8.29750597e-01,
            -1.13388383e00,
            -1.18727612e00,
            -9.39724803e-01,
            -6.90666378e-01,
            -4.21227366e-01,
            -3.23505372e-01,
            -1.84956610e-01,
            2.74692918e-03,
            3.74591678e-01,
            4.02843803e-01,
            4.81588304e-01,
            4.69929338e-01,
            1.93756148e-01,
            2.34385300e-03,
            -8.63247812e-02,
            -2.68146336e-01,
            -1.12127438e-01,
            -1.40285403e-01,
            -1.55256599e-01,
            -1.05653033e-01,
            -2.03883052e-02,
            -3.06761581e-02,
            8.02832749e-03,
            2.06789449e-01,
            1.17736161e-01,
            -1.53736204e-01,
            2.23675117e-01,
            5.14993727e-01,
            5.57252645e-01,
            7.14194596e-01,
            4.98963356e-01,
            2.29086936e-01,
            4.13891703e-01,
            6.16623759e-01,
            6.24348342e-01,
            8.33089352e-01,
            8.85756075e-01,
            8.99503767e-01,
            1.01643515e00,
            1.08479369e00,
            1.16995263e00,
            1.04727459e00,
            1.02498341e00,
            9.53646839e-01,
            9.55031633e-01,
            1.03932369e00,
            1.15386832e00,
            1.64720941e00,
            1.62141609e00,
            1.40848374e00,
            1.44149506e00,
            1.30083370e00,
            8.21652651e-01,
            5.44254601e-01,
            4.30283397e-01,
            1.91386968e-01,
            -7.42883086e-02,
            -2.54576176e-01,
            -4.46191698e-01,
            -4.31610554e-01,
            -1.83203831e-01,
            -1.05336212e-01,
            -1.23124801e-01,
            -1.29566312e-01,
            6.61726147e-02,
            2.21934572e-01,
            4.66523349e-01,
            3.43707025e-01,
            1.19691677e-01,
            -3.47161591e-02,
            -1.47751674e-01,
            -2.41190642e-01,
            -2.93223888e-01,
            -2.49156192e-01,
            -2.85564810e-01,
            -1.17226347e-01,
            3.83125916e-02,
            1.41254559e-01,
            2.28243381e-01,
            2.30706975e-01,
            4.54851687e-01,
            4.54843849e-01,
            9.30008292e-01,
            9.07549441e-01,
            1.01307619e00,
            7.36263812e-01,
            9.41455126e-01,
            8.62333596e-01,
            6.62272513e-01,
            7.35354483e-01,
            7.00023293e-01,
            8.71206880e-01,
            7.64711618e-01,
            6.14423811e-01,
            9.54848289e-01,
            7.96569347e-01,
            9.99596179e-01,
            1.02076387e00,
            1.04547513e00,
            9.78493631e-01,
            7.28732526e-01,
            7.06545934e-02,
            1.30003393e-01,
            -4.66930941e-02,
            -2.88688302e-01,
            -4.47156101e-01,
            -8.10051620e-01,
            -7.86330581e-01,
            -8.83103788e-01,
            -1.17639613e00,
            -9.44044828e-01,
            -4.70406353e-01,
            -9.90674049e-02,
            -4.16854136e-02,
            -2.64365841e-02,
            -1.56173065e-01,
            -1.37748316e-01,
            -3.57816100e-01,
            -5.95591664e-01,
            -5.60010552e-01,
            -7.90403783e-01,
            -2.98896194e-01,
            -3.41524810e-01,
            -7.97086298e-01,
            -8.03727269e-01,
            -9.42225337e-01,
            -6.96776569e-01,
            -1.00155306e00,
            -1.04860818e00,
            -1.09045601e00,
            -1.04623175e00,
            -8.91610622e-01,
            -7.85723805e-01,
            -6.08876169e-01,
        ]
    )
    assert np.isclose(result_data, refer_data).all()

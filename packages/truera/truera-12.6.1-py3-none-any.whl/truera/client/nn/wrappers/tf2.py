from truera.client.nn.backend import NNBackend as NNB
from truera.client.nn.wrappers.tf import import_tf

tf = import_tf(version=2)


class Backend(NNB[tf.Tensor, tf.keras.Model]):
    Model = tf.keras.Model
    Tensor = tf.Tensor

    # TODO: These tensor wrappers have not been tested.

    # yapf: disable
    class Inputs(Tensor): ...
    class Batchable(Inputs): ...
    class Parameter(Inputs): ... # non-batchable model args
    class Embeddings(Batchable): ...
    class Masks(Batchable): ...
    class Words(Batchable): ...
    class Outputs(Tensor): ...
    class Logits(Outputs): ...
    class Probits(Outputs): ...
    # yapf: enable

import{d as T,u as D,r as _,y as S,o as B,a as n,b as p,f as R,g as l,w as o,n as g,c as m,h as c,l as v}from"./index-557e0199.js";const M={class:"iv-item"},I=T({__name:"RunScript",props:{errmode:String,sysinfo:Object,appinfo:Object},setup(w,{expose:x}){const h=w,{$gettext:i}=D(),e=_({device:{build:{form:"pc",platform:void 0,python:void 0,pyarmor:void 0},target:{same:!1,form:"pc",platform:void 0,python:void 0,pyarmor:void 0}},steps:[{ignored:!1,command:"",output:"",remark:""},{ignored:!1,command:"",output:"",remark:""},{ignored:!1,command:"",output:"",remark:""}],expected:""}),k=()=>{if(h.errmode==="unexpected"?f.value==="4":f.value==="3")return!0;f.value=`${parseInt(f.value)+1}`},$=S(()=>{const s=[],a=e.value.device.build,u=e.value.device.target,r=e.value.steps;s.push("### Environments"),s.push(`Build Machine: (${a.form}) ${a.platform}, Python ${a.python}, pyarmor ${a.pyarmor}`),s.push(u.same?"Target Machine is same as Build Machine":`Build Machine: (${u.form}) ${u.platform}, Python ${u.python}, pyarmor ${u.pyarmor}`),s.push(""),s.push("### Reproduced steps");const b=["Generate obfuscated scripts","Distibute obfuscated scripts","Run obfuscated script"];for(const d in[0,1,2])r[d].ignored||(s.push(""),s.push(`${parseInt(d)+1}. ${b[d]}:`),s.push(`${r[d].command}`),s.push(`${r[d].output}`),r[0].extra&&(s.push(`
Remark:`),s.push(`${r[d].remark}`)));return e.value.expected&&(s.push(""),s.push("### Expected result"),s.push(e.value.expected)),s.join(`
`)});B(()=>{const s=h.sysinfo,a=h.appinfo;e.value.device.build.platform=`${s.platform} ${s.arch}`,e.value.device.build.python=`${s.python.version}`,e.value.device.build.pyarmor=`${a.pyarmor}`,e.value.device.target.platform=`${s.platform} ${s.arch}`,e.value.device.target.python=`${s.python.version}`,e.value.device.target.pyarmor=`${a.pyarmor}`});const f=_("1");return x({validate:k,bugbody:$}),(s,a)=>{const u=n("el-form-item"),r=n("el-option"),b=n("el-select"),d=n("el-input"),y=n("el-form"),V=n("el-tab-pane"),C=n("el-switch"),U=n("el-tabs"),P=n("el-space");return p(),R("div",M,[l(P,{direction:"vertical"},{default:o(()=>[l(U,{modelValue:f.value,"onUpdate:modelValue":a[17]||(a[17]=t=>f.value=t),type:"card"},{default:o(()=>[l(V,{label:"Step 1",name:"1"},{default:o(()=>[l(y,{inline:!0,"label-position":"left","label-width":"120",class:"w-100"},{default:o(()=>[l(u,{class:"w-100"},{default:o(()=>[g(" This step should describe how to generate the obfuscated scripts ")]),_:1}),l(u,{label:"Build Device",class:"w-100"},{default:o(()=>[l(b,{class:"w-100",modelValue:e.value.device.build.form,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.device.build.form=t)},{default:o(()=>[l(r,{label:"Physics device (PC, Laptop, etc.)",value:"pc"}),l(r,{label:"Virtual machine (Qemu, VMWare, ECS, etc.)",value:"vm"}),l(r,{label:"CI/CD pipeline",value:"ci"}),l(r,{label:"Docker container",value:"docker"})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"Platform"},{default:o(()=>[l(d,{modelValue:e.value.device.build.platform,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.device.build.platform=t),placeholder:"linux.x86_64"},null,8,["modelValue"])]),_:1}),l(u,{label:"Python"},{default:o(()=>[l(d,{modelValue:e.value.device.build.python,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.device.build.python=t),placeholder:"3.12.2"},null,8,["modelValue"])]),_:1}),l(u,{label:"Pyarmor"},{default:o(()=>[l(d,{modelValue:e.value.device.build.pyarmor,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.device.build.pyarmor=t),placeholder:"8.5.0"},null,8,["modelValue"])]),_:1}),e.value.steps[0].ignored?v("",!0):(p(),m(u,{key:0,class:"w-100",label:c(i)("Command")},{default:o(()=>[l(d,{placeholder:"Type full pyarmor command to generate obfuscated scripts",modelValue:e.value.steps[0].command,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.steps[0].command=t)},null,8,["modelValue"])]),_:1},8,["label"])),e.value.steps[0].ignored?v("",!0):(p(),m(u,{key:1,class:"w-100",label:c(i)("Console Output")},{default:o(()=>[l(d,{modelValue:e.value.steps[0].output,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.steps[0].output=t),placeholder:`1. Try to use the minimum options to reproduce the bug
2. Try to use the simplest script to reproduce the issue
3. If console output is no more than 100 lines, paste full log here, otherwise only the first 50 lines and the last 50 lines
4. Please use debug options \`pyarmor -d gen ...\` to print more information`,rows:8,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),l(u,{class:"w-100",label:c(i)("Remark")},{default:o(()=>[l(d,{modelValue:e.value.steps[0].remark,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.steps[0].remark=t),placeholder:"Copy the content of `pyarmor.error.log` here if this file exists\nPaste the content of test script here if possible and less than 100 lines",rows:3,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),l(V,{label:"Step 2",name:"2"},{default:o(()=>[l(y,{inline:!0,"label-position":"left","label-width":"120",class:"w-100"},{default:o(()=>[l(u,{class:"w-100"},{default:o(()=>[g(" This step should describe how to distribute the obfuscated scripts to target machine ")]),_:1}),l(u,null,{default:o(()=>[l(C,{modelValue:e.value.device.target.same,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.device.target.same=t),"active-text":"Target Device is same as Build Device in step 1"},null,8,["modelValue"])]),_:1}),e.value.device.target.same?v("",!0):(p(),m(u,{key:0,label:"Target Device",class:"w-100"},{default:o(()=>[l(b,{class:"w-100",modelValue:e.value.device.target.form,"onUpdate:modelValue":a[8]||(a[8]=t=>e.value.device.target.form=t)},{default:o(()=>[l(r,{label:"Physics device (PC, Laptop, etc.)",value:"pc"}),l(r,{label:"Virtual machine (Qemu, VMWare, ECS, etc.)",value:"vm"}),l(r,{label:"CI/CD pipeline",value:"ci"}),l(r,{label:"Docker container",value:"docker"})]),_:1},8,["modelValue"])]),_:1})),e.value.device.target.same?v("",!0):(p(),m(u,{key:1,label:"Platform"},{default:o(()=>[l(d,{modelValue:e.value.device.target.platform,"onUpdate:modelValue":a[9]||(a[9]=t=>e.value.device.target.platform=t),placeholder:"linux.x86_64"},null,8,["modelValue"])]),_:1})),e.value.device.target.same?v("",!0):(p(),m(u,{key:2,label:"Python"},{default:o(()=>[l(d,{modelValue:e.value.device.target.python,"onUpdate:modelValue":a[10]||(a[10]=t=>e.value.device.target.python=t),placeholder:"3.12.2"},null,8,["modelValue"])]),_:1})),e.value.device.target.same?v("",!0):(p(),m(u,{key:3,label:"Pyarmor"},{default:o(()=>[l(d,{modelValue:e.value.device.target.pyarmor,"onUpdate:modelValue":a[11]||(a[11]=t=>e.value.device.target.pyarmor=t),placeholder:"8.5.0"},null,8,["modelValue"])]),_:1})),e.value.device.target.same?v("",!0):(p(),m(u,{key:4,class:"w-100",label:c(i)("Remark")},{default:o(()=>[l(d,{modelValue:e.value.steps[1].remark,"onUpdate:modelValue":a[12]||(a[12]=t=>e.value.steps[1].remark=t),rows:10,placeholder:"For example:\nCopy whole `dist` folder to target machine",type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"]))]),_:1})]),_:1}),l(V,{label:"Step 3",name:"3"},{default:o(()=>[l(y,{inline:!0,"label-position":"left","label-width":"100",class:"w-100"},{default:o(()=>[l(u,{class:"w-100"},{default:o(()=>[g(" This step should describe how to run the obfuscated scripts ")]),_:1}),l(u,{class:"w-100",label:c(i)("Command")},{default:o(()=>[l(d,{disabled:e.value.steps[2].ignored,placeholder:"Type full command to run the obfuscated script",modelValue:e.value.steps[2].command,"onUpdate:modelValue":a[13]||(a[13]=t=>e.value.steps[2].command=t)},null,8,["disabled","modelValue"])]),_:1},8,["label"]),l(u,{class:"w-100",label:c(i)("Console Output")},{default:o(()=>[l(d,{modelValue:e.value.steps[2].output,"onUpdate:modelValue":a[14]||(a[14]=t=>e.value.steps[2].output=t),disabled:e.value.steps[2].ignored,placeholder:"Full console output, if possible traceback",rows:8,type:"textarea"},null,8,["modelValue","disabled"])]),_:1},8,["label"]),l(u,{class:"w-100",label:c(i)("Remark")},{default:o(()=>[l(d,{modelValue:e.value.steps[2].remark,"onUpdate:modelValue":a[15]||(a[15]=t=>e.value.steps[2].remark=t),disabled:e.value.steps[2].ignored,rows:3,type:"textarea"},null,8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1})]),_:1}),w.errmode==="unexpected"?(p(),m(V,{key:0,label:"Step 4",name:"4"},{default:o(()=>[l(y,{"label-position":"top",class:"w-100"},{default:o(()=>[l(u,{label:c(i)("Expected Result")},{default:o(()=>[l(d,{modelValue:e.value.expected,"onUpdate:modelValue":a[16]||(a[16]=t=>e.value.expected=t),placeholder:"Descript the expected results",rows:10,type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})):v("",!0)]),_:1},8,["modelValue"])]),_:1})])}}});export{I as default};

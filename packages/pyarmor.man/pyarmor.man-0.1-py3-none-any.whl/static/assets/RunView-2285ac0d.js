import{d as xe,u as Ue,x as ne,r as g,y as k,o as Oe,a as m,f as b,e as _,g as o,w as n,F as T,b as r,h as u,c as v,m as j,l as N,t as h,n as S,s as $e,z as Re,A as ze,B as Te,i as je,j as Se}from"./index-557e0199.js";const Fe={class:"cb-view p-3"},Ae={class:"iv-h"},Be={class:"iv-h"},Ee={class:"pl-3 py-3"},Ke=["id"],Ge={key:0,class:"iv-v"},Ne={class:"iv-h"},Pe={key:4},De={key:1,class:"iv-v"},Ie={class:"iv-h"},Le={key:4},te="https://pyarmor.readthedocs.io/en/latest/reference/man.html",ue="_pyarmordoc",qe=xe({__name:"RunView",props:{stepinfo:Object},emits:["nextStep"],setup(se,{emit:de}){const P=se,{$gettext:s}=Ue(),U=ne("refman"),D=ne("refmodel");g(0);const B=g(!1),O=g(0),re=g("$"),w=g([]),ie=k(()=>[re.value,t.value.cmd,I.value.join(" "),t.value.child.args.join(" ")].join(" ")),y=g({path:"",dirs:[],files:[]}),t=g({path:"",cmd:"pyarmor",opts:[],child:{cmd:"gen",opts:[],args:[]},rc:!1,output:[]}),I=k(()=>{const a=[];for(const l of t.value.opts)a.push(l.label);a.push(t.value.child.cmd);for(const l of t.value.child.opts)a.push(l.label);return a}),L=k(()=>{for(const a of D.value.functions)if(a.name===t.value.child.cmd)return a}),F=k(()=>L.value.options),M=k(()=>L.value.tags),C=g([]),ce=a=>{const l=C.value.indexOf(a);C.value.splice(0),l===-1&&C.value.push(a)},ve=k(()=>C.value.length===0?F.value:F.value.filter(a=>a.tags&&a.tags.includes(C.value[0]))),q=k(()=>D.value.options),H=g(""),J=k(()=>t.value.rc===null),x=g(!1),me=a=>{w.value.push(a.msg),a.running&&(t.value.rc=null,U.value.appoutput({index:0},Q,A))},A=a=>{t.value.rc=a.err,w.value.push(a.data),x.value&&(x.value=!1)},Q=a=>{if(t.value.rc=a.rc,w.value.push(...a.lines),J.value&&!x.value){const l={index:w.value.length-1};U.value.appoutput(l,Q,A)}},pe=()=>{const a={cmd:t.value.cmd,opts:I.value,args:t.value.child.args};t.value.rc=!1,w.value.splice(0),U.value.apprun(a,me,A)},fe=a=>{x.value=!1,t.value.rc=!1,a===null?w.value.push(s("Killed successfully")):w.value.push(s("Kill failed: ")+a)},he=()=>{x.value||(x.value=!0,w.value.push(s("Killing this process ...")),w.value.push(`
`),U.value.appkill(t.value,fe,A))};Oe(()=>{const a={path:"",pattern:"*.py"},l=i=>{y.value.path=i.path,y.value.dirs.splice(0),y.value.dirs.push(...i.dirs),y.value.files.splice(0),y.value.files.push(...i.files)},c=i=>{console.log(i)};U.value.lsdir(a,l,c),P.stepinfo.group&&(t.value.child.cmd=P.stepinfo.group)});const E=(a,l,c)=>{const i=a.indexOf(l);l.value?(l.label=typeof c=="string"?c:l.type==="bool"?l.style[0]:l.type==="tree"?`${l.style[0]} ${l.value.join(",")}`:`${l.style[0]} ${l.value}`,i===-1&&a.push(l)):(l.label=null,l.value=null,i!==-1&&a.splice(i,1))},W=(a,l,c)=>{for(const i of c)if(typeof i=="string"){const f=i.split(" ",1)[0],p=l.find(V=>V.style.indexOf(f)!==-1);a.splice(c.indexOf(i),1),p?(p.value=p.type==="bool"?!0:i.substring(f.length).trim(),E(a,p,i)):U.value.showError(s(`${f} is not valid option`))}},K=a=>{typeof a!="string"&&(a.label=null,a.value=null)},X=a=>W(t.value.child.opts,F.value,a),_e=a=>W(t.value.opts,q.value,a),$=a=>E(t.value.child.opts,a),R=a=>E(t.value.opts,a),we=a=>{de("nextStep","solution",{group:"run",data:null})};return(a,l)=>{const c=m("el-option"),i=m("el-select"),f=m("el-form-item"),p=m("el-button"),V=m("el-input"),ge=m("el-icon"),Y=m("el-button-group"),G=m("el-form"),Z=m("el-col"),be=m("el-row"),ye=m("el-space"),z=m("el-table-column"),ee=m("el-switch"),le=m("el-tree-select"),ae=m("el-link"),oe=m("el-table"),Ve=m("el-drawer");return r(),b(T,null,[_("div",Fe,[o(be,null,{default:n(()=>[o(Z,{xs:24,sm:24,md:24,lg:12,xl:12},{default:n(()=>[o(G,{"label-position":"left","label-width":"6rem",model:t.value,class:"w-100 mt-3"},{default:n(()=>[o(f,{label:u(s)("Function")},{default:n(()=>[o(i,{modelValue:t.value.child.cmd,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value.child.cmd=e),onChange:l[1]||(l[1]=e=>C.value.splice(0)),placeholder:u(s)("Select sub-command"),class:"w-100"},{default:n(()=>[o(c,{label:u(s)("Register License"),value:"reg"},null,8,["label"]),o(c,{label:u(s)("Generate Obfuscated Scripts"),value:"gen"},null,8,["label"]),o(c,{label:u(s)("Generate Runtime Key"),value:"gen key"},null,8,["label"]),o(c,{label:u(s)("Generate Runtime Package"),value:"gen runtime"},null,8,["label"]),o(c,{label:u(s)("Configure"),value:"cfg"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(f,{label:u(s)("Options")},{default:n(()=>[_("div",Ae,[o(i,{modelValue:t.value.child.opts,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.child.opts=e),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:u(s)("Type option then press Enter"),onChange:l[3]||(l[3]=e=>X(t.value.value.child.opts,F.value,e)),onRemoveTag:K,class:"iv-main"},null,8,["modelValue","placeholder"]),o(p,{icon:u(Re),onClick:l[4]||(l[4]=e=>B.value=!0),text:""},null,8,["icon"])])]),_:1},8,["label"]),t.value.child.cmd==="gen"?(r(),v(f,{key:0,label:u(s)("Arguments")},{default:n(()=>[o(i,{modelValue:t.value.child.args,"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.child.args=e),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:u(s)("Input modules and packages"),class:"w-100"},{default:n(()=>[o(c,{value:"."}),(r(!0),b(T,null,j(y.value.files,e=>(r(),v(c,{value:e},null,8,["value"]))),256)),(r(!0),b(T,null,j(y.value.dirs,e=>(r(),v(c,{value:e},null,8,["value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):t.value.child.cmd==="reg"?(r(),v(f,{key:1,label:u(s)("Arguments")},{default:n(()=>[_("div",Be,[o(V,{modelValue:H.value,"onUpdate:modelValue":l[6]||(l[6]=e=>H.value=e),placeholder:u(s)("Registration filename"),class:"iv-main",clearable:""},null,8,["modelValue","placeholder"]),o(p,{icon:u(ze),text:""},null,8,["icon"])])]),_:1},8,["label"])):N("",!0),o(f,{label:u(s)("Path")},{default:n(()=>[o(V,{readonly:"",modelValue:t.value.path,"onUpdate:modelValue":l[7]||(l[7]=e=>t.value.path=e),placeholder:y.value.path,disabled:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(f,null,{default:n(()=>[J.value?(r(),v(p,{key:0,onClick:he,plain:""},{default:n(()=>[o(ge,{class:"is-loading"},{default:n(()=>[o(u(Te))]),_:1}),_("span",null,h(x.value?u(s)("Killing"):u(s)("Abort")),1)]),_:1})):(r(),v(p,{key:1,type:"primary",onClick:pe,plain:""},{default:n(()=>[_("span",null,h(u(s)("Run")),1)]),_:1})),o(Y,{class:"right"},{default:n(()=>[o(p,{type:"info",disabled:"",text:""},{default:n(()=>[S(h(u(s)("Test obfuscated scripts")),1)]),_:1}),o(p,{type:"info",disabled:"",onClick:we,text:""},{default:n(()=>[S(h(u(s)("Find solutions")),1)]),_:1})]),_:1}),o(V,{class:"pt-3","model-value":ie.value,rows:3,readonly:!0,type:"textarea"},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1}),o(Z,{xs:24,sm:24,md:24,lg:12,xl:12},{default:n(()=>[_("div",Ee,[o(V,{class:"w-100","model-value":w.value.join(""),rows:20,readonly:!0,type:"textarea"},null,8,["model-value"])])]),_:1})]),_:1})]),o(Ve,{modelValue:B.value,"onUpdate:modelValue":l[12]||(l[12]=e=>B.value=e),size:"50%","show-close":!0,direction:"ltr"},{header:n(({close:e,titleId:d,titleClass:ke})=>[_("h4",{id:d,class:$e(ke)},h(u(s)(`Options for function "${t.value.child.cmd}"`)),11,Ke),o(Y,{size:"small",class:"mr-5"},{default:n(()=>[o(p,{onClick:l[8]||(l[8]=Ce=>O.value--),disabled:O.value===0,icon:u(je)},null,8,["disabled","icon"]),o(p,{onClick:l[9]||(l[9]=Ce=>O.value++),disabled:O.value===1,icon:u(Se)},null,8,["disabled","icon"])]),_:1})]),default:n(()=>[O.value===0?(r(),b("div",Ge,[o(G,{"label-position":"top",model:t.value,class:"w-100 mt-3"},{default:n(()=>[o(f,{label:u(s)("Function Options")},{default:n(()=>[_("div",Ne,[o(i,{modelValue:t.value.child.opts,"onUpdate:modelValue":l[10]||(l[10]=e=>t.value.child.opts=e),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:u(s)("Type option with value, then press Enter"),onChange:X,onRemoveTag:K,class:"iv-main"},null,8,["modelValue","placeholder"])])]),_:1},8,["label"]),o(f,null,{default:n(()=>[M.value?(r(),v(ye,{key:0,wrap:""},{default:n(()=>[(r(!0),b(T,null,j(M.value,e=>(r(),v(p,{size:"small",type:C.value.indexOf(e)===-1?"":"primary",onClick:d=>ce(e),text:"",bg:""},{default:n(()=>[S(h(e),1)]),_:2},1032,["type","onClick"]))),256))]),_:1})):N("",!0)]),_:1})]),_:1},8,["model"]),o(oe,{data:ve.value,stripe:"",size:"small",class:"w-100"},{default:n(()=>[o(z,{width:160,label:u(s)("Option")},{default:n(e=>[_("span",null,h(e.row.style.join(", ")),1)]),_:1},8,["label"]),o(z,{label:u(s)("Value")},{default:n(e=>[e.row.type==="bool"?(r(),v(ee,{key:0,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,onChange:d=>$(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])):e.row.type==="string"?(r(),v(V,{key:1,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,size:"small",placeholder:e.row.default,onChange:d=>$(e.row),onClear:d=>$(e.row),clearable:""},null,8,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear"])):e.row.type==="enum"?(r(),v(i,{key:2,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,size:"small",class:"w-100",placeholder:e.row.default,onChange:d=>$(e.row),onClear:d=>$(e.row),clearable:""},{default:n(()=>[(r(!0),b(T,null,j(e.row.valid.split(","),d=>(r(),v(c,{value:d},null,8,["value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear"])):e.row.type==="tree"?(r(),v(le,{key:3,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,size:"small",class:"w-100",data:e.row.valid,"node-key":"value","check-strictly":!1,multiple:"","render-after-expand":!1,placeholder:" ",onChange:d=>$(e.row),"show-checkbox":""},null,8,["modelValue","onUpdate:modelValue","data","onChange"])):(r(),b("span",Pe,h(e.row.value),1))]),_:1},8,["label"]),o(z,{label:u(s)("Remark")},{default:n(e=>[o(ae,{style:{"word-break":"normal"},href:`${te}${e.row.link}`,target:ue,underline:!1},{default:n(()=>[S(h(e.row.comment),1)]),_:2},1032,["href"])]),_:1},8,["label"])]),_:1},8,["data"])])):O.value===1?(r(),b("div",De,[o(G,{"label-position":"top",model:t.value,class:"w-100 mt-3"},{default:n(()=>[o(f,{label:u(s)("Common Options")},{default:n(()=>[_("div",Ie,[o(i,{modelValue:t.value.opts,"onUpdate:modelValue":l[11]||(l[11]=e=>t.value.opts=e),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:u(s)("Type option with value, then press Enter"),onChange:_e,onRemoveTag:K,class:"iv-main"},null,8,["modelValue","placeholder"])])]),_:1},8,["label"])]),_:1},8,["model"]),o(oe,{data:q.value,size:"small",class:"w-100",stripe:""},{default:n(()=>[o(z,{label:u(s)("Option")},{default:n(e=>[_("span",null,h(e.row.style.join(", ")),1)]),_:1},8,["label"]),o(z,{label:u(s)("Value")},{default:n(e=>[e.row.type==="bool"?(r(),v(ee,{key:0,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,onChange:d=>R(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])):e.row.type==="string"?(r(),v(V,{key:1,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,size:"small",placeholder:e.row.default,onChange:d=>R(e.row),onClear:d=>R(e.row),clearable:""},null,8,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear"])):e.row.type==="enum"?(r(),v(i,{key:2,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,size:"small",class:"w-100",placeholder:e.row.default,onChange:d=>R(e.row),onClear:d=>R(e.row),clearable:""},{default:n(()=>[(r(!0),b(T,null,j(e.row.valid.split(","),d=>(r(),v(c,{value:d},null,8,["value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear"])):e.row.type==="tree"?(r(),v(le,{key:3,modelValue:e.row.value,"onUpdate:modelValue":d=>e.row.value=d,size:"small",class:"w-100",data:e.row.valid,"node-key":"value","check-strictly":!1,multiple:"","render-after-expand":!1,placeholder:" ",onChange:d=>R(e.row),"show-checkbox":""},null,8,["modelValue","onUpdate:modelValue","data","onChange"])):(r(),b("span",Le,h(e.row.value),1))]),_:1},8,["label"]),o(z,{label:u(s)("Remark")},{default:n(e=>[o(ae,{style:{"word-break":"normal"},href:`${te}${e.row.link}`,target:ue,underline:!1},{default:n(()=>[S(h(e.row.comment),1)]),_:2},1032,["href"])]),_:1},8,["label"])]),_:1},8,["data"])])):N("",!0)]),_:1},8,["modelValue"])],64)}}});export{qe as default};

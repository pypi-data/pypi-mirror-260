"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[9788],{56507:(e,t,n)=>{function r(e){return"dashboardState"in e&&"onDashboardChange"in e&&"pageKey"in e&&"leafKey"in e&&"layoutPath"in e}n.d(t,{F:()=>r})},37678:(e,t,n)=>{n.d(t,{s:()=>s});var r=n(66029),i=n(917),a=n(9438);const o=2e3;function s(){const e=(0,i.I0)(),t=(0,a.p)();return(0,r.useCallback)((async function({action:n,promise:r}){e({type:"statusNotificationAdded",id:t,action:n});try{const n=await r;return e({type:"statusNotificationSettled",id:t,status:"fulfilled"}),setTimeout((()=>{e({type:"statusNotificationRemoved",id:t})}),o),n}catch(n){throw e({type:"statusNotificationSettled",id:t,status:"rejected"}),n}}),[e,t])}},92563:(e,t,n)=>{n.d(t,{Ct:()=>h,oM:()=>u,u_:()=>d,uo:()=>m});var r=n(77026),i=n(66029),a=n(58425),o=n(49941),s=n(57423);const l=(0,i.createContext)(void 0),d=l.Provider;function c(e){const t=(0,i.useContext)(l);if(!1===e?.throwIfMissing)return t;if(!t)throw new o.c;return t}function u(){return c().activePivot}function m(e){const t=c();if(void 0===e)return;const n=t.activePivot[e];if(!n)throw new a.D(e,Object.keys((0,r.pickBy)(t.activePivot,r.identity)));return n}function h(e){const t=c(e);if(!1===e?.throwIfMissing)return t?.content;const{content:n}=t;if(!n)throw new s.M;return n}},12880:(e,t,n)=>{n.d(t,{a:()=>s,d:()=>o});var r=n(66029),i=n(51478);const a=(0,r.createContext)(null),o=a.Provider;function s(){const e=(0,r.useContext)(a);if(!e)throw new i.b;return e}},69248:(e,t,n)=>{n.d(t,{D:()=>a,u:()=>o});var r=n(66029);const i=(0,r.createContext)(null),a=i.Provider;function o(){return(0,r.useContext)(i)}},14947:(e,t,n)=>{n.d(t,{X:()=>a,s:()=>o});var r=n(66029);const i=(0,r.createContext)(null),a=i.Provider;function o(){return(0,r.useContext)(i)}},58425:(e,t,n)=>{n.d(t,{D:()=>r});class r extends Error{serverKey;constructor(e,t){super(`No ActivePivot client was found for the server key "${e}". Existing server keys are: ${JSON.stringify(t)}.`),this.serverKey=e}}},49941:(e,t,n)=>{n.d(t,{c:()=>r});class r extends Error{constructor(){super("No clients found. Did you forget to provide them with `<ClientsProvider />` ?")}}},57423:(e,t,n)=>{n.d(t,{M:()=>r});class r extends Error{constructor(){super("ContentClient not found. Did you forget to provide it with `<ClientsProvider />` ?")}}},84978:(e,t,n)=>{n.d(t,{A:()=>r});class r extends Error{serverKey;constructor({serverKey:e,existingServerKeys:t}){super((({serverKey:e,existingServerKeys:t})=>t?`No data model was found for server key "${e}" in the ClientsContext. Existing server keys are: ${JSON.stringify(t)}`:"No data models were provided.")({serverKey:e,existingServerKeys:t})),this.serverKey=e}}},51478:(e,t,n)=>{n.d(t,{b:()=>r});class r extends Error{constructor(){super("No user found. Did you forget to provide it with `<UserProvider />`?")}}},5405:(e,t,n)=>{n.d(t,{X:()=>l});var r=n(77026),i=n(66029),a=n(19078),o=n(92563),s=n(12880);function l(e){const t=(0,o.Ct)({throwIfMissing:!1}),{username:n}=(0,s.a)(),l=(0,a.useGetCompositeSnapshot)((()=>{if(!t)return{value:null,isLoading:!1};const[n,{isLoading:r}]=t.getActivity(e);return{value:n,isLoading:r}})),{value:d,isLoading:c}=(0,i.useSyncExternalStore)((n=>t?.subscribeToActivity(e,n)??r.noop),l),u=(0,i.useCallback)((r=>t?.updateActivity({username:n,key:e,value:r})),[t,e,n]);return[d,u,{isLoading:c}]}},34220:(e,t,n)=>{n.d(t,{k:()=>a});var r=n(84978),i=n(14139);function a(e){const t=(0,i.T)();if(void 0===e)return;const n=t[e];if(!n)throw new r.A({serverKey:e,existingServerKeys:Object.keys(t)});return n}},14139:(e,t,n)=>{n.d(t,{T:()=>s});var r=n(77026),i=n(66029),a=n(19078),o=n(92563);function s(){const e=(0,o.oM)(),t=(0,i.useCallback)((t=>{const n=Object.values(e).map((e=>e.subscribeToDataModel(t)));return()=>{for(const e of n)e()}}),[e]),n=(0,a.useGetCompositeSnapshot)((()=>(0,r.reduce)(e,((e,t,n)=>({...e,...t.dataModel?{[n]:t.dataModel}:{}})),{})));return(0,i.useSyncExternalStore)(t,n)}},47764:(e,t,n)=>{n.d(t,{g:()=>d});var r=n(77026),i=n(66029);const a={canManageContent:!0,canShare:!1,canUseCalculatedMeasures:!1,canUseUserFilters:!1,canUseUserQueryContext:!1,tools:"*",applicationMenus:"*",widgets:"*",widgetMenuItems:"*",widgetTitleBarButtons:"*"};var o=n(19078),s=n(92563),l=n(12880);function d(e){const t=(0,s.Ct)(),{username:n}=(0,l.a)(),d=(0,o.useGetCompositeSnapshot)((()=>t?{...t.getPermission(e),isLoaded:t.getArePermissionsLoaded()}:{value:a[e],isLoaded:!1,isSet:!1})),{value:c,isLoaded:u,isSet:m}=(0,i.useSyncExternalStore)((n=>t?.subscribeToPermission(e,n)??r.noop),d),h=(0,i.useCallback)((r=>t.updatePermission({username:n,key:e,value:r})),[t,e,n]);return[c,h,{isLoading:!u,isSet:m}]}},9440:(e,t,n)=>{n.d(t,{b:()=>o});var r=n(77026),i=n(66029),a=n(92563);function o({serverKey:e,queryId:t,query:n}){const o=(0,a.uo)(e);(0,i.useEffect)((()=>{o&&t&&n&&o.setQuery(t,n)}),[o,t,n]);const s=(0,i.useCallback)((e=>o&&t?o.subscribeToQueryResult(t,e):r.noop),[o,t]),l=(0,i.useSyncExternalStore)(s,(()=>o&&t?o.getQueryResult(t):void 0)),d=(0,i.useRef)(n),c=Boolean(n&&d.current&&!((u=n)===(m=d.current)||u.mdx===m.mdx&&u.updateMode===m.updateMode&&(0,r.isEqual)(u.context,m.context)&&(0,r.isEqual)(u.ranges,m.ranges)));var u,m;return d.current=n,(0,i.useMemo)((()=>l?{...l,isLoading:l.isLoading||c}:{isLoading:Boolean(o&&t&&n)}),[l,c,o,t,n])}},63342:(e,t,n)=>{n.d(t,{y:()=>d});var r=n(77026),i=n(66029);const a={"dataModel.isSimplified":!0,homePageLayout:"grid","mdx.doesIncludeCalculatedMembers":!1,"search.maxResults":1e3,"smartFiltering.ignoredHierarchies":[],"smartFiltering.isEnabled":!0,"smartFiltering.nonEmptyEvaluationMeasureName":n(67242).Z,theme:"light-activeviam","drillthrough.defaultSelectedColumns":{},"unsavedChangesPopup.isEnabled":!0,csvSeparator:",","table.animations.areEnabled":!0,"table.animations.threshold":0,"table.animations.duration":10,"table.defaultSize":"large","table.tooltips":!1,"table.headers.wrap":!1};var o=n(19078),s=n(92563),l=n(12880);function d(e){const t=(0,s.Ct)({throwIfMissing:!1}),{username:n}=(0,l.a)(),d=(0,o.useGetCompositeSnapshot)((()=>t?{value:t.getSetting(e),isLoaded:t.getAreSettingsLoaded()}:{value:a[e],isLoaded:!1})),{value:c,isLoaded:u}=(0,i.useSyncExternalStore)((n=>t?.subscribeToSetting(e,n)??r.noop),d),m=(0,i.useCallback)((async r=>t?.updateSetting({username:n,key:e,value:r})),[t,e,n]);return[c,m,{isLoading:!u}]}},99189:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(66029),i=n(92563);function a(e){const t=(0,i.Ct)();return(0,r.useSyncExternalStore)((n=>t.subscribeToTree(e,n)),(()=>t.getTree(e)))}},10756:(e,t,n)=>{n.d(t,{g:()=>i});var r=n(30553);function i(e,t){const n=(0,r.X)(e,t)?.entry?.content;if(!n)throw new r.x(t);return n}},30553:(e,t,n)=>{n.d(t,{X:()=>i,x:()=>r});class r extends Error{id;constructor(e){super(`Missing metadata for file with id "${e}"`),this.id=e}}function i(e,t){const n=e?.children?.[`${t}_metadata`];if(!n)throw new r(t);return n}},61986:(e,t,n)=>{n.d(t,{q:()=>i});var r=n(10756);function i(e,t){return Boolean((0,r.g)(e,t).isFolder)}},37097:(e,t,n)=>{function r({tree:e,path:t}){if(e&&t)return t.reduce(((e,t)=>e?.children?.[t]),e)}n.d(t,{D:()=>r})},75093:(e,t,n)=>{function r({currentUserName:e,canShare:t,parentFolderOwners:n,parentFolderReaders:r,isParentFolderRoot:i,doesInheritParentFolderPermissions:a=!0}){return t&&!i&&a?{owners:[e,...n.filter((t=>t!==e))],readers:[e,...r.filter((t=>t!==e))]}:{owners:[e],readers:[e]}}n.d(t,{s:()=>r})},46533:(e,t,n)=>{n.d(t,{T:()=>o,m:()=>a});var r=n(66029);const i=(0,r.createContext)(null),a=i.Provider;function o(){return(0,r.useContext)(i)}},76713:(e,t,n)=>{if(n.d(t,{Qx:()=>s,oT:()=>u,gS:()=>l,qk:()=>d,wF:()=>c}),1460==n.j)var r=n(17967);var i=n(66029);class a extends Error{constructor(){super("Missing DataModelClickListenersProvider. Did you forget to add one to the root of your application?")}}const o=(0,i.createContext)(null),s=({children:e})=>{const t=(0,i.useRef)({node:new Set,"new-calculated-measure":new Set,"new-kpi":new Set});return(0,r.tZ)(o.Provider,{value:t.current,children:e})};function l(e){const t=(0,i.useContext)(o);if(null===t)throw new a;const n=t.node;(0,i.useEffect)((()=>(n.add(e),()=>{n.delete(e)})),[e,n])}function d(e){const t=(0,i.useContext)(o);if(null===t)throw new a;const n=t["new-calculated-measure"];(0,i.useEffect)((()=>(n.add(e),()=>{n.delete(e)})),[e,n])}function c(e){const t=(0,i.useContext)(o);if(null===t)throw new a;const n=t["new-kpi"];(0,i.useEffect)((()=>(n.add(e),()=>{n.delete(e)})),[e,n])}function u(){const e=(0,i.useContext)(o);if(null===e)throw new a;return t=>{"node"===t.type?e.node.forEach((e=>{e(t.node)})):e[t.type].forEach((e=>{e()}))}}},21538:(e,t,n)=>{n.d(t,{$:()=>o});var r=n(78613);const i={measuresRoot:1,kpisRoot:2,setsRoot:3},a=(e,t)=>{const n=(i[e.type]||10)-(i[t.type]||10);return 0!==n?n:"level"===e.type&&"level"===t.type&&e.depth!==t.depth?e.depth-t.depth:e.isFolder===t.isFolder||"hierarchy"===e.type&&"hierarchy"===t.type?"kpiFolder"===e.type!=("kpiFolder"===t.type)?"kpiFolder"===e.type?-1:1:(e.caption||"").toLowerCase()<(t.caption||"").toLowerCase()?-1:1:e.isFolder?-1:1},o=(e,t,n)=>{const i=e.children?.find((e=>e.caption===t));if(!i||!i.children)return[];const o=i.children.find((e=>e.name===n));return o&&(0,r.S)(o,a).children||[]}},56403:(e,t,n)=>{n.d(t,{J:()=>d});var r=n(77026),i=n(44918);const a=({cubeName:e,measure:t,serverKey:n,disabledMeasures:i,accumulator:o,pathToMeasure:s})=>{if(0===s.length)o.push({caption:t.caption,cubeName:e,dragItem:{fieldType:"measure",measure:t,type:"DATA_TREE_FIELD"},isDisabled:(i||[]).includes(t.name),measure:t,serverKey:n,type:"measure"});else{let l=o.find((e=>e.isFolder&&e.caption===s[0]));l||(l={caption:s[0],cubeName:e,serverKey:n,type:"measuresFolder",isActionable:!1,isFolder:!0,children:[]},o.push(l)),a({cubeName:e,measure:t,serverKey:n,disabledMeasures:i,accumulator:l.children,pathToMeasure:(0,r.drop)(s)})}},o=({cubeName:e,measures:t,serverKey:n},{disabledMeasures:r})=>{const i=t.filter((({visible:e})=>e)),o=[];return i.forEach((t=>{a({cubeName:e,serverKey:n,disabledMeasures:r,measure:t,pathToMeasure:t.folder&&""!==t.folder.trim()?t.folder.split("\\"):[],accumulator:o})})),o},s=({cubeName:e,kpi:t,serverKey:n},{disabledKpiProperties:a=[]})=>{const o=(0,r.pick)(t,"value","goal","status","trend","start","expiry");return{caption:t.caption,children:(0,r.map)(o,((o,s)=>{const l=s,d=t.name,c=(0,r.upperFirst)(l),u=`KPI${c}`,m=(0,i.I)(o)[1];return{caption:`${c} (${m})`,cubeName:e,dragItem:{fieldType:"kpiProperty",kpiName:d,kpiPropertyName:u,type:"DATA_TREE_FIELD",underlyingMeasureName:m},isDisabled:a.some((e=>e.kpiName===d&&e.kpiPropertyName===u)),kpiName:d,kpiPropertyName:u,serverKey:n,type:"kpiProperty",underlyingMeasureName:m}})),cubeName:e,isActionable:!1,isFolder:!0,serverKey:n,type:"kpi"}},l=({cubeName:e,kpis:t,serverKey:n},{disabledKpiProperties:i})=>{if(0===t.length)return[];const[a,o]=(0,r.partition)(t,(e=>e.folder));return[{caption:"Kpis",children:[...(0,r.map)((0,r.groupBy)(a,(e=>e.folder)),((t,r)=>({caption:r,cubeName:e,children:t.map((t=>s({cubeName:e,kpi:t,serverKey:n},{disabledKpiProperties:i}))),isFolder:!0,isActionable:!1,type:"kpiFolder",serverKey:n}))),...o.map((t=>s({cubeName:e,kpi:t,serverKey:n},{disabledKpiProperties:i})))],cubeName:e,isActionable:!1,isFolder:!0,serverKey:n,type:"kpisRoot"}]},d=(e,t,n={doesIncludeKpis:!0})=>({caption:e,children:Object.values(t.catalogs).map((t=>({caption:t.name,type:"catalog",children:Object.values(t.cubes).map((t=>({caption:t.caption,name:t.name,type:"cube",serverKey:e,children:[...o({cubeName:t.name,measures:Object.values(t.measures),serverKey:e},n),...!1===n.doesIncludeKpis?[]:l({cubeName:t.name,kpis:Object.values(t.kpis),serverKey:e},n)],isFolder:!0}))),isFolder:!0}))),isFolder:!0,type:"server"})},31735:(e,t,n)=>{n.d(t,{x:()=>i});var r=n(20500);function i(e){return(0,r.A)(e)&&"dimension"===e.fieldType}},72826:(e,t,n)=>{n.d(t,{W:()=>i});var r=n(20500);function i(e){return(0,r.A)(e)&&"hierarchy"===e.fieldType}},85774:(e,t,n)=>{n.d(t,{k:()=>i});var r=n(20500);function i(e){return(0,r.A)(e)&&"level"===e.fieldType}},20500:(e,t,n)=>{function r(e){return"DATA_TREE_FIELD"===e.type}n.d(t,{A:()=>r})},65195:(e,t,n)=>{function r(e){return"measure"===e.type}n.d(t,{d:()=>r})},91424:(e,t,n)=>{n.d(t,{X:()=>p});var r=n(17967),i=n(9617),a=n(66029),o=n(93481),s=n(47764),l=n(12880),d=n(92563),c=n(24051),u=n(18125),m=n(33575),h=n(19078);const p=e=>{const{formatMessage:t}=(0,o.useIntl)(),[n]=(0,s.g)("canShare"),[p,g]=(0,a.useState)(!1),{username:y}=(0,l.a)(),f=(0,d.Ct)(),[v,b]=(0,a.useState)(t({id:"aui.contentTree.newFolder"})),[x,C]=(0,a.useState)((()=>{const{owners:t=[],readers:r=[]}=e.parentFolder||{};return(0,c.Q)({currentUserName:y,parentFolderOwners:t,parentFolderReaders:r,canShare:n,isParentFolderRoot:0===e.pathToParentFolder.length})})),T=(0,a.useRef)(null);return(0,a.useEffect)((()=>{T?.current?.focus({cursor:"all"})}),[]),(0,r.tZ)(h.Modal,{destroyOnClose:!0,closable:!0,open:e.isVisible,onOk:async()=>{if(!p){g(!0);const{owners:t,readers:n}=(0,u.X)(x,y);await f.createFolder({name:v,owners:t,pathToParentFolder:e.pathToParentFolder,readers:n,type:e.contentType}),await f.loadTree(e.contentType),g(!1),e.onSubmit()}},okButtonProps:{disabled:""===v,loading:p},cancelButtonProps:{disabled:p},onCancel:()=>{p||e.onCancel()},title:e.title,okText:t({id:"aui.create"}),cancelText:t({id:"aui.cancel"}),children:(0,r.BX)(i.Form,{layout:"vertical",children:[(0,r.tZ)(i.Form.Item,{label:t({id:"aui.folderName"}),colon:!1,children:(0,r.tZ)(i.Input,{ref:T,value:v,onChange:e=>b(e.target.value),placeholder:t({id:"aui.enterFolderName"})})}),n&&(0,r.tZ)(i.Form.Item,{label:t({id:"aui.shareFolder"}),colon:!1,children:(0,r.tZ)(m.u,{permissions:x,onPermissionsChange:C})})]})})}},46354:(e,t,n)=>{n.d(t,{m:()=>ae});var r=n(17967),i=n(50083),a=n(58736),o=n(9617),s=n(77026),l=n(66029),d=n(93481),c=n(23356),u=n(2780),m=n(43292),h=n(12880),p=n(47764),g=n(99189),y=n(92563),f=n(37097),v=n(10756),b=n(75093),x=n(85578),C=n(47478),T=n(54935),S=n(96370),w=n(19078),N=n(83794),F=n(61986),P=n(16108),M=n(1347),I=n(30553);const D=e=>"widgetKey"in e;var k=n(70506);const E=e=>{const t=e.widgetKey,[n]=(0,k.useWidgetPlugins)(t?[t]:[]);return n&&n.Icon?(0,r.tZ)(n.Icon,{style:e.style}):(0,r.tZ)(x.IconPuzzle,{style:e.style})},R=({contentType:e,metaData:t,style:n})=>{switch(e){case"widget":return(0,r.tZ)(E,{style:n,widgetKey:D(t)?t.widgetKey:void 0});case"filter":return(0,r.tZ)(i.FilterFilled,{style:n});default:return(0,r.tZ)(i.LayoutFilled,{style:n})}},Z=["year","month","week","day","hour","minute","second"],A=[31536e3,2592e3,604800,86400,3600,60,1],O=({row:e,isActive:t,isBeingEdited:n,isDisabled:a,areLastEditorAndLastEditedColumnsVisible:c,isSelected:u,onFolderRenamingCanceled:m,onFolderRenamingEnded:p,pathToParentFolder:g,contentType:y,small:f,hasCheckbox:b,ghostActions:C,onChecked:S,hasDragIcon:N,isDraggable:F})=>{const P=(0,l.useRef)(null),M=(0,v.g)(e.record,e.id),{formatMessage:D,formatRelativeTime:k}=(0,d.useIntl)(),{username:E}=(0,h.a)(),O=(0,T.Fg)(),[B,L]=(0,l.useState)(M.name),[V,$]=(0,l.useState)(!1),K=()=>{L(M.name),m?.()},W=()=>{B&&""!==B.trim()?($(!0),p?.([...g,e.id],{...M,name:B})):K()},X=V?B:M.name||D({id:`aui.default${(0,s.upperFirst)(y)}Name`}),{entry:{lastEditor:H,timestamp:G}}=(0,I.X)(e.record,e.id),_=f?9:18,{duration:j,timeUnit:q}=(e=>{if(!e)return{};const t=((new Date).getTime()-e)/1e3;for(let e=0;e<Z.length;e++){const n=Math.floor(t/A[e]);if(n>=1)return{duration:n,timeUnit:Z[e]}}return{duration:0,timeUnit:"second"}})(G);return(0,r.BX)("div",{ref:P,css:{width:"100%",display:"flex",overflow:"hidden",alignItems:"center",".drag-icon":{color:O.grayScale[6],opacity:0,":hover":{color:O.grayScale[8]}},":hover":{".drag-icon":{opacity:F?1:0},".ghost-icons":{display:n?"none":"flex"}}},style:t&&b?{outline:`1px solid ${O.headerActiveColor}`}:void 0,children:[(0,r.BX)(l.Fragment,{children:[(0,r.BX)("div",{style:{padding:"5px 0px",cursor:"pointer",display:"flex",alignItems:"center"},onClick:e=>{e.stopPropagation(),S?.(e)},children:[N?(0,r.tZ)(x.IconDrag,{className:"drag-icon",style:{cursor:F?"grab":"pointer",fontSize:12,marginLeft:2}}):null,b?(0,r.tZ)(o.Checkbox,{style:{marginRight:_,marginLeft:2},checked:u}):null]}),(0,r.tZ)("div",{style:{marginLeft:b?0:_,marginRight:_},children:M.isFolder?(0,r.tZ)(i.FolderFilled,{style:{color:O.grayScale[8]}}):(0,r.tZ)(R,{contentType:y,metaData:M,style:{color:O.grayScale[8]}})}),n?(0,r.tZ)(o.Input,{value:B,onChange:e=>L(e.target.value),autoFocus:!0,onFocus:e=>e.target.select(),onBlur:W,onKeyUp:e=>{"Enter"===e.key?W():"Escape"===e.key&&K()},style:{border:"none",padding:0,boxShadow:"none",backgroundColor:"transparent"}}):(0,r.tZ)(w.Text,{disabled:a,style:{paddingRight:8,width:"100%",color:"inherit"},ellipsis:{tooltip:X},small:f,children:X}),c&&(0,r.BX)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r.tZ)("span",{style:{width:100},children:H===E?D({id:"aui.me"}):H}),(0,r.tZ)("span",{style:{width:100},children:j&&j>0?k(-j,q,{numeric:"auto",style:"long"}):D({id:"aui.justNow"})})]})]}),C]})},B={rename:i.EditOutlined,delete:i.DeleteOutlined,share:i.ShareAltOutlined},L=["rename","delete","share"],V=({index:e,style:t,data:{activeRowIndex:n,contentType:i,rows:c,rowStyle:u,pathToParentFolder:m,onItemSelected:h,onFolderDoubleClicked:p,onFileDoubleClicked:f,onFileClicked:v,onFolderClicked:b,areLastEditorAndLastEditedColumnsVisible:x,onFileOrFolderRenamingCanceled:C,onFileOrFolderRenamingEnded:S,idOfFileOrFolderBeingRenamed:I,onFileOrFolderRenamingStarted:D,selectedRanges:k,disabledPaths:E,disabledFileOrFolderTooltipMessage:R,getDragItem:Z,hasGhostActions:A,small:V,hasCheckbox:$}})=>{const K=(0,T.Fg)(),W=(0,y.Ct)(),X=c[e],H=Z&&Z(X.id,X.metaData),{formatMessage:G}=(0,d.useIntl)(),[_,j]=(0,l.useState)(),q=(0,w.useIsModalMounted)("share"===_),U=E&&E.some((e=>(0,s.isEqual)(e,[...m,X.id]))),z=!U&&void 0!==H&&!X.metaData.isFolder,[,Q]=(0,N.useDrag)({type:H?.type??"UNKNOWN_DRAG_ITEM",canDrag:()=>z,item:()=>H??null}),Y=n===e,J=k.some((t=>t.from<=e&&e<=t.to)),ee=(e,t)=>{U||h({index:e,isExtending:t.shiftKey,isResetting:!t.shiftKey&&!t.ctrlKey})},te=(0,g.Z)(i),ne=async()=>{const e=[...m,X.id];X.metaData.isFolder?te&&await W.deleteFolder({contentTree:te,path:e,type:i}):await W.deleteFile({type:i,path:e}),await W.loadTree(i),re()},re=()=>{j(void 0)},ie=G({id:"aui.areYouSure"},{action:G({id:"aui.delete"}).toLocaleLowerCase()}),ae=[G({id:"aui.contentTree.deleteWarning"},{name:X.metaData.name}),G({id:"aui.cannotBeUndone"})],oe=X.canWrite,se=X.content?.isFolder?"folder":i,le=L.map((e=>{const t=B[e],n=(0,r.tZ)(o.Button,{css:a.css`
          padding: 0px 4px;
          color: ${K.grayScale[7]};

          :hover {
            color: ${K.grayScale[9]} !important;
            background-color: ${(0,M.U)(K.black,.05)} !important;
          }
        `,disabled:!oe,type:"text",onClick:()=>(e=>{oe&&("rename"===e?D(X.id):j(e))})(e),children:(0,r.tZ)(t,{})});return"delete"===e&&oe?(0,r.tZ)(w.Popconfirm,{title:ie,content:ae,placement:"right",okText:G({id:"aui.delete"}),cancelText:G({id:"aui.cancel"}),onConfirm:ne,children:n}):(0,r.tZ)(w.Tooltip,{trigger:oe?[]:["hover"],placement:"top",title:G({id:"aui.contentTree.notAllowedToPerformAction"},{itemType:se,action:e}),children:n})})),de=A?(0,r.tZ)("div",{className:"ghost-icons",css:a.css`
        display: none;
        cursor: pointer;
        justify-content: flex-end;
        align-items: center;
        right: 0;
        background-color: inherit;
      `,onClick:e=>{e.stopPropagation()},children:le}):void 0,ce=(0,r.tZ)("div",{ref:z?Q:void 0,css:{...J||Y&&!$?{backgroundColor:K.selectionColor}:{backgroundColor:K.backgroundColor,":hover":{backgroundColor:K.grayScale[3]}}},style:{...(0,s.omit)(t,"width"),right:0,display:"flex",alignItems:"center",borderBottom:`solid 1px ${K.grayScale[5]}`,transition:"background-color 0.5s",color:K.textColor,cursor:"pointer",...u},onDoubleClick:()=>{U||(X.metaData.isFolder?p([...m,X.id]):f(X.id,X.metaData))},onClick:t=>{U||I||(X.metaData.isFolder?b?.([...m,X.id]):v(X.id,X.metaData),$||ee(e,t))},onContextMenu:t=>{J||ee(e,t)},children:(0,r.tZ)(O,{row:X,isActive:Y,areLastEditorAndLastEditedColumnsVisible:x,isBeingEdited:I===X.id,isSelected:J,isDisabled:U,onFolderRenamingCanceled:C,onFolderRenamingEnded:S,pathToParentFolder:m,contentType:i,hasCheckbox:$,ghostActions:de,onChecked:t=>{U||h({index:e,isExtending:t.shiftKey,isResetting:!1})},small:V,hasDragIcon:void 0!==Z,isDraggable:z})});return(0,r.BX)(l.Fragment,{children:[R?(0,r.tZ)(w.Tooltip,{trigger:U?["hover"]:[],placement:"left",title:R,children:ce}):ce,q&&(0,r.tZ)(P.V,{isVisible:"share"===_,id:X.id,entry:X.record.entry,onCancel:re,onSubmit:re,pathToParentFolder:m,contentType:i,isFolder:(0,F.q)(X.record,X.id)})]})},$=e=>{const{contentType:t,disabledTooltipMessage:n,isDisabled:a,onAfterSubmit:o,pathToParentFolder:s,selectedFilesAndFolders:l}=e,{formatMessage:c}=(0,d.useIntl)(),u=(0,y.Ct)(),m=[];l.forEach((e=>{"record"in e&&m.push(e.id)}));const h=c({id:"aui.areYouSure"},{action:c({id:"aui.delete"}).toLocaleLowerCase()}),p=[c({id:"aui.contentTree.deleteAllWarning"}),c({id:"aui.cannotBeUndone"})];return(0,r.tZ)(w.Tooltip,{trigger:a?["hover"]:[],placement:"right",title:n,children:(0,r.tZ)(w.Popconfirm,{content:p,title:h,disabled:a,okText:c({id:"aui.delete"}),cancelText:c({id:"aui.cancel"}),onConfirm:async()=>{await u.deleteFilesAndFolders({type:t,pathToParentFolder:s,idsToDelete:m}),o&&o()},placement:"right",children:(0,r.tZ)(i.DeleteOutlined,{style:{cursor:"pointer"}})})})},K=e=>{const{formatMessage:t}=(0,d.useIntl)();return(0,r.tZ)("span",{className:"hoverable-sort-icon",children:void 0===e.sortDirection||"asc"===e.sortDirection?(0,r.tZ)(w.Tooltip,{title:t({id:"asc"===e.sortDirection?"aui.sortDesc":"aui.sortAsc"}),placement:"bottom",children:(0,r.tZ)(i.SortAscendingOutlined,{onClick:()=>e.onSortIconClicked("asc"===e.sortDirection?"desc":"asc")})}):(0,r.tZ)(w.Tooltip,{title:t({id:"aui.sortAsc"}),placement:"bottom",children:(0,r.tZ)(i.SortDescendingOutlined,{onClick:()=>e.onSortIconClicked("asc")})})})},W=({width:e,columns:t,sortedBy:n,onSortedByChanged:i,height:o})=>{const s=(0,T.Fg)();return(0,r.tZ)("div",{style:{height:o,width:e,fontWeight:600,display:"flex",alignItems:"center",borderBottom:`solid 1px ${s.cellBorderColor}`,backgroundColor:s.grayScale[1]},children:t.map((({width:e,label:t,isSortable:o,id:s},d)=>(0,r.BX)("div",{style:{width:e,paddingLeft:0===d?16:0},...o?{css:a.css`
                    .hoverable-sort-icon {
                      display: ${n&&n.columnId===s?"inline":"none"};
                      margin-left: 8px;
                    }
                    :hover {
                      .hoverable-sort-icon {
                        display: inline;
                      }
                    }
                  `}:{},children:[t||(0,r.tZ)(l.Fragment,{children:"Â "}),o&&(0,r.tZ)(K,{sortDirection:n?.columnId===s?n.direction:void 0,onSortIconClicked:e=>i({columnId:s,direction:e})})]},s)))})},X=({contentType:e,onLeftArrowClicked:t,pathToParentFolder:n,mode:a})=>{const s=(0,g.Z)(e),l=(0,f.D)({tree:s,path:n}),d=0!==n.length&&l?(0,v.g)(l,n.at(-1)).name:void 0,c="panel"===a;return(0,r.BX)(w.Title,{level:c?5:4,css:{paddingLeft:12,width:"100%",display:"flex",alignItems:"center",minWidth:0},children:[(0,r.tZ)(o.Button,{style:{paddingLeft:2},type:"text",onClick:t,children:(0,r.tZ)(i.ArrowLeftOutlined,{})}),(0,r.tZ)(w.Text,{ellipsis:{tooltip:d},style:{width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:10,paddingLeft:c?0:7,fontSize:c?12:14},children:d})]})},H=(e,t,n)=>((0,v.g)(e.record,e.id).name||n).toLowerCase()>((0,v.g)(t.record,t.id).name||n).toLowerCase()?1:-1,G=(e,t)=>{const n=e.children||{};Object.keys(n).forEach((e=>{!e.endsWith("_metadata")&&n[e].entry.canRead&&((0,v.g)(n[e],e).isFolder?G(n[e],t):t.push({record:n[e],id:e,...(0,I.X)(n[e],e).entry}))}))};var _=n(68061),j=n(5586),q=n(50697),U=n(42248),z=n(37678),Q=n(30690);var Y=n(67102),J=n(93941),ee=n(68047),te=n(70058);function ne(e){const{contentType:t,selectedFilesAndFolders:n,pathToParentFolder:a,onFolderRenamingStarted:o,onAfterSubmit:c}=e,u=(0,g.Z)("dashboard"),m={contentType:t,selectedFilesAndFolders:n,contentTree:u??void 0,pathToParentFolder:a,onAfterSubmit:c},h=(0,_.N)(m),b=(0,ee.B)({...m,onEditStarted:o}),x=(0,te.X)(m),C=(0,Y.E)(m),T=(0,J.S)(m),S=function(e){const{formatMessage:t}=(0,d.useIntl)(),n=(0,y.Ct)(),a=(0,z.s)(),o=(0,l.useRef)(null),s=(0,Q.z)(n.serviceVersion.id),{contentTree:c,pathToParentFolder:u,contentType:m}=e,h=function(e,t){const n=(0,y.Ct)();return r=>new Promise(((i,a)=>{const o=new FileReader;o.readAsText(r,"UTF-8"),o.onerror=o.onabort=a,o.onload=async()=>{try{const r=o.result?.toString();if(!r)throw new Error("The file is empty. This is not supported.");const a=JSON.parse(r);await n.importFilesAndFolders({pathToParentFolder:t,type:e,...a}),await n.loadTree(e),i()}catch(e){a(e)}}}))}(m,u),[g]=(0,p.g)("canManageContent");if("dashboard"!==e.contentType||!g||s<7)return null;const b=(0,f.D)({tree:c,path:u});if(!b)throw new Error(`Could not find a folder at path "${u}" in the "dashboard" tree.`);const x=u.at(-1),C=x?(0,v.g)(b,x):{name:t({id:"aui.contentTree.folders"}),isFolder:!0};if(!C.isFolder)throw new Error(`${u} is not a folder.`);if("doesRepresentServer"in b)throw new Error(`${u} folder is a server folder.`);const T=!b.entry.canWrite;return{key:"import-folder",icon:(0,r.tZ)(i.ImportOutlined,{}),disabled:T,onClick:()=>o.current?.click(),label:(0,r.BX)(w.Tooltip,{trigger:T?["hover"]:[],placement:"right",title:t({id:"aui.contentTree.notAllowedToPerformAction"},{action:"import",itemType:"folder"}),children:[(0,r.tZ)("input",{ref:o,style:{display:"none"},type:"file",accept:"application/json",max:1,onChange:async e=>{const t=e.target.files?.item(0);t&&await a({action:"loading",promise:h(t)})}}),t({id:"aui.contentTree.import"},{name:C.name})]})}}(m),N=function(e){const{formatMessage:t}=(0,d.useIntl)(),n=(0,y.Ct)(),{contentTree:a,selectedFilesAndFolders:o,pathToParentFolder:l,contentType:c,onAfterSubmit:u}=e,[m]=(0,p.g)("canManageContent");if(!m)return null;if(1!==o.length)return null;const h=o[0];if("doesRepresentServer"in h)return null;const g=(0,v.g)(h.record,h.id);if(!g.isFolder)return null;const{id:f,record:b}=h,x=g.name??t({id:"aui.defaultDashboardName"});let C;if(b.entry.canWrite){const e=(0,q.e)({folderRecord:b,id:f,isFolderInSelection:!1});if(e){const{messageId:n,readOnlyDescendant:r}=e;let i={};if(r){const[e,t]=r;i=(0,s.defaults)((0,v.g)(e,t),{isFolder:!1})}C=t({id:`aui.contentTree.${n}`},{...i,action:"delete",contentType:c,folderName:"_this_",itemType:o.length>1?"selection":c})}}else C=t({id:"aui.contentTree.notAllowedToDelete"},{name:"_this_",contentType:"folder"});const T=void 0!==C,S=t({id:"aui.areYouSure"},{action:t({id:"aui.delete"}).toLocaleLowerCase()}),N=[t({id:"aui.contentTree.deleteWarning"},{name:x}),t({id:"aui.cannotBeUndone"})];return{key:"delete-folder",disabled:T,icon:(0,r.tZ)(i.DeleteOutlined,{}),label:(0,r.tZ)(w.Tooltip,{trigger:T?["hover"]:[],placement:"right",title:C,children:(0,r.tZ)(w.Popconfirm,{title:S,content:N,disabled:T,okText:t({id:"aui.delete"}),cancelText:t({id:"aui.cancel"}),onConfirm:async()=>{a&&await n.deleteFolder({contentTree:a,type:c,path:[...l,f]}),u&&u({pathToNavigateTo:l})},children:(0,r.tZ)("div",{children:t({id:"aui.contentTree.delete"},{name:x})})})}),onClick:({domEvent:e})=>{e.target instanceof Element&&!e.target.closest("button")&&e.preventDefault()}}}(m),F=(0,U.s)(m),P=function(e){const{formatMessage:t}=(0,d.useIntl)(),n=(0,y.Ct)(),{selectedFilesAndFolders:a,pathToParentFolder:o,contentType:s,onAfterSubmit:l}=e,[c]=(0,p.g)("canManageContent");if(!c)return null;if(1!==a.length)return null;const u=a[0];if("doesRepresentServer"in u)return null;const{id:m,record:h}=u,g=(0,v.g)(h,m);if(g.isFolder)return null;const f=g.name??t({id:"aui.defaultDashboardName"}),b=!h.entry.canWrite,x=t({id:"aui.areYouSure"},{action:t({id:"aui.delete"}).toLocaleLowerCase()}),C=[t({id:"aui.contentTree.deleteWarning"},{name:f}),t({id:"aui.cannotBeUndone"})];return{key:"delete-file",disabled:b,icon:(0,r.tZ)(i.DeleteOutlined,{}),label:(0,r.tZ)(w.Tooltip,{trigger:b?["hover"]:[],placement:"right",title:t({id:"aui.contentTree.notAllowedToDelete"},{name:"_this_",contentType:s}),children:(0,r.tZ)(w.Popconfirm,{title:x,content:C,disabled:b,okText:t({id:"aui.delete"}),cancelText:t({id:"aui.cancel"}),onConfirm:async()=>{await n.deleteFile({type:s,path:[...o,m]}),l&&l()},children:(0,r.tZ)("div",{children:t({id:"aui.contentTree.delete"},{name:f})})})}),onClick:({domEvent:e})=>{e.target instanceof Element&&!e.target.closest("button")&&e.preventDefault()}}}(m),M=(0,j.d)(m);if(u)return[h,b,x,T,C,S,F,N,P,M]}var re=n(36798);const ie=[],ae=(0,l.memo)((e=>{const{formatMessage:t}=(0,d.useIntl)(),n=(0,T.Fg)(),N=(0,l.useRef)(null),P=(0,l.useRef)(null),[M,k]=(0,l.useState)(!1),[E,R]=(0,l.useState)(-1),{contentType:Z,disabledFileOrFolderTooltipMessage:A,hasContextMenu:O,hasGhostActions:B,onFileOrFolderSelected:L,onFileOpened:K,emptyHint:_,disabledPaths:j,getDragItem:q}=e,U=(0,l.useRef)(),{username:z}=(0,h.a)(),[Q]=(0,p.g)("canShare"),[Y]=(0,p.g)("canManageContent"),J=(0,c.Z)(),[ee,te]=(0,l.useState)(!1),[ae,oe]=(0,l.useState)(""),[se,le]=(0,l.useState)(void 0),{clearSelection:de,selectedRanges:ce,onItemSelected:ue,setSelectedRanges:me}=(0,w.useMultiSelection)([]),he=(0,g.Z)(Z),[pe,ge]=(0,l.useState)(""),ye=e.searchValue??pe,fe=e.onSearchValueChanged??ge,[ve,be]=(0,l.useState)(e.initialPathToFolder??[]);if("explorer"!==e.mode&&e.isHome)throw new Error("The prop `isHome` can only be used in `explorer` mode.");const{rowHeight:xe,hasCheckboxes:Ce,isTextSmall:Te,hasSearch:Se,hasCreateNewFolderButton:we,areLastEditorAndLastEditedColumnsVisible:Ne,rowStyle:Fe,searchBarStyle:Pe}=((e,t)=>{const n={rowHeight:32,hasCheckboxes:!1,isTextSmall:!1,hasSearch:!1,hasCreateNewFolderButton:!1,areLastEditorAndLastEditedColumnsVisible:!1,searchBarStyle:{},rowStyle:{}};switch(e){case"panel":n.hasCheckboxes=!0,n.isTextSmall=!0,n.hasSearch=!0,n.hasCreateNewFolderButton=!0,n.searchBarStyle={display:"flex",justifyContent:"center",width:"100%",margin:"10px 0px",padding:"0px 10px",height:25};break;case"explorer":if(n.areLastEditorAndLastEditedColumnsVisible=!0,t){n.rowHeight=40;break}n.hasSearch=!0,n.searchBarStyle={marginTop:10};break;case"popover":n.areLastEditorAndLastEditedColumnsVisible=!1,n.hasSearch=!0,n.searchBarStyle={marginTop:10};break;case"folders":n.rowHeight=28,n.hasCreateNewFolderButton=!0,n.rowStyle={borderBottom:"none"}}return n})(e.mode,e.isHome),Me=e.onPathToFolderChanged?e.pathToParentFolder??ie:ve,Ie=e.onPathToFolderChanged??function(e){L?.(e,{isFolder:!0}),be(e)},De=(0,f.D)({tree:he,path:Me}),ke=De&&!De.entry.canWrite,Ee=t({id:"aui.defaultDashboardName"}),{files:Re,folders:Ze}=(0,l.useMemo)((()=>{if(!De)return{files:[],folders:[]};const{files:t,folders:n}=(({folder:e,defaultName:t})=>{const n=e.children||{},r=Object.keys(n).filter((e=>!e.endsWith("_metadata")&&n[e].entry.canRead)),i=(0,s.groupBy)(r.map((e=>({record:n[e],id:e,metaData:(0,v.g)(n[e],e),...(0,I.X)(n[e],e).entry}))),(({metaData:e})=>e.isFolder?"folders":"files"));return{files:i.files?i.files.sort(((e,n)=>H(e,n,t))):[],folders:i.folders?i.folders.sort(((e,n)=>H(e,n,t))):[]}})({folder:De,defaultName:Ee});return{files:e.areFoldersVisibleOnly?[]:t,folders:e.areFoldersVisibleOnly?n.filter((({record:e})=>e.entry.canWrite)):n}}),[De,Ee,e.areFoldersVisibleOnly]),{onSortChanged:Ae,sortedBy:Oe,sortedFileList:Be}=function({files:e,folders:t}){const[n,r]=(0,l.useState)({columnId:"name",direction:"asc"}),i=(0,l.useMemo)((()=>{let r=[...t,...e];return"name"!==n.columnId?(r=(0,s.sortBy)([...t,...e],(e=>{const{entry:{lastEditor:t,timestamp:r}}=(0,I.X)(e.record,e.id);return"lastEditor"===n.columnId?t:r})),"desc"===n.direction&&r.reverse()):"desc"===n.direction&&(r=[...[...t].reverse(),...[...e].reverse()]),r}),[t,e,n]);return{sortedBy:n,onSortChanged:r,sortedFileList:i}}({files:Re,folders:Ze}),Le=(0,l.useMemo)((()=>he?((e,{defaultName:t})=>{const n=[];return G(e,n),n.sort(((e,n)=>H(e,n,t)))})(he,{defaultName:Ee}):[]),[he,Ee]),Ve=(0,y.Ct)(),$e=()=>{le(void 0)},Ke=async(e,t)=>{le(void 0),await Ve.updateFolder({type:Z,pathToParentFolder:e,metaData:t}),await Ve.loadTree(Z)},We=(0,l.useMemo)((()=>ye?(0,C.y)(Le.map((e=>({...e,metaData:(0,v.g)(e.record,e.id)}))),ye,{keys:["metaData.name"]}):Be),[Le,ye,Be]),Xe=We[E],He=t=>{R(t);const n=We[t];n&&e.onActiveFileOrFolderChanged?.(n.id)},Ge=({index:e,isExtending:t,isResetting:n})=>{if(n&&!t){const{id:t,record:n}=We[e],r=(0,v.g)(n,t);L?.([...Me,t],{isFolder:Boolean(r.isFolder)})}ue({index:e,isExtending:t,isResetting:n}),He(e)},_e=(0,l.useMemo)((()=>(0,s.flatMap)(ce,(e=>We.slice(e.from,e.to+1)))),[We,ce]);(0,l.useLayoutEffect)((()=>{E>=0&&N.current?.scrollToItem(E)}),[xe,E]),(0,l.useLayoutEffect)((()=>{const e=U.current?(0,s.findIndex)(We,(e=>e.id===U.current)):void 0;e&&-1!==e&&(R(e),N.current?.scrollToItem(e),U.current=void 0)}),[U,We]);const{isIndeterminate:je,isSelectAllChecked:qe}=(0,l.useMemo)((()=>We.length>0&&_e.length===We.length?{isIndeterminate:!1,isSelectAllChecked:!0}:_e.length>0?{isIndeterminate:!0,isSelectAllChecked:!1}:{isIndeterminate:!1,isSelectAllChecked:!1}),[We.length,_e.length]),Ue=xe,ze=e=>{de(),He(-1),Ie(e)},Qe=e=>{Ce||ze(e)},Ye=e=>{Ce&&ze(e)},Je=(e,t)=>{Ce||K?.(e,t)},et=(e,t)=>{Ce&&K?.(e,t)},tt=0===Me.length,nt=(0,r.tZ)(w.Tooltip,{trigger:["hover"],placement:"right",title:ke?t({id:"aui.contentTree.notAllowedToPerformAction"},{action:"edit",itemType:"folder"}):t({id:"aui.contentTree.createNewFolder"}),children:(0,r.tZ)(o.Button,{style:{marginRight:9,display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,height:18,width:24},disabled:ke,onClick:()=>{te(!0)},children:(0,r.tZ)(i.FolderAddOutlined,{})})}),rt=function({canManageContent:e,hasCreateNewFolderButton:t,hasCheckboxes:n,isRoot:r}){return e&&t?r?n?"next-to-select-all":"floating-above-list":"next-to-folder-title":"invisible"}({canManageContent:Y,hasCheckboxes:Ce,hasCreateNewFolderButton:we,isRoot:tt}),it=(0,r.BX)("div",{style:{flexGrow:1,height:"100%"},children:[ee&&(0,r.BX)("div",{style:{display:"flex",alignItems:"center",padding:4,marginLeft:12},children:[(0,r.tZ)(i.FolderOutlined,{style:{marginRight:8}}),(0,r.tZ)(o.Input,{autoFocus:!0,style:{width:"100%",marginBottom:5},value:ae,onChange:e=>oe(e.target.value),onPressEnter:async e=>{if(""===ae||!De)return;e.stopPropagation();const{owners:t,readers:n}=De.entry,{owners:r,readers:i}=(0,b.s)({currentUserName:z,canShare:Q,parentFolderOwners:t,parentFolderReaders:n,isParentFolderRoot:0===Me.length});U.current=await Ve.createFolder({name:ae,owners:r,pathToParentFolder:Me,readers:i,type:Z}),await Ve.loadTree(Z),J()&&(te(!1),oe(""),P.current?.focus())},onKeyUp:e=>{"Escape"===e.key&&(te(!1),oe(""))}})]}),Ce&&(0,r.BX)("div",{css:a.css`
            -webkit-user-select: none;
            -moz-user-select: none;
            background-color: ${n.backgroundColor};
            display: flex;
            align-items: center;
            height: ${Ue}px;
            width: 100%;
            border-bottom: solid 1px ${n.grayScale[4]};
            flex-direction: row;
            justify-content: space-between;
          `,children:[(0,r.BX)("div",{css:a.css`
              display: flex;
              align-items: center;
            `,children:[(0,r.tZ)(o.Checkbox,{style:{marginRight:10,marginLeft:16},indeterminate:je,checked:qe,disabled:0===We.length,onChange:()=>{qe?de():ue({index:We.length,isExtending:!0,isResetting:!0})}}),_e.length>0?(0,r.tZ)($,{contentType:Z,selectedFilesAndFolders:_e,pathToParentFolder:Me,onAfterSubmit:async()=>{await Ve.loadTree(Z),de()}}):(0,r.tZ)(w.Text,{small:!0,style:{color:n.textColor},children:t({id:"aui.selectAll"})})]}),"next-to-select-all"===rt&&nt]}),0===We.length?(0,r.BX)("div",{style:{alignItems:"center",backgroundColor:n.backgroundColor,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center"},children:[(0,r.tZ)(x.IconEmptyFolder,{style:{fontSize:164}}),(0,r.tZ)(w.Title,{level:2,children:`${t({id:"aui.emptyFolder"})}${_||""}`})]}):(0,r.tZ)(u.ZP,{children:({width:i,height:o})=>{let s=o;Ne&&(s-=Ue),Ce&&(s-=Ue);const l=[];return Ne&&l.push({width:100,isSortable:!0,label:t({id:"aui.lastEditor"}),id:"lastEditor"},{width:100,isSortable:!0,label:t({id:"aui.lastEdited"}),id:"lastEdited"}),l.unshift({width:l.length>0?Math.max(i-l.reduce(((e,t)=>e+t.width),0)-17,100):i,label:t({id:"aui.name"}),id:"name",isSortable:!0}),(0,r.BX)("div",{style:{width:i,...e.style},children:[Ne&&(0,r.tZ)(W,{width:i,columns:l,sortedBy:Oe,onSortedByChanged:e=>{de(),Ae(e)},height:Ue}),(0,r.tZ)(m.S_,{ref:N,style:{overflowX:"hidden"},itemCount:We.length,itemSize:()=>xe,height:s,width:i,itemData:{activeRowIndex:E,contentType:Z,getDragItem:q,rows:We,rowStyle:Fe,pathToParentFolder:Me,hasCheckbox:Ce,hasGhostActions:B,idOfFileOrFolderBeingRenamed:se,areLastEditorAndLastEditedColumnsVisible:Ne,onFileOrFolderRenamingEnded:Ke,onFileOrFolderRenamingCanceled:$e,onFileOrFolderRenamingStarted:le,onItemSelected:Ge,selectedRanges:ce,onFolderClicked:Ye,onFolderDoubleClicked:Qe,onFileDoubleClicked:Je,onFileClicked:et,onFolderRenamingStarted:le,disabledPaths:j,disabledFileOrFolderTooltipMessage:A,small:Te},css:a.css`
                    -webkit-user-select: none;
                    -moz-user-select: none;
                    background-color: ${n.backgroundColor};
                  `,children:V})]})}})]}),at=function({clearSelection:e,setSelectedRanges:t,setActiveRowIndex:n,pathToParentFolder:r}){const i=(0,re.s0)(),a=(0,y.Ct)();return async({doesReloadTree:o,selectionUpdate:s={type:"deselect"},pathToNavigateTo:l}={})=>{if(!1!==o&&await a.loadTree("dashboard"),s)if("deselect"===s.type)e?.(),n?.(-1);else if(t){const e=((e,t,{areFilesIncluded:n,areReadOnlyEntriesIncluded:r}={areFilesIncluded:!0,areReadOnlyEntriesIncluded:!0})=>{if(!e)return[];const i=(0,f.D)({tree:e,path:t});if(!i)return[];const a=Object.entries(i.children||{}).filter((([e,t])=>!(!t.entry.canRead||e.endsWith("metadata"))&&(n||(0,F.q)(t,e))&&(r||t.entry.canWrite))).map((([e,t])=>{const n=(0,v.g)(t,e);return{id:e,name:n.name,isFolder:Boolean(n.isFolder),...D(n)&&{widgetKey:n.widgetKey}}}));return a.sort(((e,t)=>e.isFolder!==t.isFolder?e.isFolder?-1:1:(e.name??"").toLowerCase()<(t.name??"").toLowerCase()?-1:1)),a})(a.getTree("dashboard"),r),i=e.findIndex((({name:e,isFolder:t})=>!t&&e===s.fileName));t([{from:i,to:i}]),n?.(i)}l&&i&&i(l.join("/"))}}({clearSelection:de,setSelectedRanges:me,setActiveRowIndex:R,pathToParentFolder:Me}),ot=ne({contentType:Z,selectedFilesAndFolders:_e,pathToParentFolder:Me,onFolderRenamingStarted:le,onAfterSubmit:at});return(0,r.tZ)("div",{ref:P,style:{height:"100%",outline:"none"},tabIndex:0,onKeyUp:e=>{"Enter"!==e.key||!Xe||ee||se?"Backspace"===e.key&&Me.length>0&&!ee&&ze(Me.slice(0,-1)):((0,v.g)(Xe.record,Xe.id).isFolder?ze([...Me,Xe.id]):void 0!==Xe&&K?.(Xe.id,(0,v.g)(Xe.record,Xe.id)),fe(""))},onKeyDown:e=>{"ArrowDown"===e.key?E<We.length-1&&(Ge({index:E+1,isExtending:!1,isResetting:!0}),e.preventDefault()):"ArrowUp"===e.key&&E>0&&(Ge({index:E-1,isExtending:!1,isResetting:!0}),e.preventDefault())},children:(0,r.BX)("div",{style:{display:"flex",flexDirection:"column",height:"100%",background:n.backgroundColor},children:[Se&&(0,r.tZ)("div",{style:Pe,children:(0,r.tZ)(S.h,{searchValue:ye,onSearchValueChanged:e=>{He(0),fe(e)},searchPlaceholder:t({id:"aui.searchFiles"},{contentType:Z})})}),"floating-above-list"===rt&&(0,r.tZ)("div",{style:{flexGrow:1,height:Ue,display:"flex",justifyContent:"flex-end",alignItems:"center"},children:nt}),e.hasFolderTitle&&(0,r.tZ)("div",{style:{display:"flex",width:"100%",height:Ce?"unset":tt?0:Ue,alignItems:"center"},children:!tt&&(0,r.BX)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center",backgroundColor:n.backgroundColor,borderTop:Ce?`solid 1px ${n.grayScale[4]}`:"none",height:Ue},children:[(0,r.tZ)(X,{contentType:Z,onLeftArrowClicked:()=>{const e=Me.slice(0,-1);te(!1),Ie(e)},pathToParentFolder:Me,mode:e.mode}),"next-to-folder-title"===rt&&nt]})}),O?(0,r.tZ)(w.Dropdown,{trigger:["contextMenu"],open:M,onOpenChange:k,menu:{items:ot,style:{maxWidth:600},onClick:({domEvent:e})=>{e.isDefaultPrevented()||k(!1)}},children:it}):it]})})}))},37318:(e,t,n)=>{n.d(t,{J:()=>u});var r=n(17967),i=n(9617),a=n(66029),o=n(93481),s=n(33575),l=n(19078),d=n(46354);const{Item:c}=i.Form,u=e=>{const{canShare:t,contentTree:n,contentType:u,initialPathToFolder:m,name:h,onNameChanged:p,onPathToFolderChanged:g,onPermissionsChange:y,permissions:f,step:v}=e,{formatMessage:b}=(0,o.useIntl)(),x=(0,a.useRef)(null);return(0,a.useEffect)((()=>{x?.current?.focus({cursor:"all"})}),[]),(0,r.BX)(a.Fragment,{children:["nameAndFolder"===v?(0,r.tZ)("div",{children:(0,r.BX)(i.Form,{layout:"vertical",children:[(0,r.tZ)(c,{initialValue:h,name:"enterName",label:(0,r.tZ)(l.Text,{small:!0,children:b({id:"aui.contentName"},{contentType:u})}),children:(0,r.tZ)(i.Input,{style:{marginTop:4},ref:x,autoFocus:!0,value:h,onChange:e=>{p(e.target.value)},placeholder:b({id:"aui.enterFileName"},{contentType:u})})}),(0,r.tZ)(c,{name:"selectFolder",label:(0,r.tZ)(l.Text,{small:!0,children:b({id:"aui.selectFolder"})}),children:n?(0,r.tZ)("div",{style:{height:230},children:(0,r.tZ)(d.m,{areFoldersVisibleOnly:!0,hasFolderTitle:!0,initialPathToFolder:m,onFileOrFolderSelected:g,contentType:u,mode:"folders"})}):null})]})}):null,n&&t&&"share"===v?(0,r.BX)("div",{children:[(0,r.tZ)(l.Text,{style:{marginTop:10,marginBottom:10},children:b({id:"aui.shareContent"},{contentName:h??b({id:"aui.contentType"},{contentType:u})})}),(0,r.tZ)(s.u,{permissions:f,onPermissionsChange:y})]}):null]})}},50697:(e,t,n)=>{n.d(t,{e:()=>a});var r=n(61986);function i(e,t){if(!e.entry.canWrite)return[e,t];if(e.children){const t=Object.keys(e.children).filter((e=>!e.endsWith("_metadata"))).find((t=>void 0!==i(e.children[t],t)));if(t)return[e.children[t],t]}}function a({folderRecord:e,id:t,isFolderInSelection:n}){const a=(0,r.q)(e,t);if(!e.entry.canWrite)return{messageId:"notAllowedToPerformAction",isFolder:a};const o=i(e,t);if(o){const[e]=o;return e.entry.canRead?{messageId:n?"notAllowedToPerformActionOnSelectionBecauseOfElement":"notAllowedToPerformActionOnFolderBecauseOfElement",isFolder:a,readOnlyDescendant:o}:{messageId:n?"notAllowedToPerformActionOnSelectionBecauseOfHiddenElement":"notAllowedToPerformActionOnFolderBecauseOfHiddenElement",isFolder:a}}}},68061:(e,t,n)=>{n.d(t,{N:()=>m});var r=n(17967),i=n(50083),a=n(66029),o=n(93481),s=n(47764),l=n(61986),d=n(10756),c=n(19078),u=n(91424);function m(e){const{formatMessage:t}=(0,o.useIntl)(),{selectedFilesAndFolders:n,pathToParentFolder:m}=e,[h,p]=(0,a.useState)(!1),g=(0,c.useIsModalMounted)(h),[y]=(0,s.g)("canManageContent");if(!y)return null;if(1!==n.length)return null;const f=n[0];if(!("doesRepresentServer"in f)&&!(0,l.q)(f.record,f.id))return null;let v,b=!1,x="",C=[],T="aui.contentTree.createFolderAtRoot";"doesRepresentServer"in f||(b=!f.record.entry.canWrite,x=(0,d.g)(f.record,f.id).name,C=[...m,f.id],v=f.record.entry,T="aui.contentTree.createFolder");const S=t({id:T},{parentFolderName:x});return{key:"create-folder",onClick:()=>{p(!0)},disabled:b,icon:(0,r.tZ)(i.FolderAddOutlined,{}),label:(0,r.tZ)(c.Tooltip,{trigger:b?["hover"]:[],placement:"right",title:t({id:"aui.contentTree.notAllowedToPerformAction"},{action:"edit",itemType:"folder"}),children:(0,r.BX)("div",{children:[g?(0,r.tZ)(u.X,{parentFolder:v,pathToParentFolder:C,isVisible:h,onSubmit:()=>p(!1),title:S,onCancel:()=>p(!1),contentType:e.contentType}):null,S]})})}}},5586:(e,t,n)=>{n.d(t,{d:()=>m});var r=n(17967),i=n(50083),a=n(77026),o=n(93481),s=n(92563),l=n(47764),d=n(10756),c=n(19078),u=n(50697);function m(e){const{formatMessage:t}=(0,o.useIntl)(),n=(0,s.Ct)(),{selectedFilesAndFolders:m,pathToParentFolder:h,contentType:p,onAfterSubmit:g}=e,[y]=(0,l.g)("canManageContent");if(!y)return null;if(m.length<=1)return null;const f=t({id:"aui.contentTree.deleteAll"},{numberOfSelectedItems:m.length});let v,b=0;for(;!v&&b<m.length;){const e=m[b];if("doesRepresentServer"in e)v=t({id:"aui.contentTree.notAllowedToPerformActionOnRootFolder"},{action:"delete"});else{const n=(0,d.g)(e.record,e.id);if(n.isFolder)if(e.record.entry.canWrite){const r=(0,u.e)({folderRecord:e.record,id:e.id,isFolderInSelection:m.length>1});if(r){const{messageId:e,readOnlyDescendant:i}=r;let o={};if(i){const[e,t]=i;o=(0,a.defaults)((0,d.g)(e,t),{isFolder:!1})}v=t({id:`aui.contentTree.${e}`},{...o,action:"delete",folderName:n.name,contentType:p,itemType:m.length>1?"selection":p})}}else v=t({id:"aui.contentTree.notAllowedToDelete"},{name:n.name,contentType:"folder"});else e.record.entry.canWrite||(v=t({id:"aui.contentTree.notAllowedToDelete"},{name:n.name,contentType:p}))}b++}const x=void 0!==v,C=t({id:"aui.areYouSure"},{action:t({id:"aui.delete"}).toLocaleLowerCase()}),T=[t({id:"aui.contentTree.deleteAllWarning"}),t({id:"aui.cannotBeUndone"})];return{key:"delete-files-and-folders",disabled:x,icon:(0,r.tZ)(i.DeleteOutlined,{}),label:(0,r.tZ)(c.Tooltip,{trigger:x?["hover"]:[],placement:"right",title:v,children:(0,r.tZ)(c.Popconfirm,{title:C,content:T,disabled:x,okText:t({id:"aui.delete"}),cancelText:t({id:"aui.cancel"}),onConfirm:async()=>{await n.deleteFilesAndFolders({type:p,pathToParentFolder:h,idsToDelete:m.map((e=>e.id))}),g&&g()},children:(0,r.tZ)("div",{children:f})})}),onClick:({domEvent:e})=>{e.target instanceof Element&&!e.target.closest("button")&&e.preventDefault()}}}},42248:(e,t,n)=>{n.d(t,{s:()=>h});var r=n(17967),i=n(50083),a=n(12887),o=n.n(a),s=n(93481),l=n(37678),d=n(92563),c=n(47764),u=n(10756),m=n(30690);function h(e){const{formatMessage:t}=(0,s.useIntl)(),n=(0,d.Ct)(),a=(0,l.s)(),h=(0,m.z)(n.serviceVersion.id),{contentTree:p,selectedFilesAndFolders:g,pathToParentFolder:y,contentType:f}=e,[v]=(0,c.g)("canManageContent");if(!v||1!==g.length||h<7)return null;const b=g[0];if("doesRepresentServer"in b)return null;const x=(0,u.g)(b.record,b.id);if(!x.isFolder)return null;const{id:C}=b,T=x.name??t({id:"aui.defaultDashboardName"});return{key:"export-folder",icon:(0,r.tZ)(i.ExportOutlined,{}),onClick:async()=>{if(!p)return;const e=(async()=>{const e=await n.exportFilesAndFolders({pathToParentFolder:y,ids:[C],type:f});o()(new Blob([JSON.stringify(e,void 0,2)],{type:"application/json"}),`Export of ${T}.json`,{autoBom:!0})})();await a({action:"loading",promise:e})},label:(0,r.tZ)("div",{children:t({id:"aui.contentTree.export"},{name:T})})}}},67102:(e,t,n)=>{n.d(t,{E:()=>c});var r=n(17967),i=n(50083),a=n(93481),o=n(92563),s=n(47764),l=n(10756),d=n(19078);function c(e){const{formatMessage:t}=(0,a.useIntl)(),n=(0,o.Ct)(),{selectedFilesAndFolders:c,pathToParentFolder:u,onAfterSubmit:m}=e,[h]=(0,s.g)("canManageContent");if(!h)return null;if(1!==c.length)return null;const p=c[0];if("doesRepresentServer"in p)return null;const{id:g,record:y}=p,f=(0,l.g)(y,g);if(f.isFolder)return null;const v=t({id:"aui.copyOf"},{name:f.name??t({id:"aui.defaultDashboardName"})}),b=!y.entry.canWrite;return{key:"make-a-copy-of-file",disabled:b,icon:(0,r.tZ)(i.CopyOutlined,{}),label:(0,r.tZ)(d.Tooltip,{trigger:b?["hover"]:[],placement:"right",title:t({id:"aui.contentTree.notAllowedToPerformAction"},{itemType:"dashboard",action:"makeACopy"}),children:(0,r.tZ)("div",{children:t({id:"aui.contentTree.makeACopy"},{name:v})})}),onClick:async()=>{await(async()=>{const[t,r]=await Promise.all([n.fetchFile({id:g,withMetaData:!1,type:e.contentType}),n.fetchThumbnail({type:"dashboard",id:g,pathToParentFolder:u},{})]);await n.createFile({content:t,metaData:{name:v},owners:y.entry.owners,pathToParentFolder:u,readers:y.entry.readers,type:e.contentType,thumbnailDataUrl:r}),m&&m({selectionUpdate:{type:"select",fileName:v}})})()}}}},93941:(e,t,n)=>{n.d(t,{S:()=>b});var r=n(17967),i=n(50083),a=n(58736),o=n(77026),s=n(66029),l=n(93481),d=n(47764),c=n(61986),u=n(10756),m=n(19078),h=n(9617),p=n(92563),g=n(37097),y=n(46354);const f=({ids:e,isVisible:t,onCancel:n,onSubmit:i,pathToOriginFolder:a,contentTree:d,contentType:u})=>{const{formatMessage:f}=(0,l.useIntl)(),v=(0,p.Ct)(),[b,x]=(0,s.useState)(a),[C,T]=(0,s.useState)(!1),[S,w]=(0,s.useState)(!0),N=(0,g.D)({tree:d,path:b}),F=1!==e.length?void 0:(0,g.D)({tree:d,path:[...a,e[0]]}),P=F&&!(0,c.q)(F,e[0]),M=!N?.entry.canWrite,I=f({id:"aui.contentTree.invalidToMoveFolderWithinItself"});return(0,r.tZ)(m.Modal,{destroyOnClose:!0,okText:(0,r.tZ)(m.Tooltip,{trigger:M?["hover"]:[],placement:"right",title:f({id:"aui.contentTree.notAllowedToPerformAction"},{action:"edit",itemType:"folder"}),children:f({id:"aui.contentTree.move"})}),okButtonProps:{loading:C,disabled:(0,o.isEqual)(b,a)||M},onOk:async()=>{if(T(!0),await v.moveFiles({type:u,pathToOriginFolder:a,pathToDestinationFolder:b,ids:e}),N&&P&&S){const{owners:t,readers:n}=N.entry,{owners:r,readers:i}=F.entry,a=(0,o.union)(r,t),s=(0,o.union)(i,n);(a.length>r.length||s.length>i.length)&&await v.updateFilePermissions({id:e[0],pathToParentFolder:b,type:u,owners:a,readers:s})}i({pathToDestinationFolder:b})},onCancel:()=>{x(a),n()},title:f({id:"aui.contentTree.moveTo"}),open:t,extra:P?(0,r.tZ)(h.Checkbox,{checked:S,onChange:()=>w(!S),children:f({id:"aui.contentTree.inheritParentFolderPermissions"})}):null,children:(0,r.tZ)("div",{style:{height:230},children:(0,r.tZ)(y.m,{areFoldersVisibleOnly:!0,initialPathToFolder:a,hasFolderTitle:!0,onFileOrFolderSelected:x,contentType:u,disabledPaths:e.map((e=>[...a,e])),disabledFileOrFolderTooltipMessage:I,mode:"folders"})})})};var v=n(50697);function b({onAfterSubmit:e,selectedFilesAndFolders:t,pathToParentFolder:n,contentTree:h,contentType:p}){const{formatMessage:g}=(0,l.useIntl)(),[y,b]=(0,s.useState)(!1),x=t.filter((e=>!("doesRepresentServer"in e))),C=function(e,t,n){const{formatMessage:r}=(0,l.useIntl)();if(e)return r({id:"aui.contentTree.notAllowedToPerformActionOnRootFolder"},{action:"move"});{const e=t.map((({record:e,id:n})=>{if((0,c.q)(e,n)||!e.entry.canWrite)return(0,v.e)({folderRecord:e,id:n,isFolderInSelection:t.length>1})})).find((e=>void 0!==e));if(e){const{messageId:i,isFolder:a,readOnlyDescendant:s}=e;let l={};if(s){const[e,t]=s;l=(0,o.defaults)((0,u.g)(e,t),{isFolder:!1})}return r({id:`aui.contentTree.${i}`},{...l,action:"move",itemType:t.length>1?"selection":a?"folder":n,contentType:n,folderName:"_this_"})}}}(x.length!==t.length,x,p),[T]=(0,d.g)("canManageContent");if(!T)return null;if(0===x.length)return null;const S=g({id:"aui.contentTree.move"}),w=void 0!==C;return{key:"move-file-and-folders",onClick:()=>{b(!0)},disabled:w,icon:(0,r.tZ)(i.ArrowRightOutlined,{}),label:(0,r.tZ)(m.Tooltip,{trigger:w?["hover"]:[],placement:"right",title:C,children:(0,r.BX)("div",{css:a.css`
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
          `,children:[(0,r.tZ)(f,{ids:x.map((({id:e})=>e)),isVisible:y,onSubmit:t=>{b(!1),e&&e({pathToNavigateTo:n})},onCancel:()=>{b(!1)},contentTree:h,pathToOriginFolder:n,contentType:p}),S]})})}}},68047:(e,t,n)=>{n.d(t,{B:()=>d});var r=n(17967),i=n(50083),a=n(93481),o=n(47764),s=n(10756),l=n(19078);function d(e){const{formatMessage:t}=(0,a.useIntl)(),{selectedFilesAndFolders:n,contentType:d,onEditStarted:c}=e,[u]=(0,o.g)("canManageContent");if(!u)return null;if(1!==n.length)return null;const m=n[0];if("doesRepresentServer"in m)return null;const{record:h,id:p}=m,g=(0,s.g)(h,p);if(!g.isFolder&&"dashboard"===d)return null;const y=g.name?g.name:"dashboard"===d?t({id:"aui.defaultDashboardName"}):"",f=!h.entry.canWrite;return{key:"rename-file-or-folder",disabled:f,onClick:()=>{c?.(p)},icon:(0,r.tZ)(i.EditOutlined,{}),label:(0,r.tZ)(l.Tooltip,{trigger:f?["hover"]:[],placement:"right",title:t({id:"aui.contentTree.notAllowedToPerformAction"},{itemType:g.isFolder?"folder":d,action:"rename"}),children:(0,r.tZ)("div",{children:t({id:"aui.contentTree.rename"},{name:y})})})}}},70058:(e,t,n)=>{n.d(t,{X:()=>u});var r=n(17967),i=n(50083),a=n(66029),o=n(93481),s=n(47764),l=n(10756),d=n(16108),c=n(19078);function u({selectedFilesAndFolders:e,pathToParentFolder:t,contentType:n}){const{formatMessage:u}=(0,o.useIntl)(),[m]=(0,s.g)("canShare"),[h,p]=(0,a.useState)(!1),g=(0,c.useIsModalMounted)(h);if(1!==e.length)return null;const y=e[0];if("doesRepresentServer"in y)return null;const{id:f,record:v}=y;if(!m)return null;const b=(0,l.g)(v,f),x=b.isFolder,C=v&&!v.entry.canWrite;return{key:"share-file-or-folder",disabled:C,onClick:()=>{p(!0)},icon:(0,r.tZ)(i.ShareAltOutlined,{}),label:(0,r.tZ)(c.Tooltip,{trigger:C?["hover"]:[],placement:"right",title:u({id:"aui.contentTree.notAllowedToPerformAction"},{itemType:x?"folder":n,action:"share"}),children:(0,r.BX)("div",{children:[v&&g?(0,r.tZ)(d.V,{name:b.name,contentType:n,entry:v.entry,id:f,isVisible:h,onSubmit:()=>{p(!1)},onCancel:()=>{p(!1)},isFolder:x,pathToParentFolder:t}):null,u({id:"aui.share"})]})})}}},42654:(e,t,n)=>{n.d(t,{f:()=>y});var r=n(17967),i=n(50083),a=n(58736),o=n(9617),s=n(27860),l=n.n(s),d=n(66029),c=n(93481),u=n(54935),m=n(19078);const h={margin:4,width:100,borderWidth:1,boxShadow:"none",overflow:"hidden",textAlign:"center",textOverflow:"ellipsis",whiteSpace:"nowrap"},p=({timePeriod:e,onTimePeriodChanged:t})=>{const{formatMessage:n}=(0,c.useIntl)(),i=(0,u.Fg)();return(0,r.BX)("div",{style:{width:"123px",display:"flex",flexDirection:"column",alignItems:"center",borderRight:`1px solid ${i.grayScale[3]}`,marginRight:"10px",height:"310px"},children:[(0,r.tZ)("span",{style:{padding:5},children:n({id:"aui.filters.quickSelection"})}),(0,r.tZ)(o.Radio.Group,{value:e,onChange:e=>{t(e.target.value)},style:{display:"flex",flexDirection:"column",alignItems:"center"},children:["month","quarter","year"].map((e=>(0,r.tZ)(o.Radio.Button,{style:h,value:e,children:n({id:`aui.filters.timePeriodToDate.${e}`})},e)))})]})},g=(0,d.lazy)((()=>n.e(1858).then(n.bind(n,1858)))),y=({className:e,isDateRange:t,isRollingDate:n,onIsDateRangeChanged:s,onIsRollingDateChanged:h,onRangeChanged:y,onTimePeriodChanged:f,range:v,timePeriod:b})=>{const{formatMessage:x}=(0,c.useIntl)(),C=(0,u.Fg)();return(0,r.tZ)(d.Suspense,{fallback:(0,r.tZ)("div",{css:a.css`
            display: flex;
            height: 310px;
            justify-content: center;
            align-items: center;
          `,children:(0,r.tZ)(o.Spin,{})}),children:(0,r.BX)("div",{className:e,css:{display:"flex",flexDirection:"column",height:"100%",overflow:"auto"},children:[(0,r.BX)("div",{css:a.css`
            display: inline-flex;
            align-items: baseline;
            .ant-picker-input > input:disabled {
              opacity: 0.5;
            }
            height: 100%;
          `,style:f?{borderBottom:`1px solid ${C.grayScale[3]}`}:{},children:[f&&(0,r.tZ)(p,{timePeriod:b,onTimePeriodChanged:e=>{f?.(e)}}),(0,r.tZ)(g,{disabled:[!1,!t],allowEmpty:[!1,!t],value:[v.startDate?l()(v.startDate):null,t&&v.endDate?l()(v.endDate):null],onCalendarChange:e=>{const t=e?.[0]?.toDate()??void 0,n=e?.[1]?.toDate()??void 0;y({startDate:t,endDate:n})}}),(0,r.tZ)(o.Checkbox,{style:{marginLeft:12},checked:t,onChange:({target:{checked:e}})=>{s(e)},children:x({id:"aui.filters.dateRange"})})]}),(0,r.BX)(o.Checkbox,{style:{marginTop:10},checked:n,onChange:({target:{checked:e}})=>{h(e)},children:[x({id:"aui.filters.rollingDateRange.title"}),(0,r.tZ)(m.Tooltip,{trigger:["hover"],placement:"top",title:x({id:"aui.filters.rollingDateRange.hint"}),children:(0,r.tZ)(i.InfoCircleOutlined,{style:{margin:4}})})]})]})})}},58484:(e,t,n)=>{n.d(t,{S:()=>we});var r=n(17967),i=n(50083),a=n(14618),o=n(77026),s=n(66029),l=n(93481),d=n(47764),c=n(34220),u=n(14139),m=n(38785),h=n(69673),p=n(38072),g=n(42160),y=n(97700),f=n(31735),v=n(72826),b=n(85774),x=n(28158),C=n(58422),T=n(58736),S=n(9617),w=n(19078),N=n(99189),F=n(92563),P=n(12880),M=n(18125),I=n(72004),D=n(54935),k=n(37318);const E=e=>{const{formatMessage:t}=(0,l.useIntl)(),n=(0,I.M)(),[i,a]=(0,s.useState)(e.initialName),[o,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)([]),[h,p]=(0,s.useState)([]),g=(0,D.Fg)(),y=(0,N.Z)(e.contentType),[f]=(0,d.g)("canShare"),v=(0,s.useRef)(null),b=(0,F.Ct)(),{username:x}=(0,P.a)();return(0,r.BX)("div",{ref:v,css:T.css`
        display: flex;
        flex-direction: column;
        height: 100%;
        width: ${400}px;
        overflow: hidden;
      `,children:[(0,r.tZ)("div",{css:T.css`
          flex-grow: 1;
        `,children:(0,r.BX)("div",{css:T.css`
            display: flex;
            flex-direction: row;
            height: 100%;
            align-items: center;
          `,children:[(0,r.tZ)("div",{css:T.css`
              width: calc(100% - 9px);
              height: 100%;
            `,children:(0,r.tZ)(k.J,{canShare:f,contentTree:y,contentType:e.contentType,name:i,onNameChanged:a,onPermissionsChange:m,onPathToFolderChanged:p,permissions:u,step:"nameAndFolder"})}),(0,r.tZ)("div",{style:{backgroundColor:g.grayScale[6],opacity:.4,width:4,height:32,cursor:"ew-resize",marginLeft:5}})]})}),(0,r.BX)("div",{css:T.css`
          height: 35px;
          display: flex;
          justify-content: flex-end;
        `,children:[(0,r.tZ)(S.Button,{css:T.css`
            &.ant-btn {
              margin-right: 8px;
            }
          `,onClick:e.onCancel,children:t({id:"aui.cancel"})}),(0,r.tZ)(S.Button,{onClick:async()=>{c(!0);const{owners:t,readers:r}=(0,M.X)(u,x),a=b.createFile({content:e.content,metaData:{name:i},owners:t,pathToParentFolder:h,readers:r,type:e.contentType});await n({action:"saving",promise:a}),await b.loadTree(e.contentType),e.afterSubmit()},disabled:!i,loading:o,type:"primary",children:t({id:"aui.contentTree.save"},{contentType:e.contentType})})]})]})};var R=n(70892);const Z=e=>{const{formatMessage:t}=(0,l.useIntl)(),n="Measures"===e.filter.dimensionName,i=n?null:(0,h._)({hierarchyName:e.filter.hierarchyName,dimensionName:e.filter.dimensionName},e.cube),a=`${n?t({id:"aui.dataVisualization.measures"}):i?.caption}: ${(0,R.L)({cube:e.cube,filter:e.filter})}`;return(0,r.tZ)(E,{...e,initialName:a,content:e.filter,contentType:"filter"})};var A=n(35969),O=n(6532),B=n(31883),L=n(87714),V=n(19389);function $(e){if(!e.isAdvanced)return"dateRange"===e.type?void 0!==e.startDate&&(!e.isDateRange||void 0!==e.endDate):"timePeriodToDate"===e.type?void 0!==e.timePeriod:e.selectedMemberNamePaths.length>0||e.membersTextAreaValue.length>0;switch(e.type){case"topBottomMembers":case"lowerOrGreaterValue":case"valuesRange":case"recentDates":case"existenceOfValue":return!0;case"captionsContaining":case"lowerOrGreaterCaptions":return void 0!==e.token&&""!==e.token.trim();case"captionsRange":return void 0!==e.lowerToken&&""!==e.lowerToken.trim()&&void 0!==e.upperToken&&""!==e.upperToken.trim();default:throw new Error(`Could not validate the filter popup state. Custom filter type: ${e.type}.`)}}const K=({autoFocus:e,errorMessage:t,errorType:n,measures:a,onMeasureSelected:s,selectedMeasureName:d,...c})=>{const{formatMessage:u}=(0,l.useIntl)(),m=d&&!(0,o.isEmpty)(a)&&a?.some((({name:e})=>e===d));return(0,o.isEmpty)(a)?(0,r.tZ)(S.Input,{autoFocus:e,status:n?"error":void 0,placeholder:u({id:"aui.enterMeasureName"}),value:d,onChange:({target:{value:e}})=>{s(e)},suffix:n?(0,r.tZ)(w.Tooltip,{title:t,children:(0,r.tZ)(i.WarningOutlined,{style:{fontSize:16}})}):(0,r.tZ)("span",{})}):(0,r.tZ)(w.Tooltip,{trigger:!d||m?[]:["hover"],title:u({id:"aui.fieldNotFound"},{name:d,type:"measure"}),children:(0,r.tZ)(S.Select,{showSearch:!0,"aria-label":"Select a measure",autoFocus:e,notFoundContent:(0,r.tZ)("span",{}),...c,placeholder:u({id:"aui.select"},{contentType:"measure"}),status:!d||m?void 0:"error",options:a,value:d,onChange:e=>{s(e)},fieldNames:{label:"caption",value:"name"},filterSort:(e,t)=>e.caption?.localeCompare(t.caption)})})};var W=n(56722),X=n(76068),H=n(97456),G=n(86276),_=n(33656),j=n(78270),q=n(91379),U=n(26581);const z={display:"flex",flex:1,marginRight:0,alignItems:"center",minHeight:35,maxHeight:35},Q=e=>{const{formatMessage:t}=(0,l.useIntl)(),n={onClick:e=>e.preventDefault()};return(0,r.BX)("form",{"aria-label":"advanced filter",css:T.css`
        padding: 8px;
      `,children:[(0,r.BX)("fieldset",{css:T.css`
          display: flex;
          align-items: center;
          margin-bottom: 8px !important;
        `,children:[(0,r.tZ)("label",{htmlFor:"numberOfMembers",children:t({id:"aui.filters.keepThe"})}),(0,r.tZ)(S.InputNumber,{id:"numberOfMembers","aria-label":"number of members",disabled:"topBottomMembers"!==e.value.type,style:{width:100,margin:"0 8px"},type:"number",min:1,value:"topBottomMembers"===e.value.type?e.value.limit:void 0,onChange:t=>{"number"==typeof t&&e.onChange((0,A.q7)(t))}}),(0,r.tZ)(S.Select,{"aria-label":"level",css:T.css`
            flex: 1;
          `,disabled:e.hierarchy.slicing?1===e.levels.length:2===e.levels.length,defaultActiveFirstOption:!0,value:e.value.levelIndex,onChange:t=>{e.onChange((0,A.Og)(t))},options:e.hierarchy.slicing?e.levels.map(((e,t)=>({value:t,label:e.caption}))):e.levels.slice(1).map(((e,t)=>({value:t+1,label:e.caption})))})]}),(0,r.BX)("fieldset",{css:T.css`
          display: flex;
          align-items: center;
          margin-bottom: 24px !important;
        `,children:[(0,r.tZ)("label",{htmlFor:"measureName",children:t({id:"aui.filters.whose"})}),(0,r.tZ)(K,{id:"measureName",selectedMeasureName:e.value.measureName,measures:e.measures,onMeasureSelected:t=>{e.onChange((0,A.HD)(t))},style:{marginLeft:8,flex:1},disabled:["captionsContaining","captionsRange","lowerOrGreaterCaptions","recentDates"].includes(e.value.type)})]}),(0,r.BX)(S.Radio.Group,{name:"filter type",style:{display:"flex",flexDirection:"column",marginLeft:24},css:T.css`
          span.ant-radio + * {
            display: flex;
            flex: 1;
            padding-right: 0;
          }
        `,value:e.value.type,onChange:t=>{e.onChange((0,A.hc)(t.target.value))},children:[(0,r.tZ)(S.Radio,{style:z,value:"topBottomMembers",children:"topBottomMembers"!==e.value.type?t({id:"aui.filters.preview.topBottomMembers"}):(0,r.tZ)(q.H,{topBottomMode:e.value.topBottomMode,scope:e.value.scope,levels:e.levels,levelIndex:e.value.levelIndex,onTopBottomModeChange:t=>e.onChange((0,A.No)(t)),onScopeChange:t=>e.onChange((0,A.b4)(t)),selectProps:n})}),(0,r.tZ)(S.Radio,{style:z,value:"lowerOrGreaterValue",children:"lowerOrGreaterValue"!==e.value.type?t({id:"aui.filters.preview.lowerOrGreaterValue"}):(0,r.tZ)(_.$,{lowerOrGreaterMode:e.value.lowerOrGreaterMode,lowerOrGreaterLimit:e.value.lowerOrGreaterLimit,onModeChange:t=>e.onChange((0,A.Gv)(t)),onLimitChange:t=>e.onChange((0,A.B4)(t)),selectProps:n})}),(0,r.tZ)(S.Radio,{style:z,value:"valuesRange",children:"valuesRange"!==e.value.type?t({id:"aui.filters.preview.valuesRange"}):(0,r.tZ)(U.e,{isBetween:e.value.isBetween,lowerLimit:e.value.lowerLimit,upperLimit:e.value.upperLimit,selectProps:n,onIsBetweenChange:t=>e.onChange((0,A.Z1)(t)),onLowerLimitChange:t=>e.onChange((0,A.W7)(t)),onUpperLimitChange:t=>e.onChange((0,A.ok)(t))})}),(0,r.tZ)(S.Radio,{style:z,value:"captionsContaining",children:"captionsContaining"!==e.value.type?t({id:"aui.filters.preview.captionsContaining"}):(0,r.tZ)(W.H,{containingMode:e.value.containingMode,token:e.value.token||"",selectProps:n,onContainingModeChange:t=>e.onChange((0,A.fZ)(t)),onTokenChange:t=>e.onChange((0,A.RK)(t))})}),(0,r.tZ)(S.Radio,{style:z,value:"lowerOrGreaterCaptions",children:"lowerOrGreaterCaptions"!==e.value.type?t({id:"aui.filters.preview.lowerOrGreaterCaptions"}):(0,r.tZ)(G.f,{lowerOrGreaterMode:e.value.lowerOrGreaterMode,token:e.value.token||"",selectProps:n,onLowerOrGreaterModeChange:t=>e.onChange((0,A.Gv)(t)),onTokenChange:t=>e.onChange((0,A.RK)(t))})}),(0,r.tZ)(S.Radio,{style:z,value:"captionsRange",children:"captionsRange"!==e.value.type?t({id:"aui.filters.preview.captionsRange"}):(0,r.tZ)(X.W,{isBetween:e.value.isBetween,lowerToken:e.value.lowerToken||"",upperToken:e.value.upperToken||"",selectProps:n,onIsBetweenChange:t=>e.onChange((0,A.Z1)(t)),onLowerTokenChange:t=>e.onChange((0,A.K5)(t)),onUpperTokenChange:t=>e.onChange((0,A.T4)(t))})}),(0,r.tZ)(S.Radio,{style:z,value:"existenceOfValue",children:"existenceOfValue"!==e.value.type?t({id:"aui.filters.preview.existenceOfValue"}):(0,r.tZ)(H.C,{doesExist:e.value.doesExist,onChange:t=>e.onChange((0,A.yA)(t)),selectProps:n})}),e.isFilterOnDate?(0,r.tZ)(S.Radio,{style:z,value:"recentDates",children:"recentDates"!==e.value.type?t({id:"aui.filters.preview.recentDates"}):(0,r.tZ)(j.J,{numberOfRecentDates:e.value.numberOfRecentDates,onNumberOfRecentDatesChange:t=>e.onChange((0,A.j9)(t))})}):null]})]})};var Y=n(80564),J=n(36249),ee=n(15326),te=n(65611),ne=n(21538),re=n(56403),ie=n(65195);const ae=e=>{const{serverKey:t,cubeName:n}=e,i=(0,c.k)(t),{formatMessage:a}=(0,l.useIntl)(),o=(0,Y.k)(i,e.cubeName),d=(0,s.useMemo)((()=>o?(0,ne.$)((0,re.J)(t,i,{doesIncludeKpis:!1}),o,e.cubeName):[]),[t,i,e.cubeName,o]),u=(0,s.useMemo)((()=>{const r=[];return(0,ee.f)({type:"measuresRoot",serverKey:t,cubeName:n,children:d},{forEachNode:(t,n)=>{(0,ie.d)(t)&&e.selectedMeasureNames.includes(t.measure.name)&&r.push(n)}}),r}),[n,d,e.selectedMeasureNames,t]),[m,h]=(0,s.useState)((()=>(e=>{const t=[];return e.forEach((e=>{for(let n=1;n<e.length;n++)t.push(e.slice(0,n))})),t})(u)));return(0,r.tZ)(te.m,{searchPlaceholder:a({id:"aui.search.measures"}),isSearchVisible:!0,isSelectable:!0,hasCheckbox:ie.d,onSelectedPathsChange:r=>{const i=[];r.forEach((e=>{const r=(0,J.M)({type:"measuresRoot",serverKey:t,cubeName:n,children:d},e);(0,ie.d)(r)&&i.push(r.measure.name)})),e.onMeasureSelected(i)},selectedPaths:u,expandedPaths:m,onExpandedPathsChange:h,value:d})};var oe=n(3018),se=n(49);const le=()=>!0,de=e=>{const{onChange:t}=e,n=(0,s.useCallback)((({membersTree:e,nodePaths:n,isAllMemberSelected:r})=>{t((0,oe.wo)(e,n,r))}),[t]),i=(0,s.useCallback)((({membersTree:e,expansionAction:n})=>{t({type:"memberExpanded",membersTree:e,expansionAction:n})}),[t]),a=(0,s.useCallback)((({searchTree:e,previousSelectedPaths:n,newSelectedPaths:r,isHierarchySlicing:i})=>{t((0,oe.Mg)({searchTree:e,previousSelectedPaths:n,newSelectedPaths:r,isHierarchySlicing:i}))}),[t]),o=(0,s.useCallback)((e=>{t({type:"memberRemovedInTooltip",selectedMemberNamePaths:e})}),[t]);return"Measures"===e.dimensionName?(0,r.tZ)(ae,{serverKey:e.serverKey,cubeName:e.cubeName,selectedMeasureNames:e.selectedMemberNamePaths.map((e=>e[0])),onMeasureSelected:e=>{t((0,A.jz)(e))}}):(0,r.tZ)(se.X,{serverKey:e.serverKey,cubeName:e.cubeName,dimensionName:e.dimensionName,hierarchyName:e.hierarchyName,levelIndex:e.levelIndex,selectedMemberNamePaths:e.selectedMemberNamePaths,expansion:e.expansion,onMemberSelected:n,onMemberExpanded:i,onSearchResultSelected:a,onMemberRemovedInTooltip:o,hasCheckbox:le,isAllMemberSelected:e.isAllMemberSelected,mdxInView:e.mdxInView,filters:e.filtersAbove,searchInputAction:e.searchInputAction})};var ce=n(27860),ue=n.n(ce);const me=e=>{const t=ue()(new Date).set("h",23).set("m",59).set("s",59).toDate(),n="month"===e?ue()(t).month():"quarter"===e?he(t):0;return{startDate:ue()(new Date(t.getFullYear(),n,1)).set("h",0).set("m",0).set("s",0).toDate(),endDate:t}},he=e=>3*Math.floor(ue()(e).month()/3);var pe=n(42654);const ge=e=>{const{formatMessage:t}=(0,l.useIntl)(),{isDateRange:n,isRollingDate:i,startDate:a,endDate:o,timePeriod:s,onChange:d}=e;return(0,r.tZ)(S.Tabs,{css:T.css`
        .ant-tabs-content,
        .ant-tabs-tabpane {
          height: 100%;
        }
      `,defaultActiveKey:"timePeriodToDate"===e.type?"dateRange":e.type,onChange:e=>{d((0,A.hc)(e))},style:{height:"100%"},items:[{key:"topBottomMembers",label:t({id:"aui.filters.basicModes.tree"}),children:(0,r.tZ)("div",{style:{height:"100%"},children:(0,r.tZ)(de,{...e})})},{key:"dateRange",label:t({id:"aui.filters.basicModes.calendar"}),children:(0,r.tZ)(pe.f,{isDateRange:n,isRollingDate:i,onIsDateRangeChanged:e=>{d({type:"isDateRange",isDateRange:e})},onIsRollingDateChanged:e=>{d({type:"isRollingDate",isRollingDate:e,startDate:s?me(s).startDate:a,endDate:s?me(s).endDate:o})},onRangeChanged:({startDate:e,endDate:t})=>{d({type:"dateRangeChanged",startDate:e,endDate:t})},onTimePeriodChanged:e=>{d({type:"timePeriodChanged",timePeriod:e})},range:s?{...me(s)}:{startDate:a,endDate:o},timePeriod:s})}]})},ye=e=>{const t=(0,D.Fg)(),{formatMessage:n}=(0,l.useIntl)(),a=e.isMembersTextAreaVisible?n({id:"aui.search.members"},{hierarchyOrLevelName:e.hierarchyName}):n({id:"aui.typeMembers"});return(0,r.tZ)(w.Tooltip,{title:a,placement:"right",children:(0,r.tZ)(S.Button,{css:T.css`
          &.ant-btn {
            margin-left: 4px;
            padding: 0;
            height: 26px;
            width: 26px;
            align-self: flex-start;
            background-color: ${t.grayScale[2]};
            :hover,
            :focus {
              background-color: ${t.grayScale[2]};
            }
          }
        `,onClick:e.handleClick,children:e.isMembersTextAreaVisible?(0,r.tZ)(i.SearchOutlined,{}):(0,r.tZ)(i.ColumnHeightOutlined,{})})})},{TextArea:fe}=S.Input,ve=e=>{const{formatMessage:t}=(0,l.useIntl)(),{onChange:n}=e;return(0,r.BX)("div",{style:{display:"flex",...e.style},children:[(0,r.tZ)(fe,{onChange:e=>{n(e.target.value)},autoFocus:!0,value:e.value,rows:18,placeholder:`${t({id:"aui.typeMembers"})} ${t({id:"aui.hereOnSeparateLine"})}`,css:T.css`
          &.ant-input {
            background-image: linear-gradient(
              0deg,
              #ffffff 46.67%,
              #f0f0f0 46.67%,
              #f0f0f0 50%,
              #ffffff 50%,
              #ffffff 96.67%,
              #f0f0f0 96.67%,
              #f0f0f0 100%
            );
            background-size: 40px 40px;
            background-attachment: local;
            resize: none;
          }
        `}),(0,r.tZ)(ye,{isMembersTextAreaVisible:!0,...e})]})},be=e=>{const{popoverState:t,onPopoverStateChanged:n}=e,{dimensionName:i,hierarchyName:a,isAdvanced:d,isExclusionFilter:u,membersTextAreaValue:p,isMembersTextAreaVisible:g}=t,y=(0,c.k)(e.serverKey),{formatMessage:f}=(0,l.useIntl)(),v=(0,D.Fg)(),b=(0,m.s)(y,e.cubeName),x="Measures"===i,C=(0,s.useMemo)((()=>(0,L.y)({filtersBySection:e.filters,position:e.position,cube:b})),[e.filters,e.position,b]),N=(0,s.useMemo)((()=>{if(!x&&b&&i&&a)return(0,h._)({dimensionName:i,hierarchyName:a},b)}),[i,a,b,x]),F=(0,s.useMemo)((()=>Object.values(b.measures).filter((e=>e.visible))),[b]),P=(0,s.useMemo)((()=>N?Object.values(N.levels):[]),[N]),M=P.some((e=>"TIME"===e.type)),I=Boolean(N?.slicing),k=(0,r.tZ)(ye,{handleClick:()=>{n({type:"membersTextAreaVisibilityChanged",isVisible:!0,isHierarchySlicing:I})},isMembersTextAreaVisible:g}),E=(0,s.useRef)(null),[R,Z]=(0,w.usePopupSize)(E,`${i}-${a}`,400),O=M?630:Z;if(!(i&&a&&b&&F))return null;if(!N&&!x)return null;const K=N?I?P.length:P.length-1:0;return(0,r.BX)("div",{ref:E,css:T.css`
        display: flex;
        flex-direction: column;
        height: 100%;
        width: ${O}px;
        overflow: hidden;
      `,children:[(0,r.BX)("div",{css:T.css`
          flex-grow: 1;
          display: inline-flex;
          justify-content: space-between;
          min-height: 0;
        `,children:[(0,r.tZ)("div",{css:T.css`
            flex-grow: 1;
            width: 100%;
          `,children:g&&!d?(0,r.tZ)(ve,{handleClick:()=>{n({type:"membersTextAreaVisibilityChanged",isVisible:!1,isHierarchySlicing:I})},hierarchyName:a,onChange:e=>{n({type:"membersTextAreaValueChanged",value:e})},value:p}):N?.virtual?(0,r.tZ)(B.$,{serverKey:e.serverKey,cubeName:e.cubeName,dimensionName:i,hierarchyName:a,levelIndex:t.levelIndex,onLevelIndexChanged:e=>{n((0,A.Og)(e))},onSelectionChanged:e=>{n({type:"virtualHierarchyMemberSelected",selectedMemberNamePaths:e})},selectedMemberNamePaths:t.selectedMemberNamePaths,selectedMemberNamePathsHistory:t.selectedMemberNamePathsHistory,searchInputAction:k,filters:C,hasLevelChooser:K>1}):d?(0,r.tZ)(Q,{hierarchy:N,levels:P,measures:F,value:t,onChange:n,isFilterOnDate:M}):M?(0,r.tZ)(ge,{isDateRange:t.isDateRange,isRollingDate:t.isRollingDate,timePeriod:t.timePeriod,selectedMemberNamePaths:t.selectedMemberNamePaths,levelIndex:t.levelIndex,expansion:t.expansion,isAllMemberSelected:t.isAllMemberSelected??!1,serverKey:e.serverKey,cubeName:e.cubeName,onChange:n,mdxInView:e.mdxInViews[e.position.sectionName],filtersAbove:C,dimensionName:i,hierarchyName:a,searchInputAction:k}):(0,r.tZ)(de,{levelIndex:t.levelIndex,selectedMemberNamePaths:t.selectedMemberNamePaths,expansion:t.expansion,isAllMemberSelected:t.isAllMemberSelected??!1,serverKey:e.serverKey,cubeName:e.cubeName,onChange:n,mdxInView:e.mdxInViews[e.position.sectionName],filtersAbove:C,dimensionName:i,hierarchyName:a,searchInputAction:k})}),!M&&(0,r.tZ)("div",{style:{backgroundColor:v.grayScale[6],opacity:.4,width:4,height:32,cursor:"ew-resize",marginLeft:5,alignSelf:"center"},onMouseDown:R})]}),(0,r.BX)("div",{css:T.css`
          height: 35px;
          display: flex;
          align-items: center;
          justify-content: ${d?"flex-end":"space-between"};
        `,children:[!d&&(0,r.tZ)(S.Checkbox,{checked:u,onChange:e=>{n((0,A.XH)(e.target.checked))},children:f({id:"aui.filters.excludeFilter"})}),(0,r.BX)("div",{children:[(0,r.tZ)(S.Button,{css:T.css`
              &.ant-btn {
                margin-right: 8px;
              }
            `,onClick:e.onCancel,children:f({id:"aui.cancel"})}),(0,r.tZ)(S.Button,{onClick:()=>{if(g){const n=(0,V.E)(t.membersTextAreaValue,I);e.onOk({...t,selectedMemberNamePaths:(0,o.uniqWith)([...t.selectedMemberNamePaths,...n],o.isEqual)})}else e.onOk(t)},disabled:!$(t),type:"primary",children:f({id:"aui.contentTree.applyLoadedFiles"},{contentType:"filter",count:1})})]})]})]})};var xe=n(80352),Ce=n(8666);const Te=({cube:e,filter:t})=>{const{formatMessage:n}=(0,l.useIntl)(),i="Measures"===t.dimensionName,a=i?null:(0,h._)({hierarchyName:t.hierarchyName,dimensionName:t.dimensionName},e),o=(0,R.L)({cube:e,filter:t});return(0,r.BX)("div",{css:{display:"flex"},children:[(0,r.tZ)("div",{css:{flexGrow:1,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:i?n({id:"aui.dataVisualization.measures"}):a?.caption}),(0,r.tZ)("div",{css:{display:"flex",flexDirection:"row",minWidth:35},children:(0,r.tZ)("div",{css:{textAlign:"right",flexGrow:1,flexShrink:1,marginLeft:10,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:o})})]})};function Se(e){return"isCorrupt"in e}const we=e=>{const{formatMessage:t}=(0,l.useIntl)(),{onFiltersChange:n}=e,[N]=(0,d.g)("canManageContent"),F=(0,s.useMemo)((()=>e.dragItemTypes||["DATA_TREE_FIELD","FILTER_IN_WIZARD","SAVED_FILTER"]),[e.dragItemTypes]),P=(0,c.k)(e.serverKey),M=P?(0,m.s)(P,e.cubeName):void 0,{popoverConfiguration:I,onPopoverConfigurationChanged:D}=e,{serverKey:k,cubeName:E}=(R=I,"edit-filter"===R?.type||function(e){return"create-filter"===e?.type}(I)?I:{});var R;const B=(0,c.k)(k),L=B&&E?(0,m.s)(B,E):null,V=t({id:"aui.dataVisualization.measures"}),$=(0,s.useMemo)((()=>M?M.defaultMembers.filter((({dimension:e})=>"Measures"!==e)).map((({dimension:e,hierarchy:t,path:n},r)=>({dimensionName:e,hierarchyName:t,members:[n],type:"members"}))):[]),[M]),K=(0,u.T)(),W=(0,s.useMemo)((()=>M?(0,o.mapValues)((0,o.pick)(e.filters,e.visibleSectionNames),((t,n)=>t.map((t=>{try{return"Measures"!==t.dimensionName&&(0,h._)(t,M),{filter:t,cubeName:M.name,serverKey:e.serverKey}}catch(t){if(t instanceof p.B||t instanceof g.K)return{serverKey:e.serverKey,cubeName:M.name,isCorrupt:!0,missingHierarchyOrDimensionName:t instanceof p.B?t.dimensionName:`[${t.hierarchyCoordinates.dimensionName}].[${t.hierarchyCoordinates.hierarchyName}]`};throw t}})))):{}),[e.filters,M,e.serverKey,e.visibleSectionNames]),X=I&&"save-filter"===I.type?W[I.position.sectionName][I.position.tileIndex]:null,H=(0,s.useCallback)((t=>{if(I&&("edit-filter"===I.type||"create-filter"===I.type)&&(0,o.isEqual)(t,I.position))D(void 0);else{const r=(0,a.produce)(e.filters,(e=>{e[t.sectionName].splice(t.tileIndex,1)}));n(r)}}),[I,D,e.filters,n]),G=(0,s.useMemo)((()=>{if(!M)return{};const o=(e,t)=>Object.values(W).slice(t).some((t=>t.some((t=>!Se(t)&&(0,y.I)(e,t.filter))))),l={placeholder:t({id:"aui.filters.no-filters"}),placeholderTooltip:t({id:"aui.dataVisualization.placeholderTooltip.noFilter"}),caption:t({id:"aui.filters.section.cube"}),tiles:$.map(((t,n)=>({caption:(0,r.tZ)(Te,{cube:M,filter:t}),dragItem:{serverKey:e.serverKey,cubeName:M.name,fromPosition:{sectionName:"cube",tileIndex:n},type:"FILTER_IN_WIZARD"},isDisabled:o(t,0),isRemovable:!1})))};return Object.entries(W).reduce(((o,[l,d])=>{const c=e.sectionCaptions?.[l]||t({id:`aui.filters.section.${l}`}),u=d.map(((o,d)=>{const c={sectionName:l,tileIndex:d},{cubeName:u,serverKey:h}=o,p=(0,m.s)(K[h],u);if(Se(o))return{caption:o.missingHierarchyOrDimensionName,dragItem:null,isCorrupt:!0,isDisabled:!0,tooltipValue:t({id:"aui.contentTree.missingHierarchy"},{missingHierarchy:o.missingHierarchyOrDimensionName,cube:p.caption})};const{filter:g}=o,y=g?{filter:g,cubeName:u,serverKey:h,fromPosition:c,type:"FILTER_IN_WIZARD"}:null,{isPinned:f}=e.filters[c.sectionName][c.tileIndex];return{icons:(0,r.BX)(s.Fragment,{children:[N&&(0,r.tZ)(i.SaveOutlined,{onClick:()=>{D({position:c,type:"save-filter"})}}),"custom"!==g.type&&(0,r.tZ)(i.EditOutlined,{onClick:()=>{const e=(0,C.a)(g,p);D({serverKey:h,cubeName:u,hierarchyCoordinates:{dimensionName:g.dimensionName,hierarchyName:g.hierarchyName},levelIndex:e.levelIndex,position:c,type:"edit-filter"})}}),void 0===I&&(0,r.tZ)(i.CloseOutlined,{onClick:()=>H(c)}),!f&&(0,r.tZ)(i.PushpinOutlined,{onClick:()=>{const t=(0,a.produce)(e.filters,(e=>{e[c.sectionName][c.tileIndex].isPinned=!0}));n(t)}})]}),stickyIcons:f&&(0,r.tZ)(i.PushpinFilled,{onClick:()=>{const t=(0,a.produce)(e.filters,(e=>{e[c.sectionName][c.tileIndex].isPinned=!1}));n(t)}}),caption:(0,r.tZ)(Te,{cube:p,filter:g}),dragItem:y,isRemovable:!1}}));if("create-filter"===I?.type&&I.position.sectionName===l&&I.hierarchyCoordinates){const{hierarchyCoordinates:e,position:{tileIndex:t}}=I,n="Measures"===e.dimensionName?V:(0,h._)(e,L).caption;u.splice(t,0,{caption:(0,r.tZ)("span",{children:n}),dragItem:null})}return{...o,[l]:{placeholder:t({id:"aui.filters.no-filters"}),placeholderTooltip:t({id:"aui.dataVisualization.placeholderTooltip.noFilter"}),caption:c,tiles:u}}}),e.areCubeFiltersVisible?{cube:l}:{})}),[V,M,$,K,W,t,I,e.areCubeFiltersVisible,e.sectionCaptions,L,e.serverKey,N,D,n,e.filters,H]),_=({serverKey:t,cubeName:n,dimension:r,hierarchy:i,toPosition:a})=>{e.onPopoverConfigurationChanged({serverKey:t,cubeName:n,hierarchyCoordinates:{dimensionName:r.name,hierarchyName:i.name},levelIndex:i.slicing?0:1,position:a,type:"create-filter"})},j=function({cube:e,filterBeingSaved:t,filters:n,mdxInViews:i,onCancel:a,onSubmit:o,popoverConfiguration:d}){const{formatMessage:c}=(0,l.useIntl)(),u=(0,s.useMemo)((()=>{if(e&&"edit-filter"===d?.type){const{position:{sectionName:t,tileIndex:r}}=d,i=n[t][r];return(0,C.a)(i,e)}return"create-filter"===d?.type?(0,O.E)({hierarchyCoordinates:d.hierarchyCoordinates,levelIndex:d.levelIndex}):(0,O.E)()}),[e,d,n]),[m,p]=(0,s.useReducer)(A.J1,u);if((0,s.useEffect)((()=>{p((0,A.gs)(u))}),[u]),e)switch(d?.type){case"save-filter":if(!t)return;return{title:c({id:"aui.contentTree.saveAs"},{contentType:"filter"}),content:(0,r.tZ)(Z,{cube:e,filter:t,onCancel:a,afterSubmit:a})};case"edit-filter":case"create-filter":{const t=(0,h._)(d.hierarchyCoordinates,e),s="Measures"===d.hierarchyCoordinates.dimensionName;return{title:c({id:"aui.filters.add"},{hierarchy:s?c({id:"aui.dataVisualization.measures"}):t?.caption}),content:(0,r.tZ)(be,{position:d.position,cubeName:d.cubeName,serverKey:d.serverKey,onPopoverStateChanged:p,popoverState:m,onOk:o,onCancel:a,filters:n,mdxInViews:i}),headerExtra:s?null:(0,r.tZ)(w.Tooltip,{trigger:t?.virtual?["hover"]:[],title:c({id:"aui.filters.virtualHierarchyHints.advancedFilters"}),children:(0,r.BX)("div",{css:T.css`
                display: flex;
                justify-content: flex-end;
                align-items: center;
                width: 100%;
              `,children:[(0,r.tZ)(S.Switch,{checked:m.isAdvanced,onChange:e=>{p((0,A.nL)(e))},size:"small",disabled:t?.virtual}),(0,r.tZ)(w.Text,{css:T.css`
                  margin-left: 8px;
                `,small:!0,disabled:t?.virtual,children:c({id:"aui.advanced"})})]})})}}default:return}}({cube:M,filters:e.filters,filterBeingSaved:X&&!Se(X)?X.filter:void 0,mdxInViews:e.mdxInViews,onCancel:()=>{e.onPopoverConfigurationChanged(void 0)},onSubmit:t=>{if(I&&("edit-filter"===I.type||"create-filter"===I.type)){const r=(({dimensionName:e,hierarchyName:t,isAdvanced:n,isExclusionFilter:r,levelIndex:i,limit:a,measureName:o,scope:s,selectedMemberNamePaths:l,topBottomMode:d,type:c,lowerOrGreaterLimit:u,doesExist:m,containingMode:p,token:g,isBetween:y,upperLimit:f,lowerLimit:v,lowerOrGreaterMode:b,lowerToken:x,upperToken:C,startDate:T,endDate:S,isDateRange:w,isRollingDate:N,timePeriod:F,numberOfRecentDates:P},M)=>{if(!e||!t)throw new Error("EditFilterPopoverState is missing a dimensionName or a hierarchyName.");const I={dimensionName:e,hierarchyName:t},D=(0,h._)({dimensionName:e,hierarchyName:t},M),k=Object.keys(D.levels)[i];if(!n)return"dateRange"===c?{...I,type:"dateRange",levelName:k,isExclusionFilter:r,startDate:T,endDate:w?S:T,isRollingDate:N}:"timePeriodToDate"===c?{...I,type:"timePeriodToDate",levelName:k,isExclusionFilter:r,timePeriod:F}:{...I,type:"members",members:l,isExclusionFilter:r};switch(c){case"topBottomMembers":return{...I,limit:a,scope:s,topBottomMode:d,levelName:k,measureName:o,type:c};case"lowerOrGreaterValue":return{...I,levelName:k,lowerOrGreaterLimit:u,measureName:o,lowerOrGreaterMode:b,type:c};case"existenceOfValue":return{...I,levelName:k,doesExist:m,measureName:o,type:c};case"valuesRange":return{...I,levelName:k,isBetween:y,upperLimit:f,lowerLimit:v,measureName:o,type:c};case"captionsRange":return{...I,levelName:k,isBetween:y,lowerToken:x,upperToken:C,type:c};case"lowerOrGreaterCaptions":return{...I,lowerOrGreaterMode:b,token:g,levelName:k,type:c};case"captionsContaining":return{...I,levelName:k,token:g,containingMode:p,type:c};case"recentDates":return{...I,levelName:k,type:c,numberOfRecentDates:P};default:throw new Error(`Could not convert the filter popup state into a filter. Custom filter type: ${c}.`)}})(t,L),{position:{sectionName:i,tileIndex:o}}=I,s=(0,a.produce)(e.filters,(e=>{"edit-filter"===I?.type?e[i][o]={...r,isPinned:e[i][o].isPinned}:e[i].splice(o,0,r)}));e.onPopoverConfigurationChanged(void 0),n(s)}},popoverConfiguration:I});return M?(0,r.tZ)(x.e,{canDrop:({dragItem:t,toPosition:n})=>"cube"!==n.sectionName&&void 0===I&&e.canDrop({dragItem:t,toPosition:n}),dragItemTypes:F,onTileMoved:({dragItem:t,toPosition:r})=>{if((0,xe.p)(t)&&M){const{filter:i,serverKey:o,cubeName:s,fromPosition:{sectionName:l,tileIndex:d}}=t;if("cube"===l){const t=$[d],n=(0,h._)(t,M);e.onPopoverConfigurationChanged({serverKey:o,cubeName:s,hierarchyCoordinates:{dimensionName:t.dimensionName,hierarchyName:t.hierarchyName},levelIndex:n.slicing?0:1,position:r,type:"create-filter"})}else{let t=r.tileIndex;r.sectionName===l&&r.tileIndex>d&&t--;const o=(0,a.produce)(e.filters,(n=>{n[l].splice(d,1),n[r.sectionName].splice(t,0,{...i,isPinned:e.filters[l][d].isPinned})}));n(o)}}else e.onTileMoved&&e.onTileMoved({dragItem:t,toPosition:r})},onTileAdded:async({dragItem:t,toPosition:r})=>{if((0,f.x)(t))(({serverKey:e,cubeName:t,dimension:n,toPosition:r})=>{const i=n.hierarchies[n.defaultHierarchy];_({serverKey:e,cubeName:t,dimension:n,hierarchy:i,toPosition:r})})({serverKey:t.serverKey,cubeName:t.cubeName,toPosition:r,dimension:t.dimension});else if((0,v.W)(t))_({serverKey:t.serverKey,cubeName:t.cubeName,dimension:t.dimension,hierarchy:t.hierarchy,toPosition:r});else if((0,b.k)(t))(({serverKey:t,cubeName:n,dimension:r,hierarchy:i,level:a,toPosition:o})=>{e.onPopoverConfigurationChanged({serverKey:t,cubeName:n,hierarchyCoordinates:{dimensionName:r.name,hierarchyName:i.name},levelIndex:a.index,position:o,type:"create-filter"})})({serverKey:t.serverKey,cubeName:t.cubeName,dimension:t.dimension,hierarchy:t.hierarchy,level:t.level,toPosition:r});else if((0,Ce.Q)(t)){const i=await t.fetchFilter(),o=(0,a.produce)(e.filters,(e=>{e[r.sectionName].splice(r.tileIndex,0,i)}));n(o)}},onTileRemoved:H,onKeyDown:t=>{I&&"Escape"===t.key&&e.onPopoverConfigurationChanged(void 0)},sections:G,popoverPosition:I?.position,popover:j,popoverInnerHeight:432}):null}},35969:(e,t,n)=>{n.d(t,{B4:()=>m,Gv:()=>f,HD:()=>g,J1:()=>s,K5:()=>T,No:()=>y,Og:()=>d,RK:()=>M,T4:()=>S,W7:()=>N,XH:()=>c,Z1:()=>w,b4:()=>b,fZ:()=>P,gs:()=>C,hc:()=>x,j9:()=>h,jz:()=>p,nL:()=>l,ok:()=>F,q7:()=>u,yA:()=>v});var r=n(77026),i=n(99438),a=n(3018),o=n(19389);const s=(e,t)=>{switch(t.type){case"isAdvancedChanged":let n=e.type;return!t.isAdvanced||"dateRange"!==n&&"timePeriodToDate"!==n||(n="topBottomMembers"),{...e,type:n,isAdvanced:t.isAdvanced};case"isExclusionFilterChanged":return{...e,isExclusionFilter:t.isExclusionFilter};case"levelIndexChanged":return{...e,selectedMemberNamePathsHistory:[],levelIndex:t.levelIndex};case"limitChanged":return{...e,limit:t.limit};case"lowerOrGreaterLimitChanged":return{...e,lowerOrGreaterLimit:t.lowerOrGreaterLimit};case"numberOfRecentDatesChanged":return{...e,numberOfRecentDates:t.numberOfRecentDates};case"measureSelected":return{...e,selectedMemberNamePaths:t.measureNames.map((e=>[e]))};case"measureChangedInAdvancedMode":return{...e,measureName:t.measureName};case"topBottomModeChanged":return{...e,topBottomMode:t.topBottomMode};case"existenceModeChanged":return{...e,doesExist:t.doesExist};case"popupReset":return t.payload;case"scopeChanged":return{...e,scope:t.scope};case"typeChanged":return{...e,type:t.filterType};case"betweenModeChanged":return{...e,isBetween:t.isBetween};case"upperLimitChanged":return{...e,upperLimit:t.upperLimit};case"lowerLimitChanged":return{...e,lowerLimit:t.lowerLimit};case"lowerOrGreaterModeChanged":return{...e,lowerOrGreaterMode:t.lowerOrGreaterMode};case"containingModeChanged":return{...e,containingMode:t.containingMode};case"tokenChanged":return{...e,token:t.token};case"lowerTokenChanged":return{...e,lowerToken:t.lowerToken};case"upperTokenChanged":return{...e,upperToken:t.upperToken};case"dateRangeChanged":return{...e,type:"dateRange",startDate:t.startDate,endDate:t.endDate,timePeriod:void 0};case"isDateRange":return{...e,type:"dateRange",isDateRange:t.isDateRange,timePeriod:void 0};case"isRollingDate":return{...e,type:"dateRange",isRollingDate:t.isRollingDate,startDate:t.startDate,endDate:t.endDate,timePeriod:void 0};case"timePeriodChanged":return{...e,type:"timePeriodToDate",timePeriod:t.timePeriod,isDateRange:!0,isRollingDate:!1,startDate:void 0,endDate:void 0};case"virtualHierarchyMemberSelected":const s=(0,r.uniqWith)([...e.selectedMemberNamePathsHistory,...t.selectedMemberNamePaths],i.m);return{...e,selectedMemberNamePaths:t.selectedMemberNamePaths,selectedMemberNamePathsHistory:s};case"membersTextAreaValueChanged":return{...e,membersTextAreaValue:t.value};case"membersTextAreaVisibilityChanged":{const n={...e,isMembersTextAreaVisible:t.isVisible};if(!t.isVisible){n.membersTextAreaValue="";const i=(0,o.E)(e.membersTextAreaValue,t.isHierarchySlicing);n.selectedMemberNamePaths=(0,r.uniqWith)([...e.selectedMemberNamePaths,...i],r.isEqual)}return n}default:return{...e,...(0,a.cE)(e,t)}}},l=e=>({type:"isAdvancedChanged",isAdvanced:e}),d=e=>({type:"levelIndexChanged",levelIndex:e}),c=e=>({type:"isExclusionFilterChanged",isExclusionFilter:e}),u=e=>({type:"limitChanged",limit:e}),m=e=>({type:"lowerOrGreaterLimitChanged",lowerOrGreaterLimit:e}),h=e=>({type:"numberOfRecentDatesChanged",numberOfRecentDates:e}),p=e=>({type:"measureSelected",measureNames:e}),g=e=>({type:"measureChangedInAdvancedMode",measureName:e}),y=e=>({type:"topBottomModeChanged",topBottomMode:e}),f=e=>({type:"lowerOrGreaterModeChanged",lowerOrGreaterMode:e}),v=e=>({type:"existenceModeChanged",doesExist:e}),b=e=>({type:"scopeChanged",scope:e}),x=e=>({type:"typeChanged",filterType:e}),C=e=>({type:"popupReset",payload:e}),T=e=>({type:"lowerTokenChanged",lowerToken:e}),S=e=>({type:"upperTokenChanged",upperToken:e}),w=e=>({type:"betweenModeChanged",isBetween:e}),N=e=>({type:"lowerLimitChanged",lowerLimit:e}),F=e=>({type:"upperLimitChanged",upperLimit:e}),P=e=>({type:"containingModeChanged",containingMode:e}),M=e=>({type:"tokenChanged",token:e})},70892:(e,t,n)=>{n.d(t,{L:()=>s});var r=n(93481),i=n(18807),a=n(41507),o=n(69673);function s({cube:e,filter:t}){const{formatMessage:n}=(0,r.useIntl)();switch(t.type){case"members":return function({cube:e,filter:t,selectedMemberTranslation:n}){const{dimensionName:r,hierarchyName:i,members:a}=t,s="Measures"===r,l=s?void 0:(0,o._)({dimensionName:r,hierarchyName:i},e);if(1!==a.length)return n;const{isExclusionFilter:d}=t;if(s)return d?`â  ${a[0][0]}`:a[0][0];const c=a[0].slice(l?.slicing?0:1),u=c.length>3?`${c[0]} > â¦ > ${c.at(-1)}`:c.join(" > ");return d?`â  ${u}`:u}({cube:e,filter:t,selectedMemberTranslation:n({id:"aui.filters."+(t.isExclusionFilter?"excluded":"selected")},{numberOfMembers:t.members.length})});case"topBottomMembers":return function({cube:e,filter:t,topBottomMembersTranslation:n}){const r=(0,i.t)(t.measureName,e),a=`${n} ${r?r.caption:null}`;return t.isExclusionFilter?`â  ${a}`:a}({cube:e,filter:t,topBottomMembersTranslation:n({id:"aui.filters.topBottomMembers."+(["TopCount","TopPercent","TopSum"].includes(t.topBottomMode)?"highest":"lowest")},{number:t.limit})});case"lowerOrGreaterValue":return function({cube:e,filter:t}){const n=(0,i.t)(t.measureName,e),r=`${n?.caption} ${a.f[t.lowerOrGreaterMode].label} ${t.lowerOrGreaterLimit}`;return t.isExclusionFilter?`â  ${r}`:r}({cube:e,filter:t});case"captionsContaining":return function({cube:e,filter:t,containingModeTranslation:n}){const r=`${n} "${t.token}"`;return t.isExclusionFilter?`â  ${r}`:r}({cube:e,filter:t,containingModeTranslation:n({id:`aui.filters.containingMode.${t.containingMode}`})});case"valuesRange":return function({cube:e,filter:t}){const n=(0,i.t)(t.measureName,e),r=`${n?.caption}${t.isBetween?" â ":" â "}[${t.lowerLimit}, ${t.upperLimit}]`;return t.isExclusionFilter?`â  ${r}`:r}({cube:e,filter:t});case"lowerOrGreaterCaptions":return function({filter:e}){const t=`${a.f[e.lowerOrGreaterMode].label} "${e.token}"`;return e.isExclusionFilter?`â  ${t}`:t}({filter:t});case"existenceOfValue":return function({cube:e,filter:t}){const n=(0,i.t)(t.measureName,e),r=`${t.doesExist?"â":"â"} ${n?.caption}`;return t.isExclusionFilter?`â  ${r}`:r}({cube:e,filter:t});case"captionsRange":return function({cube:e,filter:t}){const n=`${t.isBetween?"â":"â"} ["${t.lowerToken}", "${t.upperToken}"]`;return t.isExclusionFilter?`â  ${n}`:n}({cube:e,filter:t});case"dateRange":return function(e){const t=e.startDate.toLocaleDateString(),n=e.endDate.toLocaleDateString();return t===n?`${e.isExclusionFilter?"â  ":""}${t}`:`${e.isExclusionFilter?"â":"â"} [${t}, ${n}]`}(t);case"timePeriodToDate":const r=n({id:`aui.filters.timePeriodToDate.${t.timePeriod}`});return`${t.isExclusionFilter?"â  ":""}${r}`;case"recentDates":return`${n({id:"aui.filters.recentDates"})} ${t.numberOfRecentDates}`;case"custom":return n({id:"aui.filters.custom"})}}},16372:(e,t,n)=>{n.d(t,{l:()=>S});var r=n(46980),i=n(21821);function a(e){return e>=0?{elementType:"Literal",type:"SCALAR",value:`${e}`}:{elementType:"Function",name:"-",syntax:"Prefix",arguments:[{elementType:"Literal",type:"SCALAR",value:`${Math.abs(e)}`}]}}const o=e=>({arguments:[{arguments:[(0,r.M)(e)],elementType:"Function",name:"CurrentMember",syntax:"Property"}],elementType:"Function",name:"MEMBER_CAPTION",syntax:"Property"});var s=n(27860),l=n.n(s);function d(e,t){return{elementType:"Function",name:"AND",syntax:"Infix",arguments:[e,t]}}function c(e){return{elementType:"Function",name:"CDate",syntax:"Function",arguments:[e]}}function u(e,t,n){return{elementType:"Function",name:e,syntax:"Infix",arguments:[t,n]}}function m(e){return l()(e).set("h",12).set("m",0).set("s",0).set("ms",0)}function h({startDate:e,endDate:t,memberValueCDateNode:n}){const r=e.toLocaleDateString()===t.toLocaleDateString(),i=(r?[{operator:"=",date:e}]:[{operator:">=",date:e},{operator:"<=",date:t}]).map((({operator:e,date:t})=>{const r=(e=>{const t=m(new Date);return m(e).diff(t,"d")})(t);return u(e,{elementType:"Function",name:"DateDiff",syntax:"Function",arguments:[{elementType:"Literal",type:"STRING",value:"d"},{elementType:"Function",name:"now",syntax:"Function",arguments:[]},n]},a(r))}));return r?i[0]:{elementType:"Function",name:"()",syntax:"Parentheses",arguments:[d(i[0],i[1])]}}function p({startDate:e,endDate:t,memberValueCDateNode:n}){const r=[{operator:">=",date:e},{operator:"<=",date:t}],[i,a]=r.map((({operator:e,date:t})=>u(e,n,c({elementType:"Literal",type:"STRING",value:`${l()(t).format("YYYY-MM-DD[T]HH:mm:ss")}`}))));return{elementType:"Function",name:"()",syntax:"Parentheses",arguments:[d(i,a)]}}var g=n(58509),y=n(41507),f=n(31382);const v={month:"m",quarter:"q",year:"yyyy"},b=(e,t)=>{const n=[{operator:"=",value:v[e]},{operator:"<=",value:"d"}],[r,i]=n.map((({operator:e,value:n})=>u(e,{elementType:"Function",name:"DateDiff",syntax:"Function",arguments:[{elementType:"Literal",type:"STRING",value:n},c({elementType:"Function",name:"Now",syntax:"Function",arguments:[]}),t]},a(0))));return{elementType:"Function",name:"()",syntax:"Parentheses",arguments:[d(r,i)]}};var x=n(53804);const C=(e,t)=>{const{dimensionName:n,hierarchyName:a}=e;switch(e.type){case"topBottomMembers":case"lowerOrGreaterValue":case"existenceOfValue":case"valuesRange":case"lowerOrGreaterCaptions":case"captionsContaining":case"captionsRange":return{elementType:"Function",name:"Members",syntax:"Property",arguments:[(0,i.P)({dimensionName:n,hierarchyName:a,levelName:e.levelName})]};default:return{elementType:"Function",name:"Members",syntax:"Property",arguments:[(0,r.M)({dimensionName:n,hierarchyName:a})]}}},T=(e,t)=>{switch(e.type){case"members":return(({dimensionName:e,hierarchyName:t,members:n},r)=>{if(0!==n.length)return 1===n.length?(0,f.c)({dimensionName:e,hierarchyName:t,namePath:n[0]},r):{arguments:n.map((n=>(0,f.c)({dimensionName:e,hierarchyName:t,namePath:n},r))),elementType:"Function",name:"{}",syntax:"Braces"}})(e,t);case"topBottomMembers":return((e,t)=>{const{dimensionName:n,hierarchyName:i,levelName:o}=e,s=(0,x.K)({cube:t,dimensionName:n,hierarchyName:i,levelName:o}),l=(({dimensionName:e,hierarchyName:t,levelName:n,limit:i,measureName:o,topBottomMode:s,scope:l},d)=>({arguments:[{arguments:["overall"===l?{arguments:[{arguments:[(0,r.M)({dimensionName:e,hierarchyName:t}),a(d)],elementType:"Function",name:"Levels",syntax:"Method"}],elementType:"Function",name:"Members",syntax:"Property"}:{arguments:[{arguments:[(0,r.M)({dimensionName:e,hierarchyName:t})],elementType:"Function",name:"CurrentMember",syntax:"Property"}],elementType:"Function",name:"Children",syntax:"Property"},{arguments:[{arguments:[(0,g.F)(o)],elementType:"Function",name:"IsEmpty",syntax:"Function"}],elementType:"Function",name:"NOT",syntax:"Prefix"}],elementType:"Function",name:"Filter",syntax:"Function"},a(i),(0,g.F)(o)],elementType:"Function",name:s,syntax:"Function"}))(e,s);return"overall"===e.scope?l:{arguments:[{arguments:[{arguments:[(0,r.M)(e),a(s-1)],elementType:"Function",name:"Levels",syntax:"Method"}],elementType:"Function",name:"Members",syntax:"Property"},l],elementType:"Function",name:"Generate",syntax:"Function"}})(e,t);case"lowerOrGreaterValue":return(e=>({arguments:[{arguments:[(0,i.P)(e)],elementType:"Function",name:"Members",syntax:"Property"},{arguments:[(0,g.F)(e.measureName),{elementType:"Literal",type:"SCALAR",value:`${e.lowerOrGreaterLimit}`}],elementType:"Function",name:y.f[e.lowerOrGreaterMode].operator,syntax:"Infix"}],elementType:"Function",name:"Filter",syntax:"Function"}))(e);case"existenceOfValue":return(e=>{const t={arguments:[(0,g.F)(e.measureName)],elementType:"Function",name:"IsEmpty",syntax:"Function"},n=!1===e.doesExist?t:{arguments:[t],elementType:"Function",name:"NOT",syntax:"Prefix"};return{arguments:[{arguments:[(0,i.P)(e)],elementType:"Function",name:"Members",syntax:"Property"},n],elementType:"Function",name:"Filter",syntax:"Function"}})(e);case"valuesRange":return function(e){const t=(0,g.F)(e.measureName);return{elementType:"Function",name:"Filter",syntax:"Function",arguments:[{elementType:"Function",name:"Members",syntax:"Property",arguments:[(0,i.P)(e)]},{elementType:"Function",name:e.isBetween?"AND":"OR",syntax:"Infix",arguments:[{elementType:"Function",name:e.isBetween?">=":"<",syntax:"Infix",arguments:[t,a(e.lowerLimit)]},{elementType:"Function",name:e.isBetween?"<=":">",syntax:"Infix",arguments:[t,a(e.upperLimit)]}]}]}}(e);case"lowerOrGreaterCaptions":return function(e){const t=y.f[e.lowerOrGreaterMode].operator;return{arguments:[{arguments:[(0,i.P)(e)],elementType:"Function",name:"Members",syntax:"Property"},{arguments:[{arguments:[{arguments:[(0,r.M)(e)],elementType:"Function",name:"CurrentMember",syntax:"Property"}],elementType:"Function",name:"MEMBER_CAPTION",syntax:"Property"},{elementType:"Literal",type:"STRING",value:e.token}],elementType:"Function",name:t,syntax:"Infix"}],elementType:"Function",name:"Filter",syntax:"Function"}}(e);case"captionsContaining":return function(e){let t;switch(e.containingMode){case"contains":case"doesNotContain":t=(e=>({elementType:"Function",syntax:"Infix",name:"contains"===e.containingMode?">":"=",arguments:[{elementType:"Function",syntax:"Function",name:"InStr",arguments:[a(1),o(e),{elementType:"Literal",type:"STRING",value:e.token}]},a(0)]}))(e);break;case"startsWith":case"doesNotStartWith":case"endsWith":case"doesNotEndWith":t=(e=>({elementType:"Function",syntax:"Infix",name:"endsWith"===e.containingMode||"startsWith"===e.containingMode?"=":"<>",arguments:[{elementType:"Function",syntax:"Function",name:"startsWith"===e.containingMode||"doesNotStartWith"===e.containingMode?"Left":"Right",arguments:[o(e),a(e.token.length)]},{elementType:"Literal",type:"STRING",value:e.token}]}))(e)}return{elementType:"Function",name:"Filter",syntax:"Function",arguments:[{arguments:[(0,i.P)(e)],elementType:"Function",name:"Members",syntax:"Property"},t]}}(e);case"captionsRange":return function(e){return{arguments:[{arguments:[(0,i.P)(e)],elementType:"Function",name:"Members",syntax:"Property"},{arguments:[{arguments:[{arguments:[{arguments:[(0,r.M)(e)],elementType:"Function",name:"CurrentMember",syntax:"Property"}],elementType:"Function",name:"MEMBER_CAPTION",syntax:"Property"},{elementType:"Literal",type:"STRING",value:e.lowerToken}],elementType:"Function",name:e.isBetween?">=":"<",syntax:"Infix"},{arguments:[{arguments:[{arguments:[(0,r.M)(e)],elementType:"Function",name:"CurrentMember",syntax:"Property"}],elementType:"Function",name:"MEMBER_CAPTION",syntax:"Property"},{elementType:"Literal",type:"STRING",value:e.upperToken}],elementType:"Function",name:e.isBetween?"<=":">",syntax:"Infix"}],elementType:"Function",name:e.isBetween?"AND":"OR",syntax:"Infix"}],elementType:"Function",name:"Filter",syntax:"Function"}}(e);case"dateRange":return function(e){const t=new Date(e.startDate);t.setHours(0,0,0);const n=new Date(e.endDate);n.setHours(23,59,59);const a={elementType:"Function",name:"MemberValue",syntax:"Property",arguments:[{elementType:"Function",name:"CurrentMember",syntax:"Property",arguments:[(0,r.M)(e)]}]};return{elementType:"Function",name:"Filter",syntax:"Function",arguments:[{arguments:[(0,i.P)(e)],elementType:"Function",name:"Members",syntax:"Property"},d({elementType:"Function",name:"IsDate",syntax:"Function",arguments:[a]},(e.isRollingDate?h:p)({startDate:t,endDate:n,memberValueCDateNode:c(a)}))]}}(e);case"timePeriodToDate":return function(e){const t={elementType:"Function",name:"MemberValue",syntax:"Property",arguments:[{elementType:"Function",name:"CurrentMember",syntax:"Property",arguments:[(0,r.M)(e)]}]};return{elementType:"Function",name:"Filter",syntax:"Function",arguments:[{elementType:"Function",name:"Members",syntax:"Property",arguments:[(0,i.P)(e)]},d({elementType:"Function",name:"IsDate",syntax:"Function",arguments:[t]},b(e.timePeriod,t))]}}(e);case"recentDates":return(e=>({elementType:"Function",name:"Subset",syntax:"Function",arguments:[{arguments:[{arguments:[(0,i.P)(e)],elementType:"Function",name:"Members",syntax:"Property"},{elementType:"Function",name:"MemberValue",syntax:"Property",arguments:[{elementType:"Function",name:"CurrentMember",syntax:"Property",arguments:[(0,r.M)(e)]}]},{elementType:"Literal",value:"BDESC",type:"KEYWORD"}],elementType:"Function",name:"Order",syntax:"Function"},{elementType:"Literal",value:"0",type:"SCALAR"},{elementType:"Literal",value:`${e.numberOfRecentDates}`,type:"SCALAR"}]}))(e);case"custom":return e.mdx}};function S(e,t){const n=T(e,t);return n&&e.isExclusionFilter?{arguments:[C(e,t),n],elementType:"Function",name:"Except",syntax:"Function"}:n}},56722:(e,t,n)=>{n.d(t,{H:()=>s});var r=n(17967),i=n(9617),a=n(93481),o=n(19055);const s=({containingMode:e,token:t,selectProps:n,onContainingModeChange:s,onTokenChange:l})=>{const{formatMessage:d}=(0,a.useIntl)();return(0,r.BX)("div",{style:o.C.rootDiv,children:[(0,r.tZ)(i.Select,{"aria-label":"containing mode",value:e,onChange:s,style:o.C.select,options:["startsWith","doesNotStartWith","endsWith","doesNotEndWith","contains","doesNotContain"].map((e=>({value:e,label:d({id:`aui.filters.containingMode.${e}`})}))),...n}),(0,r.tZ)(i.Input,{"aria-label":"contained value",value:t,style:o.C.inputField,onChange:e=>l(e.target.value)})]})}},76068:(e,t,n)=>{n.d(t,{W:()=>s});var r=n(17967),i=n(9617),a=n(93481),o=n(19055);const s=({isBetween:e,upperToken:t,lowerToken:n,onIsBetweenChange:s,onLowerTokenChange:l,onUpperTokenChange:d,selectProps:c})=>{const{formatMessage:u}=(0,a.useIntl)();return(0,r.BX)("div",{style:o.C.rootDiv,children:[(0,r.tZ)(i.Select,{"aria-label":"caption range mode",value:e,onChange:s,style:o.C.select,options:[{value:!0,label:u({id:"aui.filters.alphabeticallyBetweenMode.isBetween"})},{value:!1,label:u({id:"aui.filters.alphabeticallyBetweenMode.isNotBetween"})}],...c}),(0,r.tZ)(i.Input,{"aria-label":"caption lower limit",style:o.C.inputField,value:n,onChange:e=>l(e.target.value)}),(0,r.tZ)("span",{children:u({id:"aui.and"})}),(0,r.tZ)(i.Input,{"aria-label":"caption upper limit",style:o.C.inputField,value:t,onChange:e=>d(e.target.value)})]})}},97456:(e,t,n)=>{n.d(t,{C:()=>s});var r=n(17967),i=n(9617),a=n(93481),o=n(19055);const s=({doesExist:e,onChange:t,selectProps:n})=>{const{formatMessage:s}=(0,a.useIntl)();return(0,r.tZ)(i.Select,{"aria-label":"existence value mode",value:e,style:o.C.select,options:[{value:!0,label:s({id:"aui.filters.existenceOfValue.exist"})},{value:!1,label:s({id:"aui.filters.existenceOfValue.doesNotExist"})}],onChange:t,...n})}},86276:(e,t,n)=>{n.d(t,{f:()=>l});var r=n(17967),i=n(9617),a=n(93481),o=n(19055),s=n(41507);const l=({lowerOrGreaterMode:e,token:t,selectProps:n,onLowerOrGreaterModeChange:l,onTokenChange:d})=>{const{formatMessage:c}=(0,a.useIntl)(),u=Object.keys(s.f).map((e=>{if(function(e){return e in s.f}(e))return{value:e,label:c({id:`aui.filters.alphabeticallyBeforeOrAfterMode.${e}`})};throw new Error(`${e} is not a valid LowerOrGreaterMode`)}));return(0,r.BX)("div",{style:o.C.rootDiv,children:[(0,r.tZ)(i.Select,{"aria-label":"lower or greater caption mode",value:e,onChange:l,options:u,style:o.C.select,...n}),(0,r.tZ)(i.Input,{"aria-label":"lower or greater caption limit",style:o.C.inputField,value:t,onChange:e=>d(e.target.value)})]})}},33656:(e,t,n)=>{n.d(t,{$:()=>s});var r=n(17967),i=n(9617),a=n(93481),o=n(19055);const s=({lowerOrGreaterMode:e,lowerOrGreaterLimit:t,onModeChange:n,onLimitChange:s,selectProps:l})=>{const{formatMessage:d}=(0,a.useIntl)();return(0,r.BX)("div",{style:o.C.rootDiv,children:[(0,r.tZ)(i.Select,{"aria-label":"lower or greater values mode",onChange:n,value:e,style:o.C.select,options:["Lower","LowerOrEqual","Greater","GreaterOrEqual","Equal","NotEqual"].map((e=>({value:e,label:d({id:`aui.filters.lowerOrGreaterMode.${e}`})}))),...l}),(0,r.tZ)(i.InputNumber,{"aria-label":"lower or greater value limit",style:o.C.inputField,value:t,type:"number",onChange:e=>{null!==e&&s(e)}})]})}},78270:(e,t,n)=>{n.d(t,{J:()=>s});var r=n(17967),i=n(9617),a=n(93481),o=n(19055);const s=({numberOfRecentDates:e,onNumberOfRecentDatesChange:t})=>{const{formatMessage:n}=(0,a.useIntl)();return(0,r.BX)("div",{style:o.C.rootDiv,children:[(0,r.tZ)("span",{children:n({id:"aui.filters.recentDates"})}),(0,r.tZ)(i.InputNumber,{"aria-label":"number-of-recent-dates",style:o.C.inputField,value:e,onChange:e=>{null!==e&&t(e)}})]})}},91379:(e,t,n)=>{n.d(t,{H:()=>s});var r=n(17967),i=n(9617),a=n(93481),o=n(19055);const s=({topBottomMode:e,scope:t,levelIndex:n,levels:s,onTopBottomModeChange:l,onScopeChange:d,selectProps:c})=>{const{formatMessage:u}=(0,a.useIntl)();return(0,r.BX)("div",{style:o.C.rootDiv,children:[(0,r.tZ)(i.Select,{"aria-label":"top to bottom mode",value:e,style:o.C.select,options:["TopCount","BottomCount"].map((e=>({value:e,label:u({id:`aui.filters.topBottomMode.${e}`})}))),onChange:l,...c}),n>1&&(0,r.BX)(i.Checkbox,{checked:"ofEachParent"===t,onChange:e=>d(e.target.checked?"ofEachParent":"overall"),children:[u({id:"aui.filters.in-each"})," ",s[n-1].caption]})]})}},19055:(e,t,n)=>{n.d(t,{C:()=>r});const r={rootDiv:{flexGrow:1,display:"inline-flex",gap:"6px",alignItems:"center"},select:{flexGrow:1},inputField:{width:"60px"}}},41507:(e,t,n)=>{n.d(t,{f:()=>r});const r={Lower:{operator:"<",label:"<"},LowerOrEqual:{operator:"<=",label:"â¤"},Greater:{operator:">",label:">"},GreaterOrEqual:{operator:">=",label:"â¥"},Equal:{operator:"=",label:"="},NotEqual:{operator:"<>",label:"â "}}},26581:(e,t,n)=>{n.d(t,{e:()=>s});var r=n(17967),i=n(9617),a=n(93481),o=n(19055);const s=({isBetween:e,lowerLimit:t,upperLimit:n,selectProps:s,onIsBetweenChange:l,onLowerLimitChange:d,onUpperLimitChange:c})=>{const{formatMessage:u}=(0,a.useIntl)();return(0,r.BX)("div",{style:o.C.rootDiv,children:[(0,r.tZ)(i.Select,{"aria-label":"value range mode",onChange:l,value:e,style:o.C.select,options:[{value:!0,label:u({id:"aui.filters.betweenMode.isBetween"})},{value:!1,label:u({id:"aui.filters.betweenMode.isNotBetween"})}],...s}),(0,r.tZ)(i.InputNumber,{"aria-label":"value lower limit",style:o.C.inputField,value:t,type:"number",onChange:e=>{null!==e&&d(e)}}),(0,r.tZ)("span",{children:u({id:"aui.and"})}),(0,r.tZ)(i.InputNumber,{"aria-label":"value upper limit",style:o.C.inputField,value:n,type:"number",onChange:e=>{null!==e&&c(e)}})]})}},6532:(e,t,n)=>{n.d(t,{E:()=>r});const r=e=>{const t={dimensionName:null,hierarchyName:null,isAdvanced:!1,levelIndex:0,isExclusionFilter:!1,limit:5,measureName:"contributors.COUNT",selectedMemberNamePaths:[],selectedMemberNamePathsHistory:[],expansion:{expandedMemberNamePaths:[],collapsedMemberNamePaths:[]},isAllMemberSelected:!1,topBottomMode:"TopCount",scope:"overall",type:"topBottomMembers",lowerOrGreaterMode:"Lower",lowerOrGreaterLimit:0,doesExist:!0,isBetween:!0,lowerLimit:10,upperLimit:100,containingMode:"contains",token:void 0,lowerToken:void 0,upperToken:void 0,startDate:void 0,endDate:void 0,isDateRange:!0,isRollingDate:!1,timePeriod:void 0,membersTextAreaValue:"",isMembersTextAreaVisible:!1,numberOfRecentDates:5};if(e){const{hierarchyCoordinates:n,levelIndex:r}=e;return{...t,...n,levelIndex:r}}return t}},58422:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(69673),i=n(53804),a=n(48364),o=n(6532);const s=(e,t)=>{switch(e.type){case"members":{if("Measures"===e.dimensionName)return{...(0,o.E)({hierarchyCoordinates:{dimensionName:"Measures",hierarchyName:"Measures"},levelIndex:0}),selectedMemberNamePaths:e.members};const n=(0,r._)(e,t),{levelIndex:i,expansion:s}=n.virtual?{levelIndex:e.members.length>0?e.members[0].length-1:0,expansion:{expandedMemberNamePaths:[],collapsedMemberNamePaths:[]}}:{levelIndex:n.slicing?0:1,expansion:{expandedMemberNamePaths:(0,a.W)(e.members,n.slicing),collapsedMemberNamePaths:[]}};return{...(0,o.E)({hierarchyCoordinates:{dimensionName:e.dimensionName,hierarchyName:e.hierarchyName},levelIndex:i}),isExclusionFilter:Boolean(e.isExclusionFilter),selectedMemberNamePaths:e.members,selectedMemberNamePathsHistory:e.members,expansion:s}}case"dateRange":const n=(0,r._)(e,t);return{...(0,o.E)({hierarchyCoordinates:{dimensionName:e.dimensionName,hierarchyName:e.hierarchyName},levelIndex:n.slicing?0:1}),type:"dateRange",isDateRange:e.startDate?.toLocaleDateString()!==e.endDate?.toLocaleDateString(),isExclusionFilter:Boolean(e.isExclusionFilter),startDate:e.startDate,endDate:e.endDate,isRollingDate:Boolean(e.isRollingDate)};case"timePeriodToDate":{const n=(0,r._)(e,t);return{...(0,o.E)({hierarchyCoordinates:{dimensionName:e.dimensionName,hierarchyName:e.hierarchyName},levelIndex:n.slicing?0:1}),type:"timePeriodToDate",timePeriod:e.timePeriod,isExclusionFilter:Boolean(e.isExclusionFilter)}}case"topBottomMembers":{const{dimensionName:n,hierarchyName:r,levelName:a}=e,s=(0,i.K)({cube:t,dimensionName:n,hierarchyName:r,levelName:a});return{...(0,o.E)({hierarchyCoordinates:{dimensionName:n,hierarchyName:r},levelIndex:s}),...e,isAdvanced:!0}}case"lowerOrGreaterValue":case"existenceOfValue":case"valuesRange":case"lowerOrGreaterCaptions":case"captionsContaining":case"captionsRange":case"recentDates":{const n=(0,i.K)({cube:t,dimensionName:e.dimensionName,hierarchyName:e.hierarchyName,levelName:e.levelName});return{...(0,o.E)({hierarchyCoordinates:{dimensionName:e.dimensionName,hierarchyName:e.hierarchyName},levelIndex:n}),...e,levelIndex:n,isAdvanced:!0}}case"custom":throw new Error("Cannot edit a custom filter.")}}},87714:(e,t,n)=>{n.d(t,{y:()=>a});var r=n(16372);const i=["user","dashboard","page","widget"];function a({filtersBySection:e,position:{sectionName:t,tileIndex:n},cube:a}){const o=i.indexOf(t);return[...i.slice(0,o).flatMap((t=>e[t]??[])),...n>-1&&e[t]?e[t].slice(0,n):[]].map((e=>(0,r.l)(e,a))).filter((e=>void 0!==e))}},19389:(e,t,n)=>{n.d(t,{E:()=>r});const r=(e,t)=>e.split(/\r?\n/).filter((e=>e)).map((e=>t?[e.trim()]:["AllMember",`${e.trim()}`]))},80352:(e,t,n)=>{n.d(t,{p:()=>r});const r=e=>"FILTER_IN_WIZARD"===e.type},8666:(e,t,n)=>{function r(e){return"SAVED_FILTER"===e.type&&void 0!==e.fetchFilter}n.d(t,{Q:()=>r})},49:(e,t,n)=>{n.d(t,{X:()=>k});var r=n(17967),i=n(77026),a=n(66029),o=n(93481),s=n(14690),l=n(34220),d=n(63342),c=n(9440),u=n(38785),m=n(69673),h=n(85578),p=n(67242),g=n(64682),y=n(96370),f=n(65611),v=n(9438),b=n(19078),x=n(82231),C=n(99438),T=n(40465),S=n(11315),w=n(91044),N=n(35235),F=n(46980),P=n(22549),M=n(28039),I=n(18235);const D=e=>e.children?.[0].children?.map((e=>e.path))||[],k=e=>{const{cubeName:t,dimensionName:n,hierarchyName:k,levelIndex:E,onMemberSelected:R,onMemberExpanded:Z,onSearchResultSelected:A,onMemberRemovedInTooltip:O,serverKey:B,selectedMemberNamePaths:L,expansion:{expandedMemberNamePaths:V,collapsedMemberNamePaths:$},hasCheckbox:K,isAllMemberSelected:W,filters:X,mdxInView:H}=e,G=(0,l.k)(B),_=(0,u.s)(G,t),j=(0,m._)({dimensionName:n,hierarchyName:k},_),q=Boolean(j&&j.slicing),U=j?Object.values(j.levels).length:0,{formatMessage:z}=(0,o.useIntl)(),Q=(0,a.useRef)((0,v.p)()),Y=(0,a.useRef)(V),[J]=(0,d.y)("smartFiltering.nonEmptyEvaluationMeasureName"),[ee]=(0,d.y)("smartFiltering.isEnabled"),[te]=(0,d.y)("smartFiltering.ignoredHierarchies"),ne=(0,a.useMemo)((()=>{if(V.length>0){const e=(0,i.differenceWith)(V,Y.current,i.isEqual).filter((e=>e.length>E));e.length>0&&Y.current.push(...e)}const e=(0,p.S)({dimensionName:n,hierarchyName:k,nonEmptyEvaluationMeasureSetting:J}),t=function({dimensionName:e,hierarchyName:t,cube:n,mdxInView:r,filters:i,isSmartFilteringEnabled:a,hierarchiesToIgnoreInSmartFilteringContext:o,nonEmptyEvaluationMeasureName:s}){const l=(0,m._)({dimensionName:e,hierarchyName:t},n),d={axes:[{elementType:"Axis",name:"ROWS",nonEmpty:!1,properties:(0,w.c)(l)?[N.G]:[],expression:{elementType:"Function",name:"Members",syntax:"Property",arguments:[(0,F.M)({dimensionName:e,hierarchyName:t})]}}],elementType:"Select",from:{cubeName:n.name,elementType:"From"},withClause:[]};return(0,P.b)(d,{cube:n,targetHierarchyCoordinates:{dimensionName:e,hierarchyName:t},nonEmptyEvaluationMeasureName:s,mdxInView:r,filters:i,isSmartFilteringEnabled:a,ignoredHierarchies:o})}({dimensionName:n,hierarchyName:k,cube:_,mdxInView:H,filters:X,isSmartFilteringEnabled:ee,hierarchiesToIgnoreInSmartFilteringContext:te,nonEmptyEvaluationMeasureName:e});return{mdx:(0,g.P)(t),updateMode:"once",ranges:{[s.axisIds.rows]:{from:0,to:1e3}}}}),[n,k,E,_,V,H,X,ee,te,J]),re=(0,c.b)({serverKey:B,queryId:Q.current,query:ne});(0,b.useCallOnLoadedAfterFirstProperRender)({onLoaded:e.onLoaded,queryResult:re});const ie=(0,a.useMemo)((()=>re.data?.axes[0].positions.map((e=>e[0]))),[re]),{debouncedSearchValue:ae,isSpinnerVisible:oe,isSearchActive:se,searchValue:le,isSearchLoading:de,handleSearchValueChanged:ce,searchResults:ue,error:me}=(0,I.s)({searchValue:e.searchValue,serverKey:B,cube:_,dimensionName:n,hierarchyName:k,levelName:Object.keys(j.levels)[E],filters:X,mdxInView:H,hierarchiesToIgnoreInSmartFilteringContext:te,allMembersQueryResult:re}),he=(0,a.useMemo)((()=>ie?(0,S.N)({members:ie,numberOfLevels:U,selectAllCaption:z({id:"aui.selectAll"}),isHierarchySlicing:q}):null),[U,q,z,ie]),pe=(0,a.useMemo)((()=>ue&&0!==ue.length?(0,S.N)({members:ue,numberOfLevels:U,selectAllCaption:z({id:"aui.selectAll"}),isHierarchySlicing:q}):null),[z,q,U,ue]),ge=ue&&0===ue.length||0===pe?.children?.[0].children?.length,ye=(0,a.useMemo)((()=>W?[[0]]:pe?(0,M.g)(pe,L):he?(0,M.g)(he,L):[]),[he,pe,L,W]),fe=(0,a.useMemo)((()=>(0,T.F)({membersTree:he,levelIndex:E,collapsedMemberNamePaths:$,expandedMemberNamePaths:V})),[he,E,$,V]),ve=(0,a.useCallback)((e=>{const t=(0,i.isEqual)(e,[[0]]);pe?A({searchTree:pe,previousSelectedPaths:ye,newSelectedPaths:t?D(pe):e,isHierarchySlicing:q}):he&&R({nodePaths:t?D(he):e,membersTree:he,isAllMemberSelected:t})}),[he,pe,R,A,ye,q]),be=(0,a.useCallback)(((e,t)=>{he&&Z({membersTree:he,expansionAction:t})}),[he,Z]),xe=(0,a.useMemo)((()=>z({id:"aui.search.members"},{hierarchyOrLevelName:k})),[z,k]),Ce=(0,a.useMemo)((()=>L.map((e=>{const t=[...ue??[],...ie??[]].find((({namePath:t})=>(0,C.m)(t,e)));return t?t.captionPath:e}))),[L,ue,ie]),Te=(0,b.useCurriedComponent)(x.B,{searchValue:ae!==le||de?void 0:le,selectedMemberNamePaths:L,selectedMemberCaptionPaths:Ce,onSelectionChanged:O}),Se=se?me:re.error,we=Se?new s.MdxError(Se):void 0;return(0,r.BX)("div",{css:{height:"100%",display:"flex",flexDirection:"column"},children:[!1!==e.isSearchVisible&&(0,r.BX)("div",{style:{display:"flex"},children:[(0,r.tZ)(y.h,{isLoading:oe,searchValue:le,searchPlaceholder:xe,onSearchValueChanged:ce,style:{flexShrink:1}}),e.searchInputAction]}),we?(0,r.tZ)(b.ErrorPlaceholder,{type:"error",message:we.stack??we.message}):ge?(0,r.BX)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,r.tZ)(h.IconSearchNotFound,{style:{height:54,width:83,marginBottom:25}}),(0,r.tZ)("span",{children:z({id:"aui.membersTree.searchResultsNotFound"})})]}):(0,r.tZ)(f.m,{Node:Te,hasCheckbox:K,isFullyExpanded:Boolean(pe),isSearchVisible:!1,isSelectable:!0,selectedPaths:ye,onSelectedPathsChange:ve,expandedPaths:fe,onExpandedPathsChange:be,value:pe?.children??he?.children??[],areEmptyFoldersExpandable:!0,isLoading:re.isLoading})]})}},82231:(e,t,n)=>{n.d(t,{B:()=>p});var r=n(17967),i=n(58736),a=n(77026),o=n(93481),s=n(54935),l=n(82154),d=n(19078),c=n(50083),u=n(14618),m=n(66029);const h=({selectedMemberNamePaths:e,selectedMemberCaptionPaths:t,onSelectionChanged:n})=>(0,r.BX)(m.Fragment,{children:[t.slice(0,15).map(((t,a)=>{const o=t.at(-1);return(0,r.BX)("div",{css:i.css`
                width: 100%;
                display: flex;
                justify-content: space-between;
                align-items: center;
              `,children:[(0,r.tZ)("span",{css:i.css`
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                `,children:o}),(0,r.tZ)(c.CloseCircleFilled,{css:i.css`
                  margin-left: 10px;
                `,onClick:()=>{!function(t){const r=(0,u.produce)(e,(e=>{e.splice(t,1)}));n(r)}(a)}})]},o)})),e.length>15&&(0,r.tZ)(c.EllipsisOutlined,{})]}),p=e=>{const{selectedMemberNamePaths:t,selectedMemberCaptionPaths:n,onSelectionChanged:c,data:u}=e,m=u[e.index],p=(0,s.Fg)(),{formatMessage:g}=(0,o.useIntl)();return m._isSelectAll?(0,r.BX)("div",{css:i.css`
        width: 100%;
        display: flex;
        justify-content: space-between;
      `,children:[(0,r.tZ)(l.Q,{...e,style:{...(0,a.omit)(e.style,["position","width"])}}),0===t.length?null:(0,r.BX)("div",{css:i.css`
            display: flex;
            margin-right: 10px;
          `,children:[(0,r.tZ)(d.Tooltip,{trigger:["hover"],placement:"bottom",title:(0,r.tZ)(h,{selectedMemberNamePaths:t,selectedMemberCaptionPaths:n,onSelectionChanged:c}),children:(0,r.tZ)("span",{css:i.css`
                margin-right: 5px;
              `,children:g({id:"aui.filters.selected"},{numberOfMembers:t.length})})}),(0,r.tZ)("span",{css:i.css`
              color: ${p.primaryColor};
              cursor: pointer;
            `,onClick:()=>{c([])},children:g({id:"aui.membersTree.clearAll"})})]})]}):(0,r.tZ)(l.Q,{...e})}},31883:(e,t,n)=>{n.d(t,{$:()=>I});var r=n(17967),i=n(58736),a=n(66029),o=n(93481),s=n(14690),l=n(34220),d=n(38785),c=n(69673),u=n(85578),m=n(96370),h=n(65611),p=n(19078),g=n(9617);const y=({style:e,isDisabled:t,hierarchy:n,selectedLevelName:i,onLevelSelected:a})=>{const o=Object.values(n.levels),s=(n.slicing?o:o.slice(1)).map((e=>({label:e.caption,value:e.name})));return(0,r.tZ)(g.Select,{style:e,disabled:t,options:s,value:i,onChange:a})};var f=n(82231),v=n(40465),b=n(11315),x=n(18235),C=n(77026),T=n(36249),S=n(99438),w=n(28039),N=n(40503);const F=[[0]];function P(e){return e.children?e.children.flatMap(P):[e.path]}function M(e){return e.children?e.children.flatMap(M):[e.namePath]}const I=e=>{const{cubeName:t,dimensionName:n,hierarchyName:g,levelIndex:I,onLevelIndexChanged:D,serverKey:k,selectedMemberNamePaths:E,onSelectionChanged:R,onLoaded:Z,hasLevelChooser:A=!0,selectedMemberNamePathsHistory:O,searchInputAction:B,filters:L}=e,V=(0,l.k)(k),$=(0,d.s)(V,t),K=(0,c._)({dimensionName:n,hierarchyName:g},$),W=Boolean(K&&K.slicing),X=Object.keys(K.levels),H=X.length,G=X[I],{formatMessage:_}=(0,o.useIntl)();(0,a.useEffect)((()=>{Z?.()}),[Z]);const{searchValue:j,debouncedSearchValue:q,isSearchActive:U,isSearchLoading:z,searchResults:Q,handleSearchValueChanged:Y,error:J}=(0,x.s)({serverKey:k,cube:$,dimensionName:n,hierarchyName:g,levelName:G,filters:L}),ee=(0,a.useMemo)((()=>(0,b.N)({members:U?Q||[]:O.map((e=>({namePath:e}))),numberOfLevels:H,selectAllCaption:_({id:"aui.selectAll"}),isHierarchySlicing:W,areParentMembersDisabled:!0})),[_,W,H,Q,U,O]),te=0===ee?.children?.[0].children?.length,ne=(0,a.useMemo)((()=>_({id:"aui.search.members"},{hierarchyOrLevelName:G})),[_,G]),[re,ie,ae]=function({membersTree:e,isSearchActive:t,onSelectionChanged:n,isHierarchySlicing:r,selectedMemberNamePaths:i}){const o=(0,a.useMemo)((()=>M(e)),[e]),s=(0,a.useMemo)((()=>o.length>0&&o.every((e=>i.some((t=>(0,S.m)(e,t)))))),[o,i]),l=(0,a.useMemo)((()=>(0,w.g)(e,i)),[e,i]),d=(0,a.useCallback)((a=>{const[o,s]=[a,l].map((t=>{const n=t.flatMap((t=>P((0,T.M)(e,t))));return(0,C.uniqWith)(n,C.isEqual)})),d=t?{type:"memberSelectedDuringSearch",previousSelectedPaths:s,isHierarchySlicing:r,searchTree:e,newSelectedPaths:(0,C.isEqual)(a,F)?[...F,...o]:a}:{type:"memberSelected",membersTree:e,newSelectedPaths:o},c=(0,N.G)({action:d,previousSelectedMemberNamePaths:i});n(c.filter((e=>0!==e.length)))}),[t,n,l,r,e,i]);return[l,d,s]}({membersTree:ee,isSearchActive:U,onSelectionChanged:R,isHierarchySlicing:W,selectedMemberNamePaths:E,selectedMemberNamePathsHistory:O}),oe=(0,a.useMemo)((()=>(0,v.F)({membersTree:ee,levelIndex:I,collapsedMemberNamePaths:[],expandedMemberNamePaths:[]})),[ee,I]),se=O.length>0,le=(0,p.useCurriedComponent)(f.B,{selectedMemberNamePaths:E,selectedMemberCaptionPaths:E,onSelectionChanged:R,isExpandable:!1}),de=J?new s.MdxError(J):void 0;return(0,r.BX)("div",{css:i.css`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
      `,children:[(0,r.BX)("div",{css:i.css`
          display: flex;
          width: 100%;
          height: 28px;
          margin-bottom: 8px;
        `,children:[A&&(0,r.tZ)(p.Tooltip,{trigger:E.length>0?["hover"]:[],title:(0,r.BX)("div",{children:[_({id:"aui.filters.virtualHierarchyHints.hierarchy"},{hierarchyName:g}),(0,r.tZ)("br",{}),_({id:"aui.filters.virtualHierarchyHints.levels"})]}),children:(0,r.tZ)("div",{children:(0,r.tZ)(y,{style:{width:100,marginRight:4},hierarchy:K,isDisabled:E.length>0,selectedLevelName:G,onLevelSelected:e=>{if(!D)throw new Error("<VirtualHierarchyMembersTree /> did not receive an `onLevelIndexChanged` callback. Either pass a callback or explicitly set `hasLevelChooser: false` to remove the level chooser.");const t=K.levels[e].index;D(t)}})})}),(0,r.tZ)(m.h,{searchValue:j,onSearchValueChanged:Y,searchPlaceholder:ne,style:{marginBottom:0,flexGrow:1,width:"unset"}}),B]}),U||se?(0,r.tZ)(p.Spinner,{isLoading:z,tip:z?_({id:"aui.search.searchLoadingTip"},{searchValue:q}):void 0,children:de?(0,r.tZ)(p.ErrorPlaceholder,{type:"error",message:de.stack??de.message}):te?(0,r.BX)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,r.tZ)(u.IconSearchNotFound,{style:{height:54,width:83,marginBottom:25}}),(0,r.tZ)("span",{children:_({id:"aui.membersTree.searchResultsNotFound"})})]}):(0,r.tZ)(h.m,{Node:le,hasCheckbox:e=>e._isSelectAll||e.namePath.length===I+1,isSearchVisible:!1,isSelectable:!0,selectedPaths:ae?F:re,onSelectedPathsChange:ie,expandedPaths:oe,value:ee.children})}):(0,r.tZ)(p.Text,{small:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1,textAlign:"center"},children:(0,r.BX)("div",{children:[_({id:"aui.filters.virtualHierarchyHints.hierarchy"},{hierarchyName:g}),(0,r.tZ)("br",{}),_({id:"aui.filters.virtualHierarchyHints.members"}),(0,r.tZ)("br",{}),_({id:"aui.filters.virtualHierarchyHints.search"})]})})]})}},99438:(e,t,n)=>{function r(e,t){return e.length===t.length&&e.every(((e,n)=>e===t[n]))}n.d(t,{m:()=>r})},40465:(e,t,n)=>{n.d(t,{F:()=>a});var r=n(15326),i=n(99438);const a=({membersTree:e,levelIndex:t,collapsedMemberNamePaths:n,expandedMemberNamePaths:a})=>{if(!e)return[];const o=[];return(0,r.f)(e,{forEachNode:e=>{e.namePath.length<=t?n.some((t=>(0,i.m)(t,e.namePath)))||o.push(e.path):a.some((t=>(0,i.m)(t,e.namePath)))&&o.push(e.path)}}),o}},65773:(e,t,n)=>{n.d(t,{j:()=>i});var r=n(36249);function i(e,t){return e.map((e=>(0,r.M)(t,e).namePath))}},11315:(e,t,n)=>{n.d(t,{N:()=>i});var r=n(36249);function i({members:e,selectAllCaption:t,isHierarchySlicing:n,areParentMembersDisabled:i,numberOfLevels:a}){const o={caption:"root",captionPath:[],isFolder:!0,namePath:[],children:[{caption:t,captionPath:[],isFolder:!0,namePath:[],children:[],path:[0],_isSelectAll:!0}],path:[]};let s=[0];return e.forEach((e=>{const{namePath:t}=e;if(n&&0===t.length||1===t.length&&"AllMember"===t[0])return;const l=function(e,t,n){let i=[0];for(let a=1;a<t.length+1;a++){const o=t.slice(0,a),s=(0,r.M)(e,o);if(s.namePath.length>=n.length||s.namePath.at(-1)!==n[s.namePath.length-1])break;i=o}return i}(o,s,t);s=function({member:e,tree:t,pathToFirstCommonAncestor:n,isHierarchySlicing:i,areParentMembersDisabled:a,numberOfLevels:o}){const{namePath:s,captionPath:l,properties:d}=e,c=(0,r.M)(t,n);if(!c||c.namePath.length>=s.length)return n;const u=s.length-c.namePath.length-(i||0!==c.namePath.length?0:1);let m=c;for(let e=0;e<u;e++){m.children||(m.children=[]),a&&m.path.length>1&&(m.isDisabled=!0);const t=s.length+e+1-u,n=s.slice(0,t),r=l?.slice(0,t),i="number"==typeof d?.CHILDREN_CARDINALITY?d.CHILDREN_CARDINALITY>0:n.length<o,c={captionPath:r??[],namePath:n,caption:r?.at(-1)??n.at(-1),path:[...m.path,m.children.length]};i&&(c.isFolder=!0),m.children.push(c),m=c}return m.path}({member:e,tree:o,isHierarchySlicing:n,pathToFirstCommonAncestor:l,areParentMembersDisabled:i,numberOfLevels:a})})),o}},28039:(e,t,n)=>{n.d(t,{g:()=>a});var r=n(77026),i=n(15326);const a=(e,t)=>{const n=[],a=(0,r.cloneDeep)(t);return(0,i.f)(e,{forEachNode:e=>{if(a.length>0){const t=a.findIndex((t=>e.namePath.length===t.length&&e.namePath.every(((e,n)=>e===t[n]))));-1!==t&&(n.push(e.path),a.splice(t,1))}}}),n}},48364:(e,t,n)=>{n.d(t,{W:()=>i});var r=n(86722);function i(e,t){const n=(0,r.k)(e);return t?n:n.filter((e=>e.length>1))}},40503:(e,t,n)=>{n.d(t,{G:()=>s});var r=n(77026),i=n(32501),a=n(99438),o=n(65773);function s({action:e,previousSelectedMemberNamePaths:t}){if("memberSelected"===e.type){const{membersTree:t,newSelectedPaths:n}=e;return(0,o.j)((0,i.D)(n),t)}const{newSelectedPaths:n,previousSelectedPaths:s,searchTree:l}=e,d=(0,o.j)(n,l),c=(0,o.j)(s,l),u=(0,r.differenceWith)(c,d,a.m),m=(0,r.uniqWith)([...t,...d],a.m).filter((e=>u.every((t=>!(0,a.m)(t,e)))));return(0,i.D)(m)}},3018:(e,t,n)=>{n.d(t,{Mg:()=>u,cE:()=>d,wo:()=>c});var r=n(14618),i=n(77026),a=n(36249),o=n(99438),s=n(48364),l=n(40503);const d=(e,t)=>{switch(t.type){case"memberSelected":case"memberSelectedDuringSearch":{const n=(0,l.G)({action:t,previousSelectedMemberNamePaths:e.selectedMemberNamePaths}),r="memberSelected"===t.type?e.expansion:{...e.expansion,expandedMemberNamePaths:(0,i.uniqWith)([...e.expansion.expandedMemberNamePaths,...(0,s.W)(n,t.isHierarchySlicing)],o.m)};return{...e,isAllMemberSelected:!1,selectedMemberNamePaths:n,expansion:r}}case"memberExpanded":{const{membersTree:n,expansionAction:{path:i,type:s}}=t;return(0,r.produce)(e,(t=>{const{namePath:r}=(0,a.M)(n,i);switch(s){case"expand":if(i.length<=e.levelIndex){const e=t.expansion.collapsedMemberNamePaths.findIndex((e=>(0,o.m)(r,e)));t.expansion.collapsedMemberNamePaths.splice(e,1)}else t.expansion.expandedMemberNamePaths.push(r);break;case"collapse":if(i.length<=e.levelIndex)t.expansion.collapsedMemberNamePaths.push(r);else{const e=t.expansion.expandedMemberNamePaths.findIndex((e=>(0,o.m)(r,e)));t.expansion.expandedMemberNamePaths.splice(e,1)}}return t}))}case"memberRemovedInTooltip":{const{selectedMemberNamePaths:n}=t;return{...e,selectedMemberNamePaths:n}}default:return e}},c=(e,t,n)=>({type:"memberSelected",membersTree:e,newSelectedPaths:t,isAllMemberSelected:n}),u=({searchTree:e,previousSelectedPaths:t,newSelectedPaths:n,isHierarchySlicing:r})=>({type:"memberSelectedDuringSearch",previousSelectedPaths:t,isHierarchySlicing:r,searchTree:e,newSelectedPaths:n})},18235:(e,t,n)=>{n.d(t,{s:()=>b});var r=n(77026),i=n(66029),a=n(63342),o=n(47478),s=n(9440),l=n(69673),d=n(67242),c=n(4220),u=n(27037),m=n(64682),h=n(9438);const p=500,g=1e3,y=300,f=(e,t)=>{switch(t.type){case"searched":return{...e,uncontrolledSearchValue:t.searchValue,isSpinnerVisible:!1};case"cleared":return{...e,uncontrolledSearchValue:"",debouncedSearchValue:"",isSpinnerVisible:!1};case"debounced":return"query"===t.debounceType?{...e,debouncedSearchValue:t.searchValue}:{...e,isSpinnerVisible:!0};case"resultsReceived":return{...e,isSpinnerVisible:!1};default:return e}},v={debouncedSearchValue:"",isSpinnerVisible:!1,uncontrolledSearchValue:""};function b({serverKey:e,cube:t,dimensionName:n,hierarchyName:b,levelName:x,filters:C,mdxInView:T,hierarchiesToIgnoreInSmartFilteringContext:S,searchValue:w,allMembersQueryResult:N}){const[{debouncedSearchValue:F,isSpinnerVisible:P,uncontrolledSearchValue:M},I]=(0,i.useReducer)(f,v),D=w??M,k=N?.data?.axes[0].range,E=N&&(!k||k.entireAxis),R=(0,i.useMemo)((()=>(0,r.debounce)((e=>{I({type:"debounced",debounceType:"query",searchValue:e})}),E?y:g)),[I,E]),Z=(0,i.useMemo)((()=>E?void 0:(0,r.debounce)((e=>{I({type:"debounced",debounceType:"spinner",searchValue:e})}),p)),[I,E]),A=(0,i.useMemo)((()=>N?.data?.axes[0].positions.map((e=>e[0]))),[N]),O=function({searchValue:e,membersInAllMembersQueryResult:t}){const[n]=(0,a.y)("search.maxResults"),r=(0,i.useMemo)((()=>{if(e&&""!==e.trim())return(0,o.y)(t,e,{keys:["captionPath"],getFn:e=>e.captionPath.at(-1),threshold:.05,shouldSort:!1})}),[e,t]);return r?.slice(0,n)}({searchValue:E?F:void 0,membersInAllMembersQueryResult:A||[]}),{searchResults:B,isLoading:L,error:V}=function({serverKey:e,cube:t,dimensionName:n,hierarchyName:r,levelName:o,filters:p,mdxInView:g,hierarchiesToIgnoreInSmartFilteringContext:y,searchValue:f}){const[v]=(0,a.y)("search.maxResults"),[b]=(0,a.y)("smartFiltering.isEnabled"),[x]=(0,a.y)("smartFiltering.nonEmptyEvaluationMeasureName"),C=(0,d.S)({dimensionName:n,hierarchyName:r,nonEmptyEvaluationMeasureSetting:x}),T=(0,i.useRef)((0,h.p)()),S=(0,l._)({dimensionName:n,hierarchyName:r},t).virtual,w=(0,i.useMemo)((()=>{if(void 0===f||""===f.trim())return;const e=S?(0,c.L)({dimensionName:n,hierarchyName:r,levelName:o,searchValue:f,cube:t,filters:p,isSmartFilteringEnabled:b,hierarchiesToIgnoreInSmartFilteringContext:y}):(0,u.k)({dimensionName:n,hierarchyName:r,searchValue:f,cube:t,mdxInView:g,filters:p,isSmartFilteringEnabled:b,hierarchiesToIgnoreInSmartFilteringContext:y,nonEmptyEvaluationMeasureName:C,maxNumberOfSearchResults:v});return(0,m.P)(e)}),[n,r,o,S,f,t,g,p,b,y,C,v]),N=(0,i.useMemo)((()=>w?{mdx:w,updateMode:"once"}:void 0),[w]),F=(0,s.b)({serverKey:e,queryId:N?T.current:void 0,query:N});return{searchResults:(0,i.useMemo)((()=>{if((0,l._)({dimensionName:n,hierarchyName:r},t).virtual){if(!F?.data)return[];if(1!==F.data.cells.length)throw new Error("The query that fetches members of a virtual hierarchy must return a single cell, whose value is an array of members.");return F.data.cells[0].value.map((e=>({namePath:e,captionPath:e,properties:{}})))}return F?.data?.axes[0].positions.map((e=>e[0]))}),[F,t,n,r]),isLoading:F.isLoading,error:F.error}}({searchValue:E?void 0:F,serverKey:e,cube:t,dimensionName:n,hierarchyName:b,levelName:x,filters:C,mdxInView:T,hierarchiesToIgnoreInSmartFilteringContext:S}),$=""!==F.trim();return(0,i.useEffect)((()=>{L||I({type:"resultsReceived"})}),[I,L]),(0,i.useEffect)((()=>{void 0===D||""===D.trim()?(R.cancel(),Z?.cancel(),I({type:"cleared"})):(Z?.(D),R(D))}),[D,R,Z]),{searchValue:D,debouncedSearchValue:F,isSearchActive:$,isSpinnerVisible:!E&&P,isSearchLoading:!E&&L,handleSearchValueChanged:e=>I({type:"searched",searchValue:e}),searchResults:E?O:B,error:E?void 0:V}}},33575:(e,t,n)=>{n.d(t,{u:()=>I});var r=n(17967),i=n(14618),a=n(77026),o=n(69248),s=n(14947),l=n(12880),d=n(50083),c=n(66029),u=n(9617),m=n(93481),h=n(54935);const p={width:80},g={margin:0,height:3,width:"100%"},y={minHeight:"unset"},f=e=>{const t=(0,h.Fg)(),n=(0,c.useMemo)((()=>({color:t.errorColor})),[t]),{formatMessage:i}=(0,m.useIntl)();return(0,r.BX)(u.Select,{value:e.currentPermission,style:p,onSelect:t=>{switch(t){case"editor":e.onPermissionChanged(e.index,"editor");break;case"reader":e.onPermissionChanged(e.index,"reader");break;case"remove":e.onPermissionRemoved&&e.onPermissionRemoved(e.index)}},disabled:e.isDisabled,children:[(0,r.tZ)(u.Select.Option,{value:"editor",children:i({id:"aui.contentTree.editor"})}),(0,r.tZ)(u.Select.Option,{value:"reader",children:i({id:"aui.contentTree.reader"})}),(0,r.tZ)(u.Select.Option,{value:"divider",disabled:!0,style:y,children:(0,r.tZ)(u.Divider,{style:g})}),e.onPermissionRemoved?(0,r.tZ)(u.Select.Option,{value:"remove",style:n,children:i({id:"aui.remove"})}):null]})},v={fontSize:18,paddingRight:12},b={display:"flex",justifyContent:"space-between",marginTop:4},x={display:"flex",alignItems:"center"},C=e=>{const t=(0,o.u)(),n=(0,s.s)(),i=(0,c.useMemo)((()=>t?.includes(e.userName)),[t,e.userName]),a=(0,c.useMemo)((()=>n?.includes(e.userName)),[n,e.userName]);let l=d.QuestionCircleOutlined;return i?l=d.UserOutlined:a&&(l=d.TeamOutlined),(0,r.BX)("div",{style:b,children:[(0,r.BX)("div",{style:x,children:[(0,r.tZ)(l,{style:v}),e.userName]}),(0,r.tZ)(f,{currentPermission:e.currentPermission,index:e.index,onPermissionChanged:e.onPermissionChanged,onPermissionRemoved:e.onPermissionRemoved,isDisabled:e.isDisabled})]})},T={display:"flex",justifyContent:"space-between",marginBottom:14},S={width:80},w={flexGrow:1,marginRight:8},N={display:"flex",alignItems:"baseline"},F={paddingRight:4},P={paddingRight:2},M=e=>{let t=null;const{formatMessage:n}=(0,m.useIntl)(),{message:i}=u.App.useApp(),o=(0,l.a)().username,s=e.usersWithoutPermission.map((e=>(0,r.tZ)(u.Select.Option,{value:e,children:(0,r.BX)("div",{style:N,children:[(0,r.tZ)(d.UserOutlined,{style:F}),e]})},e))),h=e.userRolesWithoutPermission.map((e=>(0,r.tZ)(u.Select.Option,{value:e,children:(0,r.BX)("div",{style:N,children:[(0,r.tZ)(d.TeamOutlined,{style:P}),e]})},e))),[p,g]=(0,c.useState)("reader");return(0,r.BX)("div",{style:T,children:[(0,r.BX)(u.Select,{mode:"tags",ref:e=>{t=e},style:w,placeholder:n({id:"aui.contentTree.addPeopleAndGroups"}),onSelect:r=>{r.toLowerCase()===o?.toLowerCase()?i.error({content:n({id:"aui.contentTree.error.noGrantingSelfPermission"})}):e.userNamesWithPermission.includes(r.toLowerCase())?i.error({content:n({id:"aui.contentTree.error.userHasPermissions"})}):e.onPermissionGranted(r,p),t&&t.blur()},onDeselect:t=>{const n=(0,a.find)(e.usersWithPendingPermission,(e=>t===e.userName))?.index;void 0!==n&&e.onPermissionRemoved(n)},value:(0,a.map)(e.usersWithPendingPermission,(({userName:e})=>e)),suffixIcon:(0,r.tZ)(u.Select,{placeholder:"choose",children:s}),disabled:e.isDisabled,children:[s,h.length>0?(0,r.tZ)(u.Select.OptGroup,{label:"Select Group",children:h}):null]}),(0,r.BX)(u.Select,{style:S,value:p,onSelect:t=>{g(t),e.onPendingPermissionChanged(t)},disabled:e.isDisabled,children:[(0,r.tZ)(u.Select.Option,{value:"reader",children:n({id:"aui.contentTree.reader"})}),(0,r.tZ)(u.Select.Option,{value:"editor",children:n({id:"aui.contentTree.editor"})})]})]})},I=({onPermissionsChange:e,permissions:t,isDisabled:n})=>{const d=n=>{const r=((e,t)=>{if("permissionGranted"===t.type)return(0,i.produce)(e,(e=>(0,a.sortBy)([...e,{userName:t.payload.userName,isPending:!0,type:t.payload.type}],(e=>e.userName.toLowerCase()))));if("pendingPermissionChanged"===t.type)return(0,i.produce)(e,(e=>{(0,a.forEach)(e,(e=>{e.isPending&&(e.type=t.payload.type)}))}));if(!(t.payload.index>=0&&t.payload.index<e.length))throw new Error(`Permission index out of bound: ${t.payload.index}. There are only ${e.length} permission rows.`);switch(t.type){case"permissionChanged":return(0,i.produce)(e,(e=>{e[t.payload.index].type=t.payload.updatedPermission}));case"permissionRemoved":return(0,i.produce)(e,(e=>{e.splice(t.payload.index,1)}));default:throw new Error(`Unsupported action type: "${t.type}". Supported action types are ["permissionChanged", "permissionRemoved"].`)}})(t,n);e(r)},c=(e,t)=>{d({type:"permissionChanged",payload:{index:e,updatedPermission:t}})},u=e=>{d({type:"permissionRemoved",payload:{index:e}})},m=(0,o.u)(),h=(0,s.s)(),p=(0,a.map)(t,(e=>e.userName.toLowerCase())),g=(0,l.a)().username;return(0,r.BX)("div",{children:[(0,r.tZ)(M,{onPermissionGranted:(e,t)=>{d({type:"permissionGranted",payload:{userName:e,type:t}})},onPendingPermissionChanged:e=>{d({type:"pendingPermissionChanged",payload:{type:e}})},onPermissionRemoved:u,usersWithPendingPermission:t.map((({userName:e,isPending:t},n)=>({userName:e,index:n,isPending:t}))).filter((({isPending:e})=>e)),usersWithoutPermission:m?.filter((e=>!p.includes(e.toLowerCase())))||[],userRolesWithoutPermission:h?.filter((e=>!p.includes(e.toLowerCase())))||[],userNamesWithPermission:p,isDisabled:n}),t.map((({userName:e,type:t,isPending:i},a)=>e.toLowerCase()===g?.toLowerCase()||i?null:(0,r.tZ)(C,{currentPermission:t,index:a,userName:e,onPermissionChanged:c,onPermissionRemoved:u,isDisabled:n},a)))]})}},16108:(e,t,n)=>{n.d(t,{V:()=>y});var r=n(17967),i=n(66029),a=n(93481),o=n(12880),s=n(19078),l=n(50083),d=n(9617),c=n(63436);const u=({id:e,isFolder:t,pathToParentFolder:n})=>{const{formatMessage:i}=(0,a.useIntl)(),{message:o}=d.App.useApp();return(0,r.BX)(d.Button,{onClick:async()=>{try{await navigator.clipboard.writeText(t&&n?`${window.location.origin}${window.location.pathname}#/folder/${0===n.length?"":`${n.join("/")}/`}${e}`:`${window.location.origin}${window.location.pathname}#/dashboard/${e}`)}catch(e){const{message:t}=(0,c.b)(e);throw new Error(`Unable to write to the clipboard: ${t}`)}o.success({content:i({id:"aui.copyURLSuccess"})})},children:[(0,r.tZ)(l.LinkOutlined,{}),i({id:"aui.copyLink"})]})};var m=n(33575),h=n(18125),p=n(69476),g=n(92563);const y=({isVisible:e,id:t,entry:n,pathToParentFolder:l,onCancel:d,onSubmit:c,isFolder:y,name:f,contentType:v})=>{const{formatMessage:b}=(0,a.useIntl)(),{username:x}=(0,o.a)(),C=(0,i.useMemo)((()=>(0,p.Z)({owners:n.owners,readers:n.readers,currentUserName:x})),[n,x]),[T,S]=(0,i.useState)(C),w=function({id:e,pathToParentFolder:t,isFolder:n,contentType:r}){const i=(0,g.Ct)();return async({owners:a,readers:o})=>{e&&t&&(n?await i.updateFolderPermissions({id:e,pathToParentFolder:t,type:r,owners:a,readers:o}):await i.updateFilePermissions({id:e,pathToParentFolder:t,type:r,owners:a,readers:o}),await i.loadTree(r))}}({id:t,pathToParentFolder:l,isFolder:y,contentType:v}),[N,F]=(0,i.useState)(!1),P=b({id:"aui.shareContent"},{contentName:f??b({id:"aui.contentType"},{contentType:v})}),M="dashboard"===v;return(0,r.tZ)(s.Modal,{destroyOnClose:!0,extra:M&&(0,r.tZ)(u,{id:t,pathToParentFolder:l,isFolder:y}),okText:b({id:"aui.save"}),onOk:async()=>{if(!N){F(!0);const{owners:e,readers:t}=(0,h.X)(T,x);await w({owners:e,readers:t}),F(!1),c()}},onCancel:()=>{N||d()},cancelButtonProps:{disabled:N},title:P,open:e,children:(0,r.tZ)(m.u,{permissions:T,onPermissionsChange:S})})}},18125:(e,t,n)=>{function r(e,t){const n=[t],r=[t];return e.forEach((({type:e,userName:t})=>{r.push(t),"editor"===e&&n.push(t)})),{owners:n,readers:r}}n.d(t,{X:()=>r})},69476:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(77026);function i({currentUserName:e,owners:t,readers:n}){const i=n.filter((n=>n!==e&&!t.includes(n))).map((e=>({userName:e,type:"reader"}))),a=t.filter((t=>t!==e)).map((e=>({userName:e,type:"editor"})));return(0,r.sortBy)([...i,...a],(e=>e.userName.toLowerCase()))}},24051:(e,t,n)=>{n.d(t,{Q:()=>a});var r=n(75093),i=n(69476);function a(e){const{owners:t,readers:n}=(0,r.s)(e);return(0,i.Z)({currentUserName:e.currentUserName,owners:t,readers:n})}},60021:(e,t,n)=>{n.d(t,{s:()=>i});class r extends Error{pluginType;pluginKey;constructor(e,t,n){super(`No plugin of type "${e}" was found for the key "${t}" in the registry. Registered plugins of this type are: ${JSON.stringify(n)}. `),this.pluginType=e,this.pluginKey=t}}const i=(e,t,n)=>{const i=n[t];if(void 0===i)throw new r(e,t,Object.keys(n));return i}},82154:(e,t,n)=>{n.d(t,{Q:()=>p});var r=n(17967),i=n(50083),a=n(58736),o=n(9617),s=n(77026),l=n(66029),d=n(83794),c=n(68680),u=n(54935),m=n(19078);const{Text:h}=o.Typography,p=({caretStyle:e={fontSize:12},onClick:t=s.noop,...n})=>{const p=(0,u.Fg)(),g=n.data[n.index],y=g.caption??n.getDefaultCaption(g),f=(0,l.useRef)(null),v={...e,padding:5,margin:-5,marginRight:0},[b,x]=(0,l.useState)(y),[C,T]=(0,l.useState)(!1),[S,w]=(0,l.useState)(!1),[,N]=(0,d.useDrag)({type:g.dragItem?.type??"UNKNOWN_DRAG_ITEM",canDrag:()=>!g.isDisabled&&void 0!==g.dragItem,collect:e=>{e.isDragging()&&w(!1)},item:()=>g.dragItem??null}),F=(0,l.useRef)(),P=()=>{x(y),n.onEditCanceled()},M=e=>{n.onExpandToggled(g,!n.isExpanded),e.stopPropagation()},I={display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textDecoration:n.isFocused?"underline":"none",...n.isSelected&&n.selectionStyle,...!0!==g.isDisabled&&!1!==g.isActionable&&{"span, span.ant-typography":n.isSelected&&n.selectionStyle,":hover":{"span:not(.ant-checkbox-checked) > span":n.hoverStyle}}},D=(0,r.BX)("div",{ref:N,css:I,onClick:e=>{g.isDisabled||n.isEdited||n.isPopoverOpen||t(g,e)},style:n.style,children:[g.isFolder&&n.isExpandable&&(n.isExpanded?(0,r.tZ)(i.CaretDownOutlined,{onClick:M,style:{...v,color:p.grayScale[7]}}):(0,r.tZ)(i.CaretRightOutlined,{onClick:M,style:{...v,color:p.grayScale[5]}})),n.Icon&&(0,r.tZ)("div",{css:{display:"flex",alignItems:"center",width:17},children:(0,r.tZ)(n.Icon,{node:g,style:{marginRight:5}})}),n.hasCheckbox&&(0,r.tZ)(o.Checkbox,{indeterminate:!n.isSelected&&n.hasSelectedChildren,checked:n.isSelected,style:{marginRight:8},value:y}),!n.searchValue||n.isEdited||g._isSelectAll?(0,r.tZ)(m.PositionedPopover,{title:n.popoverTitle,content:n.popoverContent,coordinates:{...(0,m.getPopoverCoordinates)(f.current,n.popoverInnerHeight??0),height:void 0},open:n.isPopoverOpen,children:(0,r.tZ)(m.Tooltip,{trigger:"hover",title:n.tooltip??y,placement:"right",open:S,children:(0,r.tZ)("span",{ref:f,onMouseEnter:()=>{const{scrollWidth:e,offsetWidth:t}=f.current??{scrollWidth:0,offsetWidth:0},r=e>t;r?w(!!r&&void 0):n.tooltip?(w(!1),F.current=setTimeout((()=>{w(void 0)}),1e3*(n.tooltipDelay??0))):w(!1)},onMouseLeave:()=>{clearTimeout(F.current)},css:a.css`
                  overflow-x: hidden;
                  white-space: nowrap;
                  text-overflow: ellipsis;
                `,children:(0,r.tZ)(h,{disabled:g.isDisabled,children:n.isEdited?(0,r.tZ)(o.Input,{value:b,onChange:e=>{x(e.target.value)},autoFocus:!0,onFocus:e=>{e.target.select(),n.onEditStarted(g.path)},onBlur:P,onKeyUp:e=>{"Enter"===e.key?n.onEditEnded(g.path,b):"Escape"===e.key&&P()},style:{border:"none",padding:0}}):y})})})}):(0,r.tZ)(c.d,{caption:y,searchValue:n.searchValue,isDisabled:g.isDisabled})]}),{contextMenuItems:k}=n;return k?(0,r.tZ)(m.Dropdown,{destroyPopupOnHide:!0,trigger:["contextMenu"],open:C,onOpenChange:T,menu:{items:k,onClick:({domEvent:e})=>{e.isDefaultPrevented()||T(!1)}},children:D}):D}},65611:(e,t,n)=>{n.d(t,{m:()=>H});var r=n(17967),i=n(77026),a=n(66029),o=n(93481),s=n(43292),l=n(63342),d=n(85578),c=n(47478),u=n(54935),m=n(59401),h=n(19078),p=n(82154);const g=(0,a.createContext)(null),y=g.Provider;var f=n(91811);const v=(e,t)=>{if(e.length<=t.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0};var b=n(30980);const x=e=>{const{Node:t,...n}=e,i=e.data[e.index];let o=12*(i.path.length-1);const{selection:s=[],expandedPaths:l=[],searchValue:d,areEmptyFoldersExpandable:c,focusedIndex:u,isFullyExpanded:m,isSelectable:h,doesSelectionIncludeChildren:p,editedPath:y=[]}=(0,a.useContext)(g)||{},x=0===(0,f.W)(i.path,y),C=(0,a.useMemo)((()=>h&&(0,b.A)(i.path,s,p)),[p,h,i.path,s]),T=l.some((e=>0===(0,f.W)(e,i.path))),S=!m&&!d&&i.isFolder&&(c||i.children?.length>0);S||(o+=17);const w=((e,t,n)=>t&&n.some((t=>v(t.from,e.path))))(i,Boolean(h),s),N=e.doesNodeHaveCheckbox?.(i);return(0,r.tZ)(t,{...n,hasSelectedChildren:w,hasCheckbox:N,isFocused:Boolean(d)&&u===e.index,isEdited:x,isSelected:C,isExpanded:T,isExpandable:S,onClick:e.onClick,style:{...n.style,...n.nodeStyle,paddingLeft:o}})};var C=n(96370),T=n(58736),S=n(9617),w=n(83794),N=n(68680);function F({node:e,onClick:t,NodeIcon:n,isSelected:i,isFocused:a,searchValue:o}){const s=(0,u.Fg)(),[,l]=(0,w.useDrag)({type:e.dragItem?.type??"UNKNOWN_DRAG_ITEM",canDrag:()=>!e.isDisabled&&void 0!==e.dragItem,item:()=>e.dragItem??null});return(0,r.BX)("div",{ref:l,css:{alignItems:"center",cursor:e.isDisabled?"not-allowed":"pointer",display:"flex",height:20,...i&&{background:s.selectionColor},...a&&{background:s.grayScale[2],textDecoration:"underline"},":hover":e.isDisabled?void 0:{background:s.grayScale[2],textDecoration:"underline"}},onClick:n=>{e.isDisabled||t(e,n)},children:[n&&(0,r.tZ)(n,{node:e,style:{margin:"0 5px",color:e.isDisabled?s.disabledTextColor:void 0}}),(0,r.tZ)("div",{css:T.css`
          text-overflow: ellipsis;
          overflow: hidden;
          list-style-type: none;
          white-space: nowrap;
        `,children:(0,r.tZ)(N.d,{caption:e.caption??"",path:e.parentNames,searchValue:o,isDisabled:e.isDisabled})})]})}const{Text:P}=S.Typography;function M(e){const{formatMessage:t}=(0,o.useIntl)(),n=(t,n)=>{e.onNodeClicked(t,n,t.path)};return(0,r.BX)("div",{css:T.css`
        margin: 0 8px;
        overflow: auto;
      `,children:[e.matches.length>e.maxResults&&(0,r.tZ)(P,{disabled:!0,css:{marginBottom:"3px"},children:t({id:"aui.search.warning"},{max:e.maxResults,total:e.matches.length})}),e.matches.slice(0,e.maxResults).map(((t,i)=>{const a=Boolean(e.isSelectable)&&(0,b.A)(t.path,e.selection||[],e.doesSelectionIncludeChildren),o=i===e.focusedIndex;return(0,r.tZ)(F,{node:t,onClick:n,NodeIcon:e.NodeIcon,isSelected:a,isFocused:o,searchValue:e.searchValue},i)}))]})}var I=n(50083);const D={margin:"0 9px",height:16,width:16},k=()=>{const e=(0,u.Fg)(),{formatMessage:t}=(0,o.useIntl)();return(0,r.BX)("div",{"data-testid":"tree-skeleton",children:[(0,r.BX)("div",{css:T.css`
          display: flex;
          align-items: center;
          margin: 6px;
          color: ${e.grayScale[6]};
        `,children:[(0,r.tZ)(I.CaretDownOutlined,{}),(0,r.tZ)("input",{type:"checkbox",disabled:!0,style:D}),(0,r.tZ)("span",{children:t({id:"aui.selectAll"})})]}),(0,r.tZ)("div",{css:T.css`
          margin-left: 18px;
        `,children:[...Array(12).keys()].map((e=>(0,r.BX)("div",{css:T.css`
              display: flex;
              align-items: center;
              margin: 6px;
              height: 16px;
            `,children:[(0,r.tZ)("input",{type:"checkbox",disabled:!0,style:D}),(0,r.tZ)("div",{css:{flex:1},children:(0,r.tZ)(S.Skeleton,{active:!0,title:!1,paragraph:{rows:1,width:"100%"}})})]},e)))})]})};var E=n(6676),R=n(86722),Z=n(36249);const A=(e,t)=>{const n=(0,Z.M)(e,t);if(!n.children||0===n.children.length)return t;const r=[...t,n.children.length-1];return A(e,r)};var O=n(11173),B=n(98192),L=n(61665);const V=function(e,t){if((0,i.isArray)(t))return(0,i.uniqWith)(t.reduce(((t,n)=>[...t,...V(e,n)]),[]),((e,t)=>e.length===t.length&&e.every(((e,n)=>e===t[n]))));let n=t.from;const r=[n];for(;!(0,i.isEqual)(n,t.to);){const t=(0,L.R)(e,n);if(void 0===t)break;n=t,r.push(n)}return r};var $=n(84202);const K=(e,t)=>{const n=t.at(-1),r=t.slice(0,-1);if(void 0===n)return;if(0===r.length&&0===n)return;if(0===n)return r;let i=[...r,n-1],a=(0,Z.M)(e,i);for(;void 0!==a.children&&a.children.length>0;)i=[...i,a.children.length-1],a=(0,Z.M)(e,i);return i},W=(e,t,n)=>{const r=(0,f.W)(n.from,n.to)>0,i=r?n.to:n.from,a=r?n.from:n.to;return(0,f.W)(i,t.from)<0&&(0,f.W)(a,t.from)<0||(0,f.W)(i,t.to)>0&&(0,f.W)(a,t.to)>0?[t]:(0,f.W)(i,t.from)<=0&&(0,f.W)(a,t.to)>=0?[]:(0,f.W)(i,t.from)<=0&&(0,f.W)(a,t.to)<0?[{from:(0,L.R)(e,a),to:t.to}]:(0,f.W)(i,t.from)>0&&(0,f.W)(a,t.to)>=0?[{from:t.from,to:K(e,i)}]:[{from:t.from,to:K(e,i)},{from:(0,L.R)(e,a),to:t.to}]},X=(e,t,n)=>t.reduce(((t,r)=>[...t,...W(e,r,n)]),[]),H=e=>{const t=(0,u.Fg)(),{formatMessage:n}=(0,o.useIntl)(),{onClick:g,getDefaultCaption:T,lineHeight:S,isFullyExpanded:w}=e,[N]=(0,l.y)("search.maxResults"),F=e.expandTrigger??"caret",P=(0,a.useMemo)((()=>void 0===e.hoverStyle?{background:t.grayScale[2],textDecoration:"underline"}:e.hoverStyle),[e.hoverStyle,t.grayScale]),I=(0,a.useMemo)((()=>void 0===e.selectionStyle?{background:t.selectionColor}:e.selectionStyle),[e.selectionStyle,t.selectionColor]),D=(0,a.useRef)(null),Z=(0,a.useRef)(null),[L,K]=(0,a.useState)(!1);(0,a.useEffect)((()=>{e.valueFilteredAccordingToSearch&&(0,m.N)("valueFilteredAccordingToSearch","Use isSearchVisible=false instead, handle the search manually and pass the search results to the tree via props.value")}),[e.valueFilteredAccordingToSearch]),(0,a.useEffect)((()=>{if(e.isLoading){const e=setTimeout((()=>{K(!0)}),700);return()=>{clearTimeout(e)}}K(!1)}),[e.isLoading]);const[W,H]=(0,a.useState)(e.searchValue),G=e.searchValue??W,_=e.onSearchValueChanged??H,[j,q]=(0,a.useState)(e.focusedIndex??0),U=e.focusedIndex??j,z=e.onFocusedIndexChanged??q;(0,a.useLayoutEffect)((()=>{U>0&&Z.current?.scrollToItem(U)}),[U]);const[Q,Y]=(0,a.useState)(null),{height:J}=(0,h.useDebouncedComponentSize)(D),[ee,te]=(0,a.useState)(void 0===e.defaultExpandedPaths?(e=>{const t=[];let n=e,r=0;for(;1===n.length;)r+=1,n=n[0].children||[],t.push(new Array(r).fill(0));return t})(e.value):e.defaultExpandedPaths),ne=void 0!==e.expandedPaths?e.expandedPaths:ee,re=void 0!==e.onExpandedPathsChange?e.onExpandedPathsChange:te,[ie,ae]=(0,a.useState)([]),[oe,se]=(0,a.useState)(!1),le=(0,a.useRef)(null),de=(0,a.useMemo)((()=>e.flatValue??(0,E.f)(e.valueFilteredAccordingToSearch?e.valueFilteredAccordingToSearch:e.value)),[e.flatValue,e.value,e.valueFilteredAccordingToSearch]),ce=(0,a.useMemo)((()=>de.filter((e=>{for(let t=1;t<e.path.length;t++){const n=e.path.slice(0,t);if(!w&&!ne.some((e=>e&&0===(0,f.W)(e,n))))return!1}return!0}))),[de,ne,w]),ue=(0,a.useMemo)((()=>void 0!==e.selectedPaths?(0,$.V)(ce,e.selectedPaths):ie),[e.selectedPaths,ie,ce]),{onSelectedPathsChange:me}=e,he=(0,a.useCallback)((e=>{if(void 0!==me){const t=V(ce,e);me(t)}else ae(e)}),[me,ce]),pe=(0,a.useMemo)((()=>e.searchResults?e.searchResults:void 0===G?[]:(0,c.y)(!1===e.doSearchResultsIncludeFolders?de.filter((e=>!e.isFolder)):de,G,{keys:["caption","parentNames"]})),[de,G,e.doSearchResultsIncludeFolders,e.searchResults]),ge=(0,a.useCallback)(((e,t)=>{t?re([...ne,e.path],{path:e.path,type:"expand"}):re(ne.filter((t=>!((0,i.isEqual)(t,e.path)||v(t,e.path)))),{path:e.path,type:"collapse"})}),[ne,re]),ye=(0,a.useCallback)(((t,n)=>{if("full-node"===F&&t.isFolder){const e=ne.some((e=>(0,i.isEqual)(e,t.path)));ge(t,!e)}if(g(t,t.path,n),se(!1),e.isSelectable){const r=ue.at(-1);if(r)if(n.shiftKey){const e=ue.some((e=>(0,f.W)(t.path,e.from)>=0&&(0,f.W)(t.path,e.to)<=0));if(oe&&null!==le.current){const e=X(ce,ue,{from:le.current,to:t.path});he(e)}else if(e){const e=X(ce,ue,{from:t.path,to:r.to});he(e)}else{const e=ue.slice(0,-1),n=(0,f.W)(r.from,t.path)<=0,i=n?r.from:t.path,a=n?t.path:r.from;he([...e,{from:i,to:a}])}}else if(Boolean(e.isSelectable)&&(0,b.A)(t.path,ue,e.doesSelectionIncludeChildren)){const e=((e,t,n)=>{const r=(0,R.k)([n]).find((e=>(0,O.N)(e,t)));return void 0===r?t:[...t,{from:[...r,0],to:A(e,r)}]})(ce,ue,t.path),n=X(ce,e,{from:t.path,to:A(ce,t.path)}),r=(0,R.k)([t.path]).reduce(((e,t)=>X(ce,e,{from:t,to:t})),n);se(!0),he(r)}else{const e=X(ce,ue,{from:t.path,to:A(ce,t.path)});he([...e,{from:t.path,to:t.path}])}else he([{from:t.path,to:t.path}]);le.current=t.path}}),[g,e.isSelectable,e.doesSelectionIncludeChildren,ue,he,oe,ce,F,ne,ge]),fe=(0,a.useMemo)((()=>({areEmptyFoldersExpandable:e.areEmptyFoldersExpandable,doesSelectionIncludeChildren:e.doesSelectionIncludeChildren,isSelectable:e.isSelectable,isFullyExpanded:w,focusedIndex:U,searchValue:G,selection:ue,expandedPaths:ne,editedPath:Q||[]})),[e.areEmptyFoldersExpandable,e.doesSelectionIncludeChildren,e.isSelectable,w,U,G,ue,ne,Q]),{onNodeEditEnded:ve}=e,be=(0,a.useCallback)(((e,t)=>{Y(null),ve?.(e,t)}),[ve]),xe=e.Node?e.Node:p.Q,Ce=(0,h.useCurriedComponent)(x,{Node:xe,Icon:e.NodeIcon,contextMenuItems:e.contextMenuItems,doesNodeHaveCheckbox:e.hasCheckbox,caretStyle:{fontSize:12},hoverStyle:P,nodeStyle:e.nodeStyle,selectionStyle:I,onClick:ye,onExpandToggled:ge,onEditCanceled:()=>{Y(null)},onEditEnded:be,onEditStarted:e=>{Y(e)},trees:e.value,getDefaultCaption:T,searchValue:G});Ce.displayName="CurriedNode";const{doSearchResultsIncludeFolders:Te,searchResultsDisplayShape:Se,value:we,valueFilteredAccordingToSearch:Ne}=e,Fe=(0,a.useMemo)((()=>function({doSearchResultsIncludeFolders:e,flatValue:t,matches:n,searchResultsDisplayShape:r,searchValue:i,value:a,valueFilteredAccordingToSearch:o}){return o?1===t.length?[]:t:"tree"===r&&i?e?(0,B.I)(n,a):n:t.slice(1)}({flatValue:de,matches:pe,searchValue:G,doSearchResultsIncludeFolders:Te,searchResultsDisplayShape:Se,value:we,valueFilteredAccordingToSearch:Ne})),[de,pe,G,Te,Se,we,Ne]),Pe=G?Fe:ce,Me=G&&0===Fe.length?(0,r.BX)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,r.tZ)(d.IconSearchNotFound,{style:{height:54,width:83,marginBottom:25}}),(0,r.tZ)("span",{children:n({id:"aui.membersTree.searchResultsNotFound"})})]}):(0,r.tZ)(y,{value:fe,children:(0,r.tZ)("div",{className:e.className,style:{flex:1,overflowY:"clip",...e.style},ref:D,children:(0,r.tZ)(s.t7,{height:J,itemCount:Pe.length,itemSize:S,width:"100%",itemData:Pe,itemKey:(e,t)=>{const{caption:n,parentNames:r}=t[e],i=[n,e];return(r?[...r,...i]:i).join("-")},ref:Z,style:{paddingBottom:5},children:Ce})})});return(0,r.BX)("div",{tabIndex:0,onKeyDown:t=>{e.isSelectable&&"Escape"===t.key&&he([])},css:{height:"100%",display:"flex",flexDirection:"column",":focus":{outline:"none"}},children:[e.isSearchVisible&&(0,r.BX)("div",{style:{display:"flex"},children:[(0,r.tZ)(C.h,{searchValue:G,onEnterPressed:e=>{const t=pe[U];ye(t,e)},onArrowKeyPressed:e=>{if("down"===e){let e=Math.min(N-1,U+1);for(;pe[e]&&pe[e].isDisabled;)e++;z(e)}else if("up"===e){let e=Math.max(0,U-1);for(;pe[e]&&pe[e].isDisabled;)e--;z(e)}},searchPlaceholder:e.searchPlaceholder,onSearchValueChanged:_,style:{flexShrink:1}}),e.searchInputAction]}),"list"===e.searchResultsDisplayShape&&G?0===pe.length?(0,r.BX)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,r.tZ)(d.IconSearchNotFound,{style:{height:54,width:83,marginBottom:25}}),(0,r.tZ)("span",{children:n({id:"aui.membersTree.searchResultsNotFound"})})]}):(0,r.tZ)(M,{matches:pe,selection:ue,maxResults:N,NodeIcon:e.NodeIcon,searchValue:G,focusedIndex:U,onNodeClicked:ye}):L?(0,r.tZ)(k,{}):Me]})};H.defaultProps={filter:()=>!0,isSearchVisible:!1,lineHeight:22,onClick:()=>{},getDefaultCaption:()=>"",onSearchValueChange:()=>{},searchResultsDisplayShape:"list"}},96370:(e,t,n)=>{n.d(t,{h:()=>d});var r=n(17967),i=n(50083),a=n(9617),o=n(66029),s=n(54935);const l=26;function d(e){const[t,n]=(0,o.useState)(e.searchValue),d=e.searchValue??t,c=e.onSearchValueChanged??n,u=(0,o.useRef)(null),m=(0,s.Fg)();(0,o.useEffect)((()=>{u.current?.focus()}),[]);const h=(0,o.useCallback)((e=>{c?.(e.target.value)}),[c]);return(0,r.tZ)(a.Input,{ref:u,allowClear:!0,prefix:e.isLoading?(0,r.tZ)(a.Spin,{indicator:(0,r.tZ)(i.LoadingOutlined,{style:{color:m.primaryColor,fontSize:12},spin:!0})}):(0,r.tZ)(i.SearchOutlined,{}),value:d,onChange:h,onKeyDown:t=>{e.onArrowKeyPressed&&("ArrowDown"===t.key?(e.onArrowKeyPressed("down"),t.preventDefault()):"ArrowUp"===t.key&&(e.onArrowKeyPressed("up"),t.preventDefault()))},onKeyUp:t=>{e.onEnterPressed&&"Enter"===t.key&&e.onEnterPressed(t)},placeholder:e.searchPlaceholder,style:{height:l,marginBottom:8,...e.style},disabled:e.isDisabled})}},91811:(e,t,n)=>{n.d(t,{W:()=>r});const r=(e,t)=>{let n=0;for(;n<e.length;){if(t.length<=n)return 1;if(e[n]>t[n])return 1;if(e[n]<t[n])return-1;n++}return n===t.length?0:-1}},6676:(e,t,n)=>{n.d(t,{f:()=>a});var r=n(36249),i=n(15326);function a(e){const t=[];return e.forEach(((e,n)=>{(0,i.f)(e,{forEachNode:(n,i)=>{const a=i.slice(1,i.length-1),o=a.map(((t,n)=>(0,r.M)(e,a.slice(0,n+1))?.caption)),s={...n,path:i,parentNames:o.join(" / ")};t.push(s)}},[n])})),t}},36249:(e,t,n)=>{n.d(t,{M:()=>i});var r=n(77026);function i(e,t){if((0,r.isArray)(e)){const n=e,[r,...a]=t;return i(n[r],a)}return t.reduce(((e,t)=>e?.children?.[t]),e)}},98192:(e,t,n)=>{n.d(t,{I:()=>i});var r=n(36249);function i(e,t){const n=[],i=new Set;return e.forEach((e=>{const{path:a}=e,o=a.join("-");for(let e=1;e<a.length;e++){const o=a.slice(0,e),s=(0,r.M)(t,o);if(!s)break;const l=o.join("-");s&&!i.has(l)&&(i.add(l),n.push({...s,path:o}))}i.has(o)||(i.add(o),n.push(e))})),n}},86722:(e,t,n)=>{n.d(t,{k:()=>i});var r=n(77026);function i(e){const t=[];return e.forEach((function(e){for(let n=1;n<e.length;n++)t.push(e.slice(0,n))})),(0,r.uniqWith)(t,r.isEqual)}},61665:(e,t,n)=>{n.d(t,{R:()=>i});var r=n(36249);const i=(e,t)=>{const n=(0,r.M)(e,t);if(n?.children&&n.children.length>0)return[...t,0];let i=t.at(-1),a=t.slice(0,-1);for(;void 0!==i&&void 0===(0,r.M)(e,[...a,i+1]);)i=a.at(-1),a=a.slice(0,-1);return void 0!==i&&void 0!==(0,r.M)(e,[...a,i+1])?[...a,i+1]:void 0}},84202:(e,t,n)=>{n.d(t,{V:()=>a});var r=n(77026),i=n(61665);const a=function(e,t){if(0===t.length)return[];const n=[{from:t[0],to:t[0]}];let a=1;for(;a<t.length;){const o=t[a],s=n.at(-1);if(s){const t=(0,i.R)(e,s.to);t&&(0,r.isEqual)(o,t)?s.to=o:n.push({from:o,to:o})}a++}return n}},30980:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(86722),i=n(11173);function a(e,t,n){return[e,...!1===n?[]:(0,r.k)([e])].some((e=>(0,i.N)(e,t)))}},11173:(e,t,n)=>{n.d(t,{N:()=>i});var r=n(91811);const i=(e,t)=>t.some((t=>(0,r.W)(e,t.from)>=0&&(0,r.W)(e,t.to)<=0))},78613:(e,t,n)=>{n.d(t,{S:()=>i});var r=n(15326);function i(e,t){const n={...e,children:[]};return(0,r.f)(e,{forEachNode(e,t){if(t.length>=1){const r=function(e,t){let n=e;for(let e=0;e<t;e++)void 0!==n.children&&(n=n.children.at(-1));return n}(n,t.length-1);r.children?.push({...e,children:[]})}},sort:t}),n}},15326:(e,t,n)=>{n.d(t,{f:()=>r});const r=function(e,{forEachNode:t,sort:n},i=[]){t(e,i),e.children&&(n?e.children.slice().sort(n):e.children).forEach(((e,a)=>{r(e,{forEachNode:t,sort:n},[...i,a])}))}},76789:(e,t,n)=>{n.d(t,{$:()=>C});var r=n(17967),i=n(50083),a=n(58736),o=n(66029),s=n(93481),l=n(54935),d=n(19078);const c=e=>{const t=(0,l.Fg)(),{formatMessage:n}=(0,s.useIntl)(),i={height:"100%",display:"flex",justifyContent:"center",alignItems:"center",color:t.grayScale[9],fontSize:10},[a,o]=e.isSubtilePlaceholder?[t.selectionColor,t.dropHintColor]:[t.dropHintColor,t.selectionColor],[d,c]=e.isSubtilePlaceholder?["25%","75%"]:["50%","50%"];return(0,r.BX)("div",{style:{backgroundColor:t.dropHintColor,border:`1px solid ${t.dropHintBorderColor}`,display:"flex",height:24,marginTop:3,marginRight:4,lineHeight:22,borderRadius:3},children:[(0,r.tZ)("div",{style:{...i,width:d,backgroundColor:a,borderRight:`1px dotted ${t.dropHintBorderColor}`},children:e.isSubtilePlaceholder?null:n({id:"aui.expandAll"})}),(0,r.tZ)("div",{style:{...i,width:c,backgroundColor:o,borderLeft:`1px dotted ${t.dropHintBorderColor}`},children:e.isSubtilePlaceholder?n({id:"aui.expandOneByOne"}):null})]})};var u=n(66114);const m=e=>{const t=(0,l.Fg)();return e.isSplitHorizontally?(0,r.tZ)(c,{isSubtilePlaceholder:e.isSubtilePlaceholder}):(0,r.tZ)(u.n9,{isRemovable:!1,className:"tilePlaceholder",css:a.css`
        background-color: ${t.dropHintColor};
        border: 1px solid ${t.dropHintBorderColor};
      `})},h=e=>{const t=(0,l.Fg)();if(0===e.numberOfChildren)return null;const n=e.doesContainASubtilePlaceholder?t.headerActiveColor:t.grayScale[5],i=27*(e.numberOfChildren-1)+15,a=[];for(let t=0;t<e.numberOfChildren;t++)a.push(27*t+15);return(0,r.BX)("svg",{width:"6",height:i,viewBox:`0 0 6 ${i+1}`,children:[(0,r.tZ)("line",{x1:"1",y1:"2",x2:"1",y2:i,stroke:n}),a.map((e=>(0,r.tZ)("line",{x1:"1",y1:e,x2:"6",y2:e,stroke:n},e)))]})},p=e=>{const{subtiles:t,onSubtileRemoved:n,draggedSubtileIndex:i,onSubtileDragged:o,popoverSubtileIndex:s,hoveredSubtileIndex:l,...d}=e;let c=t.length;const p=t.map(((t,a)=>{const{caption:l,...d}=t;return(0,r.tZ)(u.n9,{className:"subtile",...d,onRemoved:()=>{n?.(a)},dragItem:d.dragItem?{...d.dragItem,_isDraggedFromWizard:!0}:void 0,isBeingDragged:i===a,onDragStart:()=>{o?.(a)},onDragEnd:e.onDragEnd,isPopoverVisible:a===s,popover:e.popover,popoverInnerHeight:e.popoverInnerHeight,children:t.caption},a)}));return void 0!==l&&(c++,p.splice(l,0,(0,r.tZ)(m,{isSplitHorizontally:0===t.length||1===t.length&&0===i,isSubtilePlaceholder:!0},"placeholderTile"))),void 0!==i&&c--,(0,r.BX)("div",{css:a.css`
        display: ${e.isBeingDragged?"none":"block"};
      `,children:[(0,r.tZ)(u.n9,{...d,children:e.children}),(0,r.BX)("div",{style:{marginLeft:5,display:"flex"},children:[(0,r.tZ)(h,{numberOfChildren:c,doesContainASubtilePlaceholder:void 0!==l}),(0,r.tZ)("div",{style:{flexGrow:1,maxWidth:"calc(100% - 6px)"},children:p})]})]})};var g=n(77026),y=n(83794);function f(e){return e.className.includes("subtile")}const v=({clientOffset:e,domTiles:t,doesSupportSubtiles:n})=>{const r=t.map((e=>e.getBoundingClientRect())),i=r.findIndex((({height:e})=>0===e)),a=t.filter(((e,t)=>t!==i)),o=r.filter(((e,t)=>t!==i)),s=a.findIndex(f),l=-1===s?a.length:s,d=a.length-l;if(void 0===e?.x||void 0===e?.y||0===o.length)return 0===d?{tileIndex:l}:{tileIndex:l-1,subtileIndex:d};const c=o[0],{height:u,left:m,width:h}=c,p=e.x>m+h/2;let g=0;for(;g<o.length&&e.y>o[g].top+u/2;)g++;return n&&(g>l||g===l&&(p||d>0))?{tileIndex:l-1+(-1!==i&&i<l?1:0),subtileIndex:g-l+(d>0&&i>=l&&g>=i?1:0)}:{tileIndex:g+(-1!==i&&g>=i?1:0)}};function b(e){if(e instanceof Element)return Array.from(e.getElementsByClassName("aui-tile")).filter((e=>!(e.className.includes("placeholder")||e.className.includes("tilePlaceholder"))))}const x=()=>{},C=e=>{const t=(0,o.useRef)(null),n=(0,o.useRef)(),c=(0,l.Fg)(),{formatMessage:h}=(0,s.useIntl)(),f=e.onAddButtonClicked||x,C=e.onTileMoved||x,T=e.onTileRemoved||x,S=e.onTileAdded||x,w=e.placeholder||h({id:"aui.dataVisualization.noFields"}),N=e.popoverInnerHeight??u.y$,F=(0,d.getPopoverCoordinates)(t.current,N,u.kV),{isDraggedOver:P,dragItem:M,saveDropTargetRef:I,hoveredPosition:D,draggedTilePosition:k,onDragStart:E,onDragEnd:R}=function(e){const[t,n]=(0,o.useState)(),[r,i]=(0,o.useState)(),[{isDraggedOver:a,dragItem:s},l]=(0,y.useDrop)({accept:e.dragItemTypes,canDrop(t,n){const r=b(e.dropTarget.current);if(!r)return!1;const i=v({clientOffset:n.getClientOffset(),domTiles:r,doesSupportSubtiles:e.doesSupportSubtiles});return e.canDrop({dragItem:t,toPosition:i})},collect:e=>({isDraggedOver:e.isOver(),dragItem:e.getItem()}),hover(t,n){if(n.canDrop()){const t=b(e.dropTarget.current);if(!t)return;const a=v({clientOffset:n.getClientOffset(),domTiles:t,doesSupportSubtiles:e.doesSupportSubtiles});(0,g.isEqual)(a,r)||i(a)}else void 0!==r&&i(void 0)},drop(t){setTimeout((()=>{void 0!==r&&(t._isDraggedFromWizard?e.onTileMoved({dragItem:(0,g.omit)(t,"_isDraggedFromWizard"),toPosition:r}):e.onTileAdded({dragItem:t,toPosition:r}))}))}}),d=n;return(0,o.useEffect)((()=>{a||i(void 0)}),[a]),{isDraggedOver:a,dragItem:s,saveDropTargetRef:l,hoveredPosition:r,draggedTilePosition:t,onDragStart:d,onDragEnd:()=>{n(void 0)}}}({dropTarget:n,dragItemTypes:e.dragItemTypes,canDrop:e.canDrop,onTileMoved:C,onTileAdded:S,doesSupportSubtiles:e.doesSupportSubtiles}),Z=P&&void 0!==D&&e.canDrop({dragItem:M,toPosition:D}),A=e.tiles.map(((t,n)=>{const i=t.dragItem,a={icons:t.icons,key:i?`draggable-${n}`:`undraggable-${n}`,onRemoved:()=>T({tileIndex:n}),isPopoverVisible:e.isPopoverVisible&&e.popoverPosition?.tileIndex===n&&!("subtileIndex"in e.popoverPosition),popover:e.popover,popoverInnerHeight:N,...t,...i?{onDragStart:()=>{E({tileIndex:n})},onDragEnd:R,dragItem:{...t.dragItem,_isDraggedFromWizard:!0},isBeingDragged:k?.tileIndex===n&&!("subtileIndex"in k)}:{}};return(e=>"subtiles"in e)(t)?(0,r.tZ)(p,{...a,subtiles:t.subtiles,onSubtileRemoved:e=>T({tileIndex:n,subtileIndex:e}),draggedSubtileIndex:k?.tileIndex===n&&"subtileIndex"in k?k.subtileIndex:void 0,onSubtileDragged:e=>E({tileIndex:n,subtileIndex:e}),popoverSubtileIndex:Boolean(e.isPopoverVisible)&&e.popoverPosition?.tileIndex===n&&"subtileIndex"in e.popoverPosition?e.popoverPosition.subtileIndex:void 0,hoveredSubtileIndex:Z&&"subtileIndex"in D?D.subtileIndex:void 0,children:t.caption}):Z&&D.tileIndex===n&&"subtileIndex"in D&&0===D.subtileIndex?(0,r.tZ)(p,{...a,subtiles:[],hoveredSubtileIndex:0,children:t.caption}):(0,r.tZ)(u.n9,{...a,children:t.caption})}));return Z&&!("subtileIndex"in D)&&A.splice(D.tileIndex,0,(0,r.tZ)(m,{isSplitHorizontally:e.doesSupportSubtiles&&D.tileIndex===e.tiles.length&&0!==D.tileIndex,isSubtilePlaceholder:!1},"placeholderTile")),(0,r.BX)("div",{className:e.className,tabIndex:0,children:[e.title||e.isAddButtonVisible?(0,r.BX)("div",{ref:t,css:a.css`
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            height: 24px;
            margin-top: 4px;
          `,children:[(0,r.tZ)("div",{children:e.title}),e.isAddButtonVisible&&(0,r.tZ)(d.PositionedPopover,{open:e.isPopoverVisible&&!e.popoverPosition,coordinates:F,destroyTooltipOnHide:!0,title:e.popover?.title,content:e.popover?.content,children:(0,r.tZ)("div",{css:{marginRight:6,color:c.grayScale[8]},children:(0,r.tZ)(i.PlusOutlined,{onClick:f})})})]}):null,(0,r.BX)("div",{ref:e=>{n.current=e,I(e)},children:[0!==e.tiles.length||Z?A:(0,r.tZ)(d.Tooltip,{trigger:"hover",placement:"bottom",title:e.placeholderTooltip||null,children:(0,r.tZ)("div",{css:a.css`
                color: ${c.disabledTextColor};
                cursor: not-allowed;
                height: 27px;
              `,children:w})}),!P&&(0,r.tZ)(u.n9,{className:"placeholder",css:a.css`
              opacity: 0;
            `}),void 0!==k&&(0,r.tZ)(u.n9,{className:"placeholder",css:a.css`
              opacity: 0;
            `},w),0===e.tiles?.length&&P&&(0,r.tZ)(u.n9,{className:"placeholder",css:a.css`
              opacity: 0;
            `})]})]})}},66114:(e,t,n)=>{n.d(t,{kV:()=>m,n9:()=>h,y$:()=>u});var r=n(17967),i=n(50083),a=n(58736),o=n(66029),s=n(83794),l=n(96129),d=n(54935),c=n(19078);const u=410,m=1,h=e=>{const t=(0,d.Fg)(),n=(0,o.useRef)(null),h=(0,l.Z)(),{title:p,content:g,...y}=e.popover||{},[,f]=(0,s.useDrag)({type:e.dragItem?.type??"UNKNOWN_DRAG_ITEM",item:()=>(e.onDragStart&&setTimeout(e.onDragStart),e.dragItem??null),end:e.onDragEnd}),v=(0,c.getPopoverCoordinates)(n.current,e.popoverInnerHeight||u,m),b=e.isCorrupt?"white":e.isDisabled?t.disabledTextColor:t.textColor,x=e.isCorrupt?t.errorColor:t.grayScale[2],{isTooltipVisible:C,onMouseEnter:T,onMouseLeave:S}=(0,c.useIsTooltipVisible)(),w=e.isPopoverVisible&&!e.isGhost&&!e.isBeingDragged;return(0,r.tZ)("div",{onClick:e.onClick,ref:e=>{null===n.current&&null!==e&&(n.current=e,h())},className:"aui-tile"+(e.className?` ${e.className}`:""),css:a.css`
        display: ${e.isBeingDragged?"none":"block"};
        background-color: ${x};
        color: ${b};
        padding-left: 10px;
        padding-right: 4px;
        margin-top: 3px;
        margin-right: 4px;
        flex-grow: 1;
        justify-content: space-between;
        height: 24px;
        line-height: 22px;
        ${e.isDisabled?"cursor: not-allowed;":e.dragItem?"cursor: move;":""}
        border-radius: 3px;
        border: ${m}px solid ${t.grayScale[5]};

        :hover {
          .tile-icons {
            display: block;
          }
        }
      `,children:n.current&&(0,r.tZ)("div",{css:a.css`
            overflow: visible;
          `,children:(0,r.tZ)(c.PositionedPopover,{...y,title:p,content:g,open:w,destroyTooltipOnHide:!0,coordinates:v,children:(0,r.tZ)(c.Tooltip,{...e.tooltipValue?{trigger:w?[]:["hover"],title:e.tooltipValue}:{open:!w&&C,title:e.children},placement:"right",children:(0,r.BX)("div",{ref:t=>{e.dragItem&&f(t)},css:a.css`
                  display: flex;
                  overflow: hidden;
                  flex-grow: 1;
                  align-items: center;
                  justify-content: space-between;
                  height: 100%;
                `,children:[(0,r.BX)("div",{style:{flex:1,minWidth:0,position:"relative"},children:[(0,r.tZ)("div",{onMouseEnter:T,onMouseLeave:S,css:a.css`
                      overflow: hidden;
                      text-overflow: ellipsis;
                      white-space: nowrap;
                      height: 100%;
                    `,children:e.children}),(0,r.BX)("div",{className:"tile-icons",css:a.css`
                      display: none;
                      cursor: pointer;
                      position: absolute;
                      background-color: ${x};
                      top: 0;
                      right: 0;
                      * {
                        color: ${e.isCorrupt?"white":t.grayScale[7]};
                        margin-left: 4px;
                      }
                    `,children:[e.icons,!e.isGhost&&!1!==e.isRemovable&&(0,r.tZ)(i.CloseOutlined,{onClick:e.onRemoved})]})]}),e.stickyIcons&&(0,r.tZ)("div",{css:{marginLeft:8,flexShrink:0},children:e.stickyIcons})]})})})})})}},28158:(e,t,n)=>{n.d(t,{e:()=>d});var r=n(17967),i=n(58736),a=n(77026),o=n(54935),s=n(76789);const l={canDrop:()=>!1,dragItemTypes:["UNKNOWN"],onTileMoved:()=>{},onTileAdded:()=>{},onTileRemoved:()=>{}},d=e=>{const t={...l,...e},n=(0,o.Fg)(),d=Object.entries(t.sections);return(0,r.tZ)("div",{className:t.className,onKeyDown:t.onKeyDown,children:d.map((([e,o],l)=>(0,r.tZ)(s.$,{css:l<d.length-1&&i.css`
                border-bottom: 1px solid ${n.grayScale[4]};
              `,canDrop:({dragItem:n,toPosition:r})=>t.canDrop({dragItem:n,toPosition:{...r,sectionName:e}}),dragItemTypes:t.dragItemTypes,isAddButtonVisible:o.isAddButtonVisible,onAddButtonClicked:()=>t.onAddButtonClicked?.({sectionName:e}),tiles:o?.tiles,title:o.caption,onTileAdded:({dragItem:n,toPosition:r})=>{t.onTileAdded({dragItem:n,toPosition:{...r,sectionName:e}})},onTileMoved:({dragItem:n,toPosition:r})=>t.onTileMoved({dragItem:n,toPosition:{...r,sectionName:e}}),onTileRemoved:n=>t.onTileRemoved({...n,sectionName:e}),placeholder:o.placeholder,placeholderTooltip:o.placeholderTooltip,popover:t.popover,popoverInnerHeight:t.popoverInnerHeight,isPopoverVisible:t.popoverPosition?.sectionName===e,popoverPosition:t.popoverPosition?.sectionName===e&&"tileIndex"in t.popoverPosition?(0,a.omit)(t.popoverPosition,"sectionName"):void 0,doesSupportSubtiles:o.doesSupportSubtiles},e)))})}}}]);
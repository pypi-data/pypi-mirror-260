{% extends 'generic/object.html' %}
{% load static %}
{% load helpers %}
{% block content %}
{% load plugins %}
{% load i18n %}
<!-- Modal Superset -->
<div id="superset_modal" class="modal" data-modal="1" style="height: 100%; width: 100%; z-index: 99999999;">
   <!--   Svg –∏–∫–æ–Ω–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞  -->
   <svg class="modal__cross js-modal-close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="z-index:999999999"><path d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.>
   <p class="modal__title"><div class="container"style="height: 90%; width: 90%;">
    <!-- This div will serve as the mount point for the embedded dashboard -->
    <div id="my-superset-container" style="height: 100%; width: 100%;"></div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Check if we have a token and an embed ID
            if ("{{ token }}" && "{{ EmbeddedDashboardID }}") {
                supersetEmbeddedSdk.embedDashboard({
                    id: "{{ EmbeddedDashboardID }}",
                    supersetDomain: "{{ supersetDomain }}",
                    mountPoint: document.getElementById("my-superset-container"),
                    fetchGuestToken: () => Promise.resolve("{{ token }}"),
                    dashboardUiConfig: {
                                          hideTitle: "true",
                                          hideTab: "true",
                                          hideChartControls: "true",
                                          filters: {
                                                  expanded: "true",
                                                  visible: "true"
                                          }
                    },
                }).catch(error => {
                    console.error('Error embedding Superset dashboard:', error);
                });
            } else {
                console.error('Missing Superset embed ID or guest token.');
            }
        });
    </script>
</div></p>
</div>

<link
      rel="stylesheet"
      href="{% static 'superset.css'%}"
/>


<div class="row mb-3">
  <div class="col col-md-6">
    <div class="card">
      <h5 class="card-header">–û–ø–∏—Å–∞–Ω–∏–µ</h5>
      <div class="card-body">
        <table class="table table-hover attr-table">
          <tr>
            <th scope="row">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <td>{{ object.name|placeholder }}</td>
          </tr>
          <tr>
            <th scope="row">–î–∞—à–±–æ—Ä–¥</th>
            <td><a href="#" class="js-open-modal" data-modal="1">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞—à–±–æ—Ä–¥</a></td>
          </tr>
          <tr>
            <th scope="row">security_id</th>
            <td>{{ object.security_id|placeholder }}</td>
          </tr>
          <tr>
            <th scope="row">–ö–æ—Ä–æ—Ç–∫–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
            <td>{{ object.slug|placeholder }}</td>
          </tr>
          <tr>
            <th scope="row">–£—á—Ä–µ–∂–¥–µ–Ω–∏–µ</th>
            <td><a href="{% url 'tenancy:tenant' pk=object.tenant.pk %}">{{ object.tenant }}</a></td>
          </tr>
          <tr>
            <td>–ì—Ä—É–ø–ø–∞ —Å–∏—Å—Ç–µ–º</td>
            <td>{{ object.group|linkify|placeholder }}</td>
          </tr>
          <tr>
            <th scope="row">–í —Å–æ—Å—Ç–∞–≤–µ —Å–∏—Å—Ç–µ–º—ã</th>
            <td>{{ object.parent|linkify|placeholder }}</td>
          </tr>
          <tr>
            <td>–û–ø–∏—Å–∞–Ω–∏–µ</td>
            <td>{{ object.description|placeholder }}</td>
          </tr>
          <tr>
            <td>–ü–æ–¥—Å–∏—Å—Ç–µ–º—ã:</td>
            {% if object.subsystems.all %}
            <td>{% for sub in object.subsystems.all %}
              {{ sub|linkify|placeholder }} <br>
              {% endfor %}
            </td>
            {% else %}
            <td>–ù–µ—Ç –ø–æ–¥—Å–∏—Å—Ç–µ–º</td>
            {% endif %}
          </tr>
          <tr>
            <th scope="row">Gitlab</th>
            <td><a href="{{ object.gitlab }}">{{ object.gitlab|placeholder }}</a></td>
          </tr>
          <tr>
            <th scope="row">Wiki</th>
            <td><a href="{{ object.wiki }}">{{ object.wiki|placeholder }}</a></td>
          </tr>
          <tr>
            <th scope="row">–£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –ò–°</th>
            <td>{% badge object.get_critical_level_display bg_color=object.get_document_type_color %}</td>
          </tr>
          <tr>
            <th scope="row">–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</th>
            <td>{% badge object.get_pers_data_category_display bg_color=object.get_document_type_color %}</td>
          </tr>
          <tr>
            <th scope="row">–ü–µ—Ä–µ—á–µ–Ω—å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</th>
            <td>{% badge object.get_confidential_info_display bg_color=object.get_document_type_color %}</td>
          </tr>
          <tr>
            <th scope="row">–î–∞—Ç–∞ –≤–≤–æ–¥–∞ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é</th>
            <td>{{ object.comm_date|date:"d.m.Y" }}</td>
          </tr>
          <tr>
            <th scope="row">–ü—Ä–∏–∫–∞–∑ –≤–≤–æ–¥–∞ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é</th>
            <td>{{ object.com_order|placeholder }}</td>
          </tr>
          <tr>
            <th scope="row">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</th>
            <td>{{ object.technologies|placeholder }}</td>
          </tr>
          <tr>
            <th scope="row">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è</th>
            <td>{{ object.dev_technologies|placeholder }}</td>
          </tr>
          <tr>
            <th scope="row">–ö–æ—Ä–æ–±–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ</th>
            <td>{% if object.is_box_solution %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>

          <tr>
            <th scope="row">–°–∏—Å—Ç–µ–º–∞ –Ω–∞ –∞—É—Ç—Å–æ—Ä—Å–µ</th>
            <td>{% if object.is_otsrc_sys %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –∞—É—Ç—Å–æ—Ä—Å–µ</th>
            <td>{% if object.is_otsrc_adm %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –∞—É—Ç—Å–æ—Ä—Å–µ</th>
            <td>{% if object.is_otsrc_sup %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–î–æ—Å—Ç—É–ø–Ω–æ –ª–∏ —Ä–µ—à–µ–Ω–∏–µ –∏–∑ —Å–µ—Ç–∏ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç</th>
            <td>{% if object.is_internet %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–î–æ—Å—Ç—É–ø –∏–∑ —Å–µ—Ç–∏ –¥—Ä—É–≥–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –ï–ò–†–ñ–°</th>
            <td>{% if object.is_able_eirjs %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–ï—Å—Ç—å –ª–∏ API –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ API —É —Ä–µ—à–µ–Ω–∏—è</th>
            <td>{% if object.is_able_api %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–ù—É–∂–µ–Ω –ª–∏ API –¥–æ—Å—Ç—É–ø –∏–∑ —Å–µ—Ç–∏ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç</th>
            <td>{% if object.is_api_internet %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–î–æ—Å—Ç—É–ø –∏–∑ —Å–µ—Ç–∏ –ø–æ–¥—Ä—è–¥—á–∏–∫–∞, –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞</th>
            <td>{% if object.is_cont_access %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>
          <tr>
            <th scope="row">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</th>
            <td>{% if object.is_conf_info %}–î–∞{% else %}–ù–µ—Ç{% endif %}</td>
          </tr>

        </table>
      </div>
    </div>
    {% include 'inc/panels/custom_fields.html' %}
    {% plugin_left_page object %}
  </div>
  <div class="col col-md-6">
    <div class="card">
      <h5 class="card-header">–°–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã</h5>
      <ul class="list-group list-group-flush">
        {% for obj, val in object.get_related_objects.items %}
          {% if val.model == 'device' %}
            <a href="{% url 'dcim:device_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'virtualmachine' %}
            <a href="{% url 'virtualization:virtualmachine_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'cluster' %}
            <a href="{% url 'virtualization:cluster_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'l2vpn' %}
            <a href="{% url 'vpn:l2vpn_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'asn' %}
            <a href="{% url 'ipam:asn_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'ipaddress' %}
            <a href="{% url 'ipam:ipaddress_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'iprange' %}
            <a href="{% url 'ipam:iprange_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'prefix' %}
            <a href="{% url 'ipam:prefix_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% elif val.model == 'vlan' %}
            <a href="{% url 'ipam:vlan_list' %}?cf_system={{ object.pk }}" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% else %}
            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between">
          {% endif %}
          {{ val.name|title }}
          {% if val.count %}
            <span class="badge bg-primary rounded-pill">{{ val.count }}</span>
          {% else %}
            <span class="badge bg-light rounded-pill">&mdash;</span>
          {% endif %}
          </a>
        {% endfor %}
      </ul>
    </div>
    {% plugin_right_page object %}
    {% include 'inc/panels/related_objects.html' %}
    {% include 'inc/panels/tags.html' %}
    {% include 'inc/panels/comments.html' %}

  </div>
  <div class="row">
    <div class="col col-md-12">
      {% plugin_full_width_page object %}
    </div>
  </div>
</div>
<!-- –ü–æ–¥–ª–æ–∂–∫–∞ –ø–æ–¥ –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º -->
<div class="overlay js-overlay-modal"></div>
<script>
!function(e){"function"!=typeof e.matches&&(e.matches=e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=this,o=(t.document||t.ownerDocument).querySelectorAll(e),n=0;o[n]&&o[n]!==t;)++n;return Boolean(o[n])}),"function"!=typeof e.closest&&(e.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(t.matches(e))return t;t=t.parentNode}return null})}(window.Element.prototype);


document.addEventListener('DOMContentLoaded', function() {

   /* –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Å—Å–∏–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤-–∫–Ω–æ–ø–æ–∫ –∏ –ø–æ–¥–ª–æ–∂–∫—É.
      –ü–æ–¥–ª–æ–∂–∫–µ –∑–∞–¥–∞–¥–∏–º id, —á—Ç–æ–±—ã –Ω–µ –≤–ª–∏—è—Ç—å –Ω–∞ –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º overlay*/
   var modalButtons = document.querySelectorAll('.js-open-modal'),
       overlay      = document.querySelector('.js-overlay-modal'),
       closeButtons = document.querySelectorAll('.js-modal-close');


   /* –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –º–∞—Å—Å–∏–≤ –∫–Ω–æ–ø–æ–∫ */
   modalButtons.forEach(function(item){

      /* –ù–∞–∑–Ω–∞—á–∞–µ–º –∫–∞–∂–¥–æ–π –∫–Ω–æ–ø–∫–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ */
      item.addEventListener('click', function(e) {

         /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞. –¢–∞–∫ –∫–∞–∫ –∫–Ω–æ–ø–∫—É —Ä–∞–∑–Ω—ã–µ
            –ª—é–¥–∏ –º–æ–≥—É—Ç —Å–¥–µ–ª–∞—Ç—å –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –ö—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞–µ—Ç —Å—Å—ã–ª–∫—É, –∫—Ç–æ-—Ç–æ –∫–Ω–æ–ø–∫—É.
            –ù—É–∂–Ω–æ –ø–æ–¥—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å—Å—è. */
         e.preventDefault();

         /* –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –º—ã –±—É–¥–µ–º –∑–∞–±–∏—Ä–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ç—Ä–∏–±—É—Ç–∞ data-modal
            –∏ –±—É–¥–µ–º –∏—Å–∫–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ç–∞–∫–∏–º –∂–µ –∞—Ç—Ä–∏–±—É—Ç–æ–º. */
         var modalId = this.getAttribute('data-modal'),
             modalElem = document.querySelector('.modal[data-modal="' + modalId + '"]');


         /* –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –Ω–∞—à–ª–∏ –Ω—É–∂–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ, –¥–æ–±–∞–≤–∏–º –∫–ª–∞—Å—Å—ã
            –ø–æ–¥–ª–æ–∂–∫–µ –∏ –æ–∫–Ω—É —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –∏—Ö. */
         modalElem.classList.add('active');
         overlay.classList.add('active');
      }); // end click

   }); // end foreach


   closeButtons.forEach(function(item){

      item.addEventListener('click', function(e) {
         var parentModal = this.closest('.modal');

         parentModal.classList.remove('active');
         overlay.classList.remove('active');
      });

   }); // end foreach


    document.body.addEventListener('keyup', function (e) {
        var key = e.keyCode;

        if (key == 27) {

            document.querySelector('.modal.active').classList.remove('active');
            document.querySelector('.overlay').classList.remove('active');
        };
    }, false);


    overlay.addEventListener('click', function() {
        document.querySelector('.modal.active').classList.remove('active');
        this.classList.remove('active');
    });




}); // end ready
</script>




	<script>
	function waitForElementToExist(selector) {
  return new Promise(resolve => {
    if (document.querySelector(selector)) {
      return resolve(document.querySelector(selector));
    }

    const observer = new MutationObserver(() => {
      if (document.querySelector(selector)) {
        resolve(document.querySelector(selector));
        observer.disconnect();
      }
    });

    observer.observe(document.body, {
      subtree: true,
      childList: true,
    });
  });
}

// üëáÔ∏è using the function
waitForElementToExist('#my-superset-container > iframe').then(element => {
  		superset = document.getElementById("my-superset-container")
		superset_iframe = superset.children[0]
		superset_iframe.width = '100%'
		superset_iframe.height = '100%'
});


modal = document.getElementById('superset_modal')
modal.style.maxWidth = '80%'
modal.style.width = '80%'
modal.style.height = '80%'
	</script>




<script src="https://unpkg.com/@superset-ui/embedded-sdk"></script>
{% endblock content %}


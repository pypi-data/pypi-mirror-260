[workspace]
members = ["crates/*"]
resolver = "2"

# Compile a few key dependencies in release mode so that
# dev/tests run faster
[profile.dev.package.proptest]
opt-level = 3
codegen-units = 16

[profile.dev.package.levenshtein_automata]
opt-level = 3
codegen-units = 16

[profile.dev.package.flexbuffers]
opt-level = 3
codegen-units = 16

[profile.dev.package.regex-syntax]
opt-level = 3
codegen-units = 16

[profile.dev.package.miniz_oxide]
opt-level = 3
codegen-units = 16

[profile.dev.package.sha2]
opt-level = 3
codegen-units = 16

[profile.dev.package.digest]
opt-level = 3
codegen-units = 16

[profile.dev.package.num-bigint-dig]
opt-level = 3
codegen-units = 16

[profile.release]
opt-level = 3
debug = true
panic = "abort"

[workspace.dependencies]
anyhow = "1"
askama = "0.12"
async-broadcast = "0.6.0"
async-channel = "1.9.0"
async-recursion = "1.0.5"
async-stripe = { version = "0.22.0", default-features = false, features = [
    "runtime-tokio-hyper",
    "checkout",
    "webhook-events",
    "connect",
] }
async-trait = "0.1"
async_zip = { version = "0.0.9", default-features = false, features = [
    "zstd",
    "deflate",
] }
csv-async = "1.2"
atomic_refcell = "0.1.10"
aws-config = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
aws-sdk-firehose = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
aws-sdk-resourcegroupstagging = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
aws-sdk-lambda = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
aws-sdk-sts = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
aws-sdk-s3 = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
aws-smithy-http = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
aws-types = { git = "https://github.com/sshader/aws-sdk-rust", rev = "201044adebb41169fe0c3fbdaaebbeb3bfeede53" }
axum = { version = "0.6", features = [
    "headers",
    "ws",
    "original-uri",
    "macros",
    "multipart",
] }
backoff = { version = "0.4", features = ["tokio"] }
base32 = "0.4.0"
base-62 = "0.1.1"
base64 = "0.13"
biscuit = "0.7.0"
bitvec = "1.0.1"
byteorder = "1.5.0"
bytes = "1.1.0"
bytesize = "1.3.0"
cfg-if = "1.0"
chrono = "0.4.26"
chrono-tz = "0.8.1"
clap = { version = "^4.1.8", features = ["derive"] }
clap_complete = "^4.1.5"
colored = "2"
counter = "0.5"
criterion = "0.5"
crossbeam = "0.8"
crossbeam-channel = "0.5"
csf = "0.1.11"
cstr = "0.2.11"
ctrlc = "3.4"
deadpool-postgres = "^0.12.0"
deno_core = "0.266.0"
deno_core_icudata = "0.0.73"
derive_more = "0.99"
dialoguer = "0.11.0"
divan = "0.1.11"
dotenvy = "0.15.7"
dynfmt = "0.1.5"
either = "1.9.0"
encoding_rs = "0.8.32"
event-listener = "2.5.3"
flexbuffers = "2"
float_next_after = "1.0.0"
futures = "0.3"
futures-async-stream = "0.2.9"
futures-util = "0.3.25"
governor = "0.6.0"
headers = "0.3"
hex = "0.4"
home = "0.5"
enum-iterator = "1.5.0"
hmac = "0.12.1"
http = "0.2.8"
http-body = "0.4"
http-cache-reqwest = { version = "0.13.0", features = ["manager-moka"] }
humansize = { version = "2.1.3", features = ["impl_style"] }
humantime = "2.1.0"
hyper = "0.14.16"
proc-macro2 = { version = "1.0" }
imbl = "2.0.0"
indicatif = "0.17"
itertools = "0.12"
tikv-jemallocator = { version = "0.5.0", features = [
    "profiling",
    "unprefixed_malloc_on_supported_platforms",
] }
tikv-jemalloc-sys = { version = "0.5.0", features = [
    "profiling",
    "unprefixed_malloc_on_supported_platforms",
] }
jemalloc_pprof = "0.1.0"
jsonschema = "0.17.0"
levenshtein_automata = "0.2.1"
libc = "0.2"
log = "0.4"
lru = "0.12.0"
maplit = "1"
mime = "0.3"
mime2ext = "0.1.52"
must-let = { git = "https://github.com/sujayakar/must-let", rev = "5b487d78db235e396e61dd03ce261ced0eafff9d" }
mysql_async = "0.33.0"
native-tls = "^0.2.10"
nomad-client = "0.0.7"
num_cpus = "1.16.0"
oauth2 = "4.4.2"
openidconnect = { git = "https://github.com/get-convex/openidconnect-rs", rev = "45a84cf974d45db998af10546a4c35abd5f0a487", features = [
    "accept-rfc3339-timestamps",
] }
optfield = "0.3.0"
orb-billing = { git = "https://github.com/get-convex/rust-orb-billing", rev = "8dcde01a34b86cc4b004dfcb79b6ab79ae71cf40" }
parking_lot = { version = "0.12", features = ["hardware-lock-elision"] }
paste = { version = "1.0.12" }
phf = { version = "0.11.0", features = ["macros"] }
pin-project = "1"
portpicker = "0.1"
postgres-native-tls = "^0.5"
postmark = { version = "0.10", features = ["reqwest"] }
pretty_assertions = "1"
prometheus = { git = "https://github.com/get-convex/rust-prometheus", rev = "061619b6e44ca7f3b94d97346152cab319895929" }
prometheus-hyper = "0.1.5"
proptest = "1"
proptest-derive = "0.4.0"
proptest-http = { git = "https://github.com/sujayakar/proptest-http", rev = "12ef4c4ac2002b050ab0944a9587d83d7ea9fce2" }
prost = "0.12"
prost-build = "0.12"
prost-types = "0.12"
pyo3 = "0.19.1"
pyo3-asyncio = { version = "0.19.0", features = ["tokio-runtime"] }
qdrant_segment = { git = "https://github.com/get-convex/qdrant", rev = "76482c6e62dd37c2bcb30a298e6538678df1bd27", package = "segment" }
quote = "1.0"
rand = "0.8"
rand_chacha = "0.3.1"
rand_distr = "0.4"
rayon = "1"
ref-cast = "1.0.20"
regex = "1"
rendezvous_hash = "0.3.0"
reqwest = { version = "0.11.24", features = ["json", "stream", "gzip"] }
reqwest-middleware = "0.2.0"
ring = "0.17.0"
rsa = "0.9.0"
rs-consul = "0.5.0"
rusqlite = { version = "0.30", features = ["bundled"] }
saffron = { git = "https://github.com/get-convex/saffron", rev = "1d842379919fb5c1988ac127cebd6167b1eb9bec", features = [
    "std",
] }
semver = { version = "1", features = ["serde"] }
sentry = { version = "0.31", features = ["anyhow", "tower", "tower-http"] }
serde = { version = "1", features = ["derive"] }
serde-aux = "4.4.0"
serde_json = { version = "1", features = ["float_roundtrip", "preserve_order"] }
sha2 = { version = "0.10.7", features = ["asm"] }
simple-process-stats = "1"
slab = "0.4.2"
slog = { version = "2", features = [
    "max_level_trace",
    "release_max_level_trace",
] }
slog-async = "2"
slog-term = "2"
slug = "0.1.4"
sodiumoxide = "^0.2"
sourcemap = "7"
sqlx = { version = "0.7.3", features = [
    "chrono",
    "uuid",
    "runtime-tokio-native-tls",
    "postgres",
    "mysql",
] }
sysinfo = "0.29"
static_assertions = "1.1.0"
strum = { version = "0.25", features = ["derive"] }
sucds = { version = "0.8.1", features = ["intrinsics"] }
syn = { version = "2.0", features = ["full"] }
tantivy = { git = "https://github.com/get-convex/tantivy", branch = "rakeeb/reexport-tantivy-fst" }
tempfile = "3"
testcontainers = "0.15"
textplots = "0.8"
thiserror = "1"
thousands = "0.2.0"
time = { version = "0.3.17", features = ["serde", "serde-human-readable"] }
tokio = { version = "1", features = ["full"] }
tokio-metrics = { version = "0.3.0" }
tokio-metrics-collector = { version = "0.2.0" }
tokio-postgres = { version = "0.7.8", features = ["with-serde_json-1"] }
tokio-stream = { version = "^0.1.8", features = ["io-util", "sync"] }
tokio-test = "0.4.2"
tokio-tungstenite = "0.20.0"
tonic = { version = "0.10.0", features = ["gzip"] }
tonic-build = "0.10.0"
tonic-health = "0.10.0"
tower = { version = "0.4", features = ["limit", "timeout"] }
tower-cookies = "0.9"
tower-http = { version = "0.4", features = ["trace", "cors", "decompression-br", "compression-br"] }
tracing = "0.1"
tracing-appender = { version = "0.2" }
tracing-subscriber = { version = "0.3.17", features = ["env-filter", "json"] }
tracy-client = { version = "0.16.0", default-features = false, features = [
    "fibers",
] }
tungstenite = "0.20.0"
url = "2"
urlencoding = "2.1.3"
uuid = { version = "1.6", features = ["serde", "v4"] }
vergen = { version = "8.1.0" }
wait-timeout = "0.2"
walkdir = "2"
whoami = "1.4.1"
xorf = { git = "https://github.com/sujayakar/xorf.git", rev = "62a32de47bb3ad8b34d6d4feac034a24be2c881a" }

[patch.crates-io]
prometheus = { git = "https://github.com/get-convex/rust-prometheus", rev = "061619b6e44ca7f3b94d97346152cab319895929" }
darwin-libproc = { git = "https://github.com/Orycterope/darwin-libproc.git", rev = "f73ddb1002d51ae74c1b41670fae56bd5896b7a3" }

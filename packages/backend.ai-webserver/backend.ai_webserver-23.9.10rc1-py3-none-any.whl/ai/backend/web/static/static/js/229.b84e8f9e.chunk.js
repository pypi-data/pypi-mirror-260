"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[229,502],{61502:function(e,n,t){t.r(n),t.d(n,{default:function(){return ee},useShadowRoot:function(){return H},useWebComponentInfo:function(){return U}});var i=t(1413),r=t(29439),o=t(74165),a=t(15861),l=t(24530),u=t(24717),s=t(61724);function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,i=(0,l.Qc)(e),r=(0,u.Vn)(i,{Field:{enter:function(e){var i;if(null!==e&&void 0!==e&&null!==(i=e.directives)&&void 0!==i&&i.find((function(e){var i,r,o,a,l=e.name.value,u=null===(i=e.arguments)||void 0===i?void 0:i[0].name.value,s=null===(r=e.arguments)||void 0===r||null===(o=r[0].value)||void 0===o?void 0:o.value,c=null===(a=e.arguments)||void 0===a?void 0:a[0];if("since"===l&&"version"===u){if(t(s))return!0}else if("deprecatedSince"===l&&"version"===u){var d="StringValue"===(null===c||void 0===c?void 0:c.value.kind)?null===c||void 0===c?void 0:c.value.value:n[null===c||void 0===c?void 0:c.value.name.value];if(!t(d))return!0}else if("skipOnClient"===l&&"if"===u){if("BooleanValue"===(null===c||void 0===c?void 0:c.value.kind)&&c.value.value)return!0;if("Variable"===(null===c||void 0===c?void 0:c.value.kind)&&n[c.value.name.value])return!0}return!1})))return null},leave:function(e){var n;if(e.selectionSet&&"SelectionSet"===e.selectionSet.kind&&0===(null===(n=e.selectionSet.selections)||void 0===n?void 0:n.length))return null}},Directive:{leave:function(e){var n=e.name.value;if(["since","deprecatedSince","skipOnClient"].includes(n))return null}}}),o={};return(0,u.Vn)(r,{Variable:function(e){o[e.name.value]=(o[e.name.value]||0)+1}}),r=(0,u.Vn)(r,{VariableDefinition:{enter:function(e){if(o[e.variable.name.value]<=1)return null}}}),(0,s.S)(r)}var d=t(41011);d.RelayFeatureFlags.ENABLE_RELAY_RESOLVERS=!0;var v=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n,t){var i,r,a,l,u,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==globalThis.backendaiclient){e.next=3;break}return e.next=3,new Promise((function(e){document.addEventListener("backend-ai-connected",(function n(){document.removeEventListener("backend-ai-connected",n),e(void 0)}))}));case 3:return a=c(n.text||"",t,(function(e){var n;return!(null!==(n=globalThis.backendaiclient)&&void 0!==n&&n.isManagerVersionCompatibleWith(e))})),l={query:a,variables:t},u=null===(i=globalThis.backendaiclient)||void 0===i?void 0:i.newSignedRequest("POST","/admin/gql",l),e.next=8,null===(r=globalThis.backendaiclient)||void 0===r?void 0:r._wrapWithPromise(u,!1,null,1e4,0).catch((function(e){}));case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0={};case 11:return s=e.t0,e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();var f,m=new d.Environment({network:d.Network.create(v,void 0),store:new d.Store(new d.RecordSource)}),g=t(80382),h=t(21232),p=t(27340),b=t(41239),k=t(44036),x=t(47226),w=t(49883),Z=t(66670),y=t(99517),E=t.n(y),j=(t(24989),t(79354)),C=t.n(j),S=t(79748),_=t.n(S),L=t(51714),T=t.n(L),P=t(63540),M=t.n(P),V=t(18272),F=t.n(V),R=t(9666),A=t.n(R),D=t(64447),O=t(13881),N=t(4519),W=t(81748),q=t(87112),z=t(16980),B=t(51843),I=t(12674),Q=t(55144),K=t(73181),$=t(2556);E().extend(A()),E().extend(C()),E().extend(_()),E().extend(T()),E().extend(F()),E().extend(M());var G=N.createContext(null),Y=N.createContext(null),H=function(){return N.useContext(Y)},U=function(){return N.useContext(G)},J=new q.QueryClient({defaultOptions:{queries:{suspense:!0,refetchOnWindowFocus:!1,retry:!1}}});D.ZP.use(W.Db).use(O.Z).init({backend:{loadPath:"/resources/i18n/{{lng}}.json"},lng:(null===globalThis||void 0===globalThis||null===(f=globalThis.backendaioptions)||void 0===f?void 0:f.get("current_language"))||"en",fallbackLng:"en",interpolation:{escapeValue:!1},react:{transSupportBasicHtmlNodes:!0,transKeepBasicHtmlNodesFor:["br","strong","span","code","p"]}});var X=function(){var e=(0,I.s0)();return(0,N.useLayoutEffect)((function(){var n=function(n){var t=n.detail;e(t,{replace:!0})};return document.addEventListener("react-navigate",n),function(){document.removeEventListener("react-navigate",n)}}),[e]),null},ee=function(e){var n=e.children,t=e.value,o=e.styles,a=e.shadowRoot,l=e.dispatchEvent,u=(0,N.useMemo)((function(){return(0,p.Df)()}),[]),s=function(){var e,n=(0,N.useState)(null===globalThis||void 0===globalThis||null===(e=globalThis.backendaioptions)||void 0===e?void 0:e.get("current_language")),t=(0,r.Z)(n,2),i=t[0],o=t[1],a=(0,W.$G)().i18n;return(0,N.useEffect)((function(){setTimeout((function(){return null===a||void 0===a?void 0:a.changeLanguage(i)}),0),E().locale(i)}),[]),(0,N.useEffect)((function(){var e=function(e){var n,t;o(null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.lang);var i=(null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.lang)||"en";null===a||void 0===a||a.changeLanguage(i),E().locale(i)};return window.addEventListener("langChanged",e),function(){return window.removeEventListener("langChanged",e)}}),[a]),[i]}(),c=(0,r.Z)(s,1)[0],d=(0,g.x)(),v=(0,h.r)().isDarkMode,f=(0,N.useMemo)((function(){return{value:t,dispatchEvent:l,moveTo:function(e,n){l("moveTo",{path:e,params:n})}}}),[t,l]);return(0,$.jsx)($.Fragment,{children:m&&(0,$.jsx)(z.RelayEnvironmentProvider,{environment:m,children:(0,$.jsxs)(N.StrictMode,{children:[(0,$.jsxs)("style",{children:[o,".anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n/* fix: fixed column shadow display outside of a table wrapper */\n.ant-table-wrapper {\n  border-radius: 8px 8px 0 0;\n  overflow: hidden;\n}\n\n/* fix: the tooltip does not appear in the `<Form.Item tooltip={'something'}` when the popup container is a parent node of the trigger node. */\n.ant-form-item-label {\n  overflow: unset !important;\n}\n"]}),(0,$.jsx)(q.QueryClientProvider,{client:J,children:(0,$.jsx)(Y.Provider,{value:a,children:(0,$.jsx)(G.Provider,{value:f,children:(0,$.jsx)(b.ZP,{getPopupContainer:function(e){return(null===e||void 0===e?void 0:e.parentNode)||a},locale:"ko"===c?Z.Z:w.Z,theme:(0,i.Z)((0,i.Z)({},v?(0,i.Z)({},d.dark):(0,i.Z)({},d.light)),{},{algorithm:v?k.Z.darkAlgorithm:k.Z.defaultAlgorithm}),children:(0,$.jsx)(x.Z,{children:(0,$.jsx)(p.V9,{container:a,cache:u,children:(0,$.jsx)(N.Suspense,{fallback:"",children:(0,$.jsx)(B.VK,{children:(0,$.jsxs)(Q.QueryParamProvider,{adapter:K.Q,options:{},children:[(0,$.jsx)(X,{}),n]})})})})})})})})})]})})})}},27229:function(e,n,t){t.r(n);var i=t(29439),r=t(87760),o=t(1839),a=t(50164),l=t(61502),u=t(99277),s=t(50708),c=t(67848),d=t(64846),v=t(33405),f=t(30485),m=t(89786),g=t(80220),h=t(43514),p=t(35027),b=t(44036),k=t(46734),x=t(70389),w=t(3501),Z=t(58834),y=t(4519),E=t(81748),j=t(2556);n.default=function(){var e=(0,E.$G)().t,n=b.Z.useToken().token,t=(0,l.useWebComponentInfo)().dispatchEvent,C=(0,r.Dj)(),S=(0,o.jC)(),_=(0,i.Z)(S,1)[0],L=(0,y.useState)(!1),T=(0,i.Z)(L,2),P=T[0],M=T[1],V=k.ZP.useBreakpoint(),F=(0,p.Z)(P,{wait:100,leading:!0,trailing:!1}),R=(0,a.h)("getUserRole",(function(){return C.user.get(_.email,["role"])}),{suspense:!1}).data,A=null===R||void 0===R?void 0:R.user.role,D=[{label:(0,j.jsx)(x.Z.Text,{children:_.username}),key:"userFullName",icon:(0,j.jsx)(s.Z,{}),disabled:!0,style:{color:n.colorText,cursor:"default"}},{label:_.email,key:"userEmail",icon:(0,j.jsx)(c.Z,{}),disabled:!0,style:{cursor:"default"}},{type:"divider"},{label:A,key:"userRole",icon:(0,j.jsx)(d.Z,{}),disabled:!0,style:{cursor:"default"}},{type:"divider"},{label:e("webui.menu.AboutBackendAI"),key:"description",icon:(0,j.jsx)(v.Z,{}),onClick:function(){var e=new CustomEvent("backend-ai-show-splash");document.dispatchEvent(e)}},{label:e("webui.menu.MyAccount"),key:"userProfileSetting",icon:(0,j.jsx)(f.Z,{}),onClick:function(){t("moveTo",{path:"#userprofile"})}},{label:e("webui.menu.Preferences"),key:"preferences",icon:(0,j.jsx)(m.Z,{}),onClick:function(){t("moveTo",{path:"/usersettings",params:{tab:"general"}})}},{label:e("webui.menu.LogsErrors"),key:"logs",icon:(0,j.jsx)(g.Z,{}),onClick:function(){t("moveTo",{path:"/usersettings",params:{tab:"logs"}})}},{label:e("webui.menu.LogOut"),key:"logout",icon:(0,j.jsx)(h.Z,{}),onClick:function(){var e=new CustomEvent("backend-ai-logout");document.dispatchEvent(e)}}];return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(w.Z,{menu:{items:D},trigger:["click"],open:F,onOpenChange:function(e){return M(e)},overlayStyle:{maxWidth:300},children:(0,j.jsxs)(u.Z,{direction:"row",gap:"sm",style:{cursor:"pointer",maxWidth:"15vw"},children:[V.md&&(0,j.jsx)(x.Z.Text,{strong:!0,ellipsis:!0,children:_.username}),(0,j.jsx)(u.Z,{children:(0,j.jsx)(Z.C,{size:"default",icon:(0,j.jsx)(s.Z,{})})})]})})})}},1839:function(e,n,t){t.d(n,{T6:function(){return d},jC:function(){return v}});var i=t(1413),r=t(29439),o=t(87760),a=t(43255),l=t(50164),u=t(32048),s=t.n(u),c=t(4519),d=function(){var e=(0,o.Kr)("first"),n=(0,r.Z)(e,2),t=n[0],i=n[1],a=(0,o.Dj)();return[(0,l.h)({queryKey:["useResourceSlots",t],queryFn:function(){return a.get_resource_slots()},staleTime:0}).data,{refresh:function(){return i()}}]},v=function(){var e=(0,o.Dj)(),n=(0,c.useState)({full_name:e.full_name,email:e.email}),t=(0,r.Z)(n,2),u=t[0],d=t[1];(0,c.useEffect)((function(){var n=function(n){if(e.supports("change-user-name")){var t=n.detail;d((function(e){return(0,i.Z)((0,i.Z)({},e),{},{full_name:t})}))}};return document.addEventListener("current-user-info-changed",n),function(){document.removeEventListener("current-user-info-changed",n)}}),[e]);var v=(0,l.Y)({mutationFn:function(n){return e.update_full_name(n.email,n.full_name)}}),f=(0,l.Y)({mutationFn:function(n){return e.update_password(n.old_password,n.new_password,n.new_password2)}});return[(0,i.Z)((0,i.Z)({},u),{},{username:function(){var n=s().trim(u.full_name).length>0?u.full_name:u.email;if(e._config.maskUserInfo){var t=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(n)?n.split("@")[0].length-2:n.length-2;n=(0,a.Cd)(n,"*",2,t)}return n}(),isPendingMutation:v.isLoading||f.isLoading}),{updateFullName:function(n,t){v.mutate({full_name:n,email:e.email},{onSuccess:function(){(null===t||void 0===t?void 0:t.onSuccess)&&t.onSuccess(n),document.dispatchEvent(new CustomEvent("current-user-info-changed",{detail:n})),d((function(e){return(0,i.Z)((0,i.Z)({},e),{},{full_name:n})}))},onError:function(e){(null===t||void 0===t?void 0:t.onError)&&t.onError(e)}})},updatePassword:function(e,n){f.mutate(e,{onSuccess:function(){(null===n||void 0===n?void 0:n.onSuccess)&&n.onSuccess(void 0)},onError:function(e){(null===n||void 0===n?void 0:n.onError)&&n.onError(e)}})}}]}},21232:function(e,n,t){t.d(n,{r:function(){return l}});var i=t(29439),r=t(67873),o=t(4519),a=function(e,n){var t=(0,r.Z)(e,{defaultValue:n}),a=(0,i.Z)(t,2),l=a[0],u=a[1],s="useLocalStorageGlobalState:"+e;return(0,o.useEffect)((function(){var e=function(e){u(e.detail)};return document.addEventListener(s,e),function(){return document.removeEventListener(s,e)}}),[u,s]),[l,function(e){document.dispatchEvent(new CustomEvent(s,{detail:e}))}]},l=function(){var e=a("backendaiwebui.settings.themeMode","system"),n=(0,i.Z)(e,2),t=n[0],r=n[1],l=a("backendaiwebui.settings.isDarkMode",window.matchMedia("(prefers-color-scheme: dark)").matches),u=(0,i.Z)(l,2),s=(u[0],u[1]);return(0,o.useEffect)((function(){if("system"===t){var e=window.matchMedia("(prefers-color-scheme: dark)");s(e.matches);var n=function(e){s(e.matches)};return e.addEventListener("change",n),function(){return e.removeEventListener("change",n)}}s("dark"===t)}),[t,s]),{themeMode:t,isDarkMode:!1,setThemeMode:function(e){r(e)}}}}}]);
//# sourceMappingURL=229.b84e8f9e.chunk.js.map
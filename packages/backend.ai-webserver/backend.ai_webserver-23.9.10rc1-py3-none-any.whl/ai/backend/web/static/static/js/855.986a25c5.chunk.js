"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[855],{82855:function(e,n,a){a.r(n);var r,t=a(1413),i=a(29439),l=a(44925),u=a(87760),o=a(1839),s=a(50164),c=a(77758),d=a(99277),f=a(92171),m=a(49248),y=a(70389),p=a(82548),_=(a(4519),a(81748)),v=a(16980),g=a(2556),k=["onRequestClose"];n.default=function(e){var n=e.onRequestClose,h=(0,l.Z)(e,k),Z=(0,_.$G)().t,K=(0,o.jC)(),w=(0,i.Z)(K,1)[0],x=(0,u.Dj)(),b=(0,s.h)({queryKey:["baiClient.keypair.list",h.open],queryFn:function(){return x.keypair.list(w.email,["access_key","secret_key","is_active"],!0).then((function(e){return e.keypairs}))},suspense:!0,staleTime:0,cacheTime:0}).data,S=null===x||void 0===x?void 0:x.supports("main-access-key"),C=(0,v.useLazyLoadQuery)(void 0!==r?r:r=a(94167),{email:w.email}).user;return(0,g.jsx)(c.Z,(0,t.Z)((0,t.Z)({},h),{},{title:Z("usersettings.MyKeypairInfo"),centered:!0,onCancel:n,destroyOnClose:!0,width:"auto",footer:[(0,g.jsx)(f.ZP,{onClick:function(){n()},children:Z("button.Close")})],children:(0,g.jsx)(m.Z,{scroll:{x:"max-content"},rowKey:"access_key",dataSource:b,columns:[{title:"#",fixed:"left",render:function(e,n,a){return++a},showSorterTooltip:!1,rowScope:"row"},{title:Z("general.AccessKey"),dataIndex:"access_key",fixed:"left",render:function(e){return(0,g.jsxs)(d.Z,{direction:"column",align:"start",children:[(0,g.jsx)(y.Z.Text,{ellipsis:!0,copyable:!0,children:e}),S&&e===(null===C||void 0===C?void 0:C.main_access_key)&&(0,g.jsx)(p.Z,{color:"red",children:Z("credential.MainAccessKey")})]})}},{title:Z("general.SecretKey"),dataIndex:"secret_key",fixed:"left",render:function(e){return(0,g.jsx)(y.Z.Text,{ellipsis:!0,copyable:!0,children:e})}}]})}))}},94167:function(e,n,a){a.r(n);var r=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"email"}],n=[{kind:"Variable",name:"email",variableName:"email"}],a={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"main_access_key",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairInfoModalQuery",selections:[{alias:null,args:n,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[a,r],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairInfoModalQuery",selections:[{alias:null,args:n,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[a,r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"352a943226b02e137a3fcd32fa0ae22a",id:null,metadata:{},name:"KeypairInfoModalQuery",operationKind:"query",text:'query KeypairInfoModalQuery(\n  $email: String\n) {\n  user(email: $email) {\n    email\n    main_access_key @since(version: "23.09.7")\n    id\n  }\n}\n'}}}();r.hash="70097c005c8abc07e233048a68db1273",n.default=r},1839:function(e,n,a){a.d(n,{T6:function(){return d},jC:function(){return f}});var r=a(1413),t=a(29439),i=a(87760),l=a(43255),u=a(50164),o=a(32048),s=a.n(o),c=a(4519),d=function(){var e=(0,i.Kr)("first"),n=(0,t.Z)(e,2),a=n[0],r=n[1],l=(0,i.Dj)();return[(0,u.h)({queryKey:["useResourceSlots",a],queryFn:function(){return l.get_resource_slots()},staleTime:0}).data,{refresh:function(){return r()}}]},f=function(){var e=(0,i.Dj)(),n=(0,c.useState)({full_name:e.full_name,email:e.email}),a=(0,t.Z)(n,2),o=a[0],d=a[1];(0,c.useEffect)((function(){var n=function(n){if(e.supports("change-user-name")){var a=n.detail;d((function(e){return(0,r.Z)((0,r.Z)({},e),{},{full_name:a})}))}};return document.addEventListener("current-user-info-changed",n),function(){document.removeEventListener("current-user-info-changed",n)}}),[e]);var f=(0,u.Y)({mutationFn:function(n){return e.update_full_name(n.email,n.full_name)}}),m=(0,u.Y)({mutationFn:function(n){return e.update_password(n.old_password,n.new_password,n.new_password2)}});return[(0,r.Z)((0,r.Z)({},o),{},{username:function(){var n=s().trim(o.full_name).length>0?o.full_name:o.email;if(e._config.maskUserInfo){var a=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(n)?n.split("@")[0].length-2:n.length-2;n=(0,l.Cd)(n,"*",2,a)}return n}(),isPendingMutation:f.isLoading||m.isLoading}),{updateFullName:function(n,a){f.mutate({full_name:n,email:e.email},{onSuccess:function(){(null===a||void 0===a?void 0:a.onSuccess)&&a.onSuccess(n),document.dispatchEvent(new CustomEvent("current-user-info-changed",{detail:n})),d((function(e){return(0,r.Z)((0,r.Z)({},e),{},{full_name:n})}))},onError:function(e){(null===a||void 0===a?void 0:a.onError)&&a.onError(e)}})},updatePassword:function(e,n){m.mutate(e,{onSuccess:function(){(null===n||void 0===n?void 0:n.onSuccess)&&n.onSuccess(void 0)},onError:function(e){(null===n||void 0===n?void 0:n.onError)&&n.onError(e)}})}}]}}}]);
//# sourceMappingURL=855.986a25c5.chunk.js.map